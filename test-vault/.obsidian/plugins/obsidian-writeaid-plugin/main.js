"use strict";var jc=Object.defineProperty;var so=t=>{throw TypeError(t)};var Ac=(t,e,r)=>e in t?jc(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r;var Ge=(t,e,r)=>Ac(t,typeof e!="symbol"?e+"":e,r),Ha=(t,e,r)=>e.has(t)||so("Cannot "+r);var F=(t,e,r)=>(Ha(t,e,"read from private field"),r?r.call(t):e.get(t)),ce=(t,e,r)=>e.has(t)?so("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,r),z=(t,e,r,n)=>(Ha(t,e,"write to private field"),n?n.call(t,r):e.set(t,r),r),Ie=(t,e,r)=>(Ha(t,e,"access private method"),r);const y=require("obsidian"),Mt={DRAFTS:"drafts",MANUSCRIPTS:"manuscripts",BACKUPS:".writeaid-backups"},es={META:"meta.md",OUTLINE:"outline.md"},ts={COMPACT:"compact",KEBAB:"kebab"},zr={SINGLE:"single-file",MULTI:"multi-file"},Tc=Object.values(zr),ue="WriteAid",A=`${ue} debug:`;function Et(t,e=ts.COMPACT){if(!t)return"";const r=t.trim();return e===ts.KEBAB?r.replace(/\s+/g,"-").toLowerCase():r.replace(/\s+/g,"").toLowerCase()}async function Vn(t,e){const r=await Promise.all(t.map(n=>Promise.resolve(e(n))));return t.filter((n,i)=>r[i])}function de(t,...e){try{return t()}catch(r){if(e.length>0&&e.some(n=>r instanceof n)||e.length===0)return;throw r}}async function He(t,...e){try{return await t()}catch(r){if(e.length>0&&e.some(n=>r instanceof n)||e.length===0)return;throw r}}function T(...t){de(()=>{window.__WRITEAID_DEBUG__&&(console.debug||console.log).apply(console,t)})}const Nc=Object.freeze(Object.defineProperty({__proto__:null,APP_NAME:ue,DEBUG_PREFIX:A,FILES:es,FOLDERS:Mt,PROJECT_TYPE:zr,SLUG_STYLE:ts,VALID_PROJECT_TYPES:Tc,asyncFilter:Vn,debug:T,slugifyDraftName:Et,suppress:de,suppressAsync:He},Symbol.toStringTag,{value:"Module"}));async function bn(t,e){const r=t.vault.getAbstractFileByPath(e);if(!r||!(r instanceof y.TFile))return null;try{const n=await t.vault.read(r);return Dc(n)}catch(n){return console.error("Error reading meta file:",n),null}}async function ks(t,e,r){const n=Oc(r),i=t.vault.getAbstractFileByPath(e);i&&i instanceof y.TFile?await t.vault.modify(i,n):await t.vault.create(e,n)}async function Rn(t,e,r,n){const i=`${e}/meta.md`;let a=await bn(t,i);a||(a={total_drafts:0});const s=t.vault.getAbstractFileByPath(`${e}/${Mt.DRAFTS}`);if(s&&s instanceof y.TFolder){const l=s.children.filter(o=>o instanceof y.TFolder);a.total_drafts=l.length}r!==void 0&&(a.current_active_draft=r,a.active_draft_last_modified=new Date().toISOString()),n&&Object.assign(a,n),a.total_drafts>0&&a.total_word_count&&(a.average_draft_word_count=Math.round(a.total_word_count/a.total_drafts)),await ks(t,i,a)}function Dc(t){const e=t.match(/^---\s*\n([\s\S]*?)\n---/);if(!e)return null;const r=e[1],n={},i=r.split(`
`);for(const a of i){const s=a.match(/^([a-zA-Z_][a-zA-Z0-9_-]*):\s*(.*)$/);if(s){const l=s[1];let o=s[2].trim();/^-?\d+(\.\d+)?$/.test(o)?o=Number(o):(o.startsWith('"')&&o.endsWith('"')||o.startsWith("'")&&o.endsWith("'"))&&(o=o.slice(1,-1)),n[l]=o}}return n}function Oc(t){const e=["---"];if(t.current_active_draft!==void 0&&e.push(`current_active_draft: "${t.current_active_draft}"`),e.push(`total_drafts: ${t.total_drafts}`),t.target_word_count!==void 0&&e.push(`target_word_count: ${t.target_word_count}`),t.active_draft_last_modified!==void 0&&e.push(`active_draft_last_modified: "${t.active_draft_last_modified}"`),t.total_word_count!==void 0&&e.push(`total_word_count: ${t.total_word_count}`),t.average_draft_word_count!==void 0&&e.push(`average_draft_word_count: ${t.average_draft_word_count}`),t.project_type!==void 0&&e.push(`project_type: ${t.project_type}`),e.push("---"),e.push(""),e.push("# Project Statistics"),e.push(""),t.current_active_draft&&e.push(`**Active Draft:** ${t.current_active_draft}`),e.push(`**Total Drafts:** ${t.total_drafts}`),t.target_word_count&&e.push(`**Target Word Count:** ${t.target_word_count.toLocaleString()}`),t.active_draft_last_modified){const r=new Date(t.active_draft_last_modified);e.push(`**Last Modified:** ${r.toLocaleString()}`)}return t.total_word_count&&e.push(`**Total Word Count:** ${t.total_word_count.toLocaleString()}`),t.average_draft_word_count&&e.push(`**Average Draft Word Count:** ${t.average_draft_word_count.toLocaleString()}`),e.push(""),e.join(`
`)}const rs=Object.freeze(Object.defineProperty({__proto__:null,readMetaFile:bn,updateMetaStats:Rn,writeMetaFile:ks},Symbol.toStringTag,{value:"Module"}));async function Lc(t,e){const r=`${e}/meta.md`,n=await bn(t,r);if(!n||n.project_type!==zr.SINGLE)return new y.Notice(`Project is not a ${zr.SINGLE} project.`),!1;n.project_type=zr.MULTI,await ks(t,r,n);const i=t.vault.getAbstractFileByPath(`${e}/${Mt.DRAFTS}`);if(!i||!(i instanceof y.TFolder))return new y.Notice("Drafts folder not found."),!1;let a=!1;for(const s of i.children)if(s instanceof y.TFolder){const l=Et(s.name),o=s.children.find(c=>c instanceof y.TFile&&c.name===`${l}.md`);if(o){const c=`${s.path}/Chapter 1.md`;if(o.path!==c){const f=await t.vault.read(o);await t.vault.create(c,f),await t.vault.delete(o),a=!0}}}return a?new y.Notice('Converted to multi-file project. Draft files renamed to "Chapter 1.md".'):new y.Notice("Converted to multi-file project. No draft files needed renaming."),!0}async function Mc(t,e){if(!e){new y.Notice("No active project selected.");return}await Lc(t,e)}function Rc(t){return()=>t.createNewDraftPrompt()}function Ic(t){return()=>t.createNewProjectPrompt()}function Bc(t){return async()=>{var a;const e=t.projectFileService.drafts,r=t.activeProject,n=t.activeDraft;if(T(`${A} Generate manuscript command called`),T(`${A} Active project: ${r}, active draft: ${n}`),T(`${A} Manager settings manuscript template: ${(a=t.settings)==null?void 0:a.manuscriptNameTemplate}`),!r||!n){new y.Notice("No active project or draft found.");return}await e.generateManuscript(r,n,t.settings)?new y.Notice("Manuscript generated successfully."):new y.Notice("Failed to generate manuscript.")}}function Vc(t){return async()=>{const e=t.app.workspace.getActiveFile();if(!e){new y.Notice("No file is currently open.");return}const n=e.path.match(new RegExp(`^(.+)/${Mt.DRAFTS}/(.+)/(.+)\\.md$`));if(!n){new y.Notice("The current file is not a chapter.");return}const i=n[1],a=n[2],s=n[3];try{const l=await t.projectFileService.chapters.listChapters(i,a),o=l.findIndex(f=>f.name===s);if(o===-1){new y.Notice("Unable to find the current chapter in the draft.");return}if(o>=l.length-1)return;const c=l[o+1];await t.openChapter(i,a,c.name)}catch(l){console.error("Failed to navigate to next chapter:",l),new y.Notice("Failed to navigate to next chapter.")}}}function Wc(t){return async()=>{const e=t.app.workspace.getActiveFile();if(!e){new y.Notice("No file is currently open.");return}const n=e.path.match(new RegExp(`^(.+)/${Mt.DRAFTS}/(.+)/(.+)\\.md$`));if(!n){new y.Notice("The current file is not a chapter.");return}const i=n[1],a=n[2],s=n[3];try{const l=await t.projectFileService.chapters.listChapters(i,a),o=l.findIndex(f=>f.name===s);if(o===-1){new y.Notice("Unable to find the current chapter in the draft.");return}if(o<=0)return;const c=l[o-1];await t.openChapter(i,a,c.name)}catch(l){console.error("Failed to navigate to previous chapter:",l),new y.Notice("Failed to navigate to previous chapter.")}}}function zc(t){return()=>t.selectActiveProjectPrompt()}function Hc(t){return()=>t.switchDraftPrompt()}class Io{constructor(e){this.app=e,T(`${A} TemplateService created`)}async render(e,r={}){let n=e||"";return T(`${A} TemplateService.render called with template: "${n.substring(0,100)}${n.length>100?"...":""}", vars:`,Object.keys(r)),!n.includes("{{")&&!n.includes("}}")?(T(`${A} Template doesn't contain template syntax, checking if it's a file path`),await He(async()=>{const i=this.app.vault.getAbstractFileByPath(n);i&&i instanceof y.TFile?(T(`${A} Reading template from file: ${n}`),n=await this.app.vault.read(i),T(`${A} Template loaded from file, length: ${n.length} chars`)):T(`${A} Template path "${n}" is not a valid file, treating as inline template`)})):T(`${A} Template contains template syntax, treating as inline template`),T(`${A} Performing template variable substitution`),n=n.replace(/{{\s*(\w+(?:[-:]\w+)*)\s*}}/g,(i,a)=>{if(r[a]!==void 0)return T(`${A} Substituting variable {{${a}}} with provided value: "${r[a]}"`),r[a];try{const s=window.moment().format(a);return T(`${A} Substituting {{${a}}} with moment.js format: "${s}"`),s}catch{return T(`${A} Neither variable nor moment.js format found for {{${a}}}, returning as-is`),a}}),T(`${A} Template rendering complete, result length: ${n.length} chars`),n}}class Uc extends y.Modal{constructor(e,r){super(e),this.manuscriptPath=r,this.setTitle("Confirm Overwrite")}onOpen(){const{contentEl:e}=this;e.createEl("p",{text:`The manuscript file "${this.manuscriptPath}" already exists. Do you want to overwrite it?`});const r=e.createDiv({cls:"modal-button-container"});new y.ButtonComponent(r).setButtonText("Cancel").onClick(()=>{this.resolve(!1),this.close()}),new y.ButtonComponent(r).setButtonText("Overwrite").setCta().onClick(()=>{this.resolve(!0),this.close()})}onClose(){const{contentEl:e}=this;e.empty()}open(){return new Promise(e=>{this.resolve=e,super.open()})}}class qc{constructor(){this.backupIntervalMinutes=10,this.maxBackups=5,this.maxBackupAgeDays=30}async createBackup(e){}async listBackups(e){return[]}async restoreBackup(e,r){return!1}async deleteBackup(e,r){return!1}async clearOldBackups(e,r){}}class Gc{constructor(e){var r,n,i;this.app=e,this.manager=((i=(n=(r=this.app.plugins).getPlugin)==null?void 0:n.call(r,"obsidian-writeaid-plugin"))==null?void 0:i.manager)??null}async reorderChapters(e,r,n){const i=this.resolveProjectPath(e);if(!i)return!1;const a=this.getDraftsFolderName(i);if(!a)return!1;const s=`${i}/${a}/${r}`;for(let l=0;l<n.length;l++){const{chapterName:o}=n[l],c=`${s}/${o}.md`,f=this.app.vault.getAbstractFileByPath(c);if(f&&f instanceof y.TFile){let h=await this.app.vault.read(f);h.match(/^---\n([\s\S]*?)\n---/)&&(h=h.replace(/^---\n([\s\S]*?)\n---/,(v,m)=>{let u=m.replace(/^order:.*\n?/gm,"");return u.endsWith(`
`)||(u+=`
`),u+=`order: ${l+1}
`,`---
${u}---`}),await this.app.vault.modify(f,h))}}return!0}async listChapters(e,r){T(`${A} ChapterFileService.listChapters: projectPath=${e}, draftName=${r}`);const n=this.resolveProjectPath(e);if(!n)return T(`${A} ChapterFileService.listChapters: no project resolved`),[];const i=this.getDraftsFolderName(n);if(!i)return T(`${A} ChapterFileService.listChapters: no drafts folder found in project ${n}`),[];const a=`${n}/${i}/${r}`;T(`${A} ChapterFileService.listChapters: resolved project=${n}, draftsFolder=${i}, draftFolder=${a}`);const s=this.app.vault.getAbstractFileByPath(a),l=[];if(s&&s instanceof y.TFolder){T(`${A} ChapterFileService.listChapters: found folder with ${s.children.length} children`);for(const o of s.children)o instanceof y.TFile&&o.extension==="md"&&(T(`${A} ChapterFileService.listChapters: processing file ${o.path}`),await He(async()=>{const c=await this.app.vault.read(o);T(`${A} ChapterFileService.listChapters: content length ${c.length}`);const f=c.match(/^---\n([\s\S]*?)\n---/);let h,v;if(f){T(`${A} ChapterFileService.listChapters: found frontmatter`);const g=f[1].split(/\r?\n/);for(const b of g){const _=b.match(/^order:\s*(\d+)/i);_&&(h=parseInt(_[1],10));const $=b.match(/^chapter_name:\s*(.*)$/i);if($){let P=$[1].trim();(P.startsWith('"')&&P.endsWith('"')||P.startsWith("'")&&P.endsWith("'"))&&(P=P.slice(1,-1)),P.length>0&&(v=P)}}}else T(`${A} ChapterFileService.listChapters: no frontmatter`);T(`${A} ChapterFileService.listChapters: parsed order=${h}, chapterName=${v}`);const m=v&&v.length>0?v:o.name.replace(/\.md$/,""),u=typeof h=="number"&&!isNaN(h)?h:0;T(`${A} ChapterFileService.listChapters: adding chapter ${o.name} with name ${m}, order ${u}`),l.push({name:o.name.replace(/\.md$/,""),chapterName:m,order:u})}))}else T(`${A} ChapterFileService.listChapters: no folder found`);return l.sort((o,c)=>o.order-c.order),T(`${A} ChapterFileService.listChapters: returning ${l.length} chapters`),l.map(({name:o,chapterName:c})=>({name:o,chapterName:c}))}async createChapter(e,r,n,i){const a=this.resolveProjectPath(e);if(!a)return!1;const s=this.getDraftsFolderName(a);if(!s)return!1;const l=`${a}/${s}/${r}`,c=`${Et(n,i==null?void 0:i.slugStyle)}.md`,f=`${l}/${c}`;if(this.app.vault.getAbstractFileByPath(f))return!1;let h=0;const v=this.app.vault.getAbstractFileByPath(l);if(v&&v instanceof y.TFolder)for(const b of v.children)b instanceof y.TFile&&b.extension==="md"&&await He(async()=>{const $=(await this.app.vault.read(b)).match(/^---\n([\s\S]*?)\n---/);if($){const P=$[1].split(/\r?\n/);for(const x of P){const N=x.match(/^order:\s*(\d+)/i);if(N){const C=parseInt(N[1],10);!isNaN(C)&&C>h&&(h=C)}}}});const m=h+1;let u=`# ${n}`;const g=`---
order: ${m}
chapter_name: ${JSON.stringify(n)}
---
`;return await this.app.vault.create(f,`${g}
${u}

`),!0}async deleteChapter(e,r,n){const i=this.resolveProjectPath(e);if(!i)return!1;const a=this.getDraftsFolderName(i);if(!a)return!1;const s=`${i}/${a}/${r}`,l=`${n}.md`,o=`${s}/${l}`,c=this.app.vault.getAbstractFileByPath(o);if(c&&c instanceof y.TFile){await this.app.vault.delete(c);const f=await this.listChapters(e,r);for(let h=0;h<f.length;h++){const{name:v}=f[h],m=`${s}/${v}.md`,u=this.app.vault.getAbstractFileByPath(m);if(u&&u instanceof y.TFile){let g=await this.app.vault.read(u);g.match(/^---\n([\s\S]*?)\n---/)&&(g=g.replace(/^---\n([\s\S]*?)\n---/,(b,_)=>{let $=_.replace(/^order:.*\n?/gm,"");return $.endsWith(`
`)||($+=`
`),$+=`order: ${h+1}
`,`---
${$}---`}),await this.app.vault.modify(u,g))}}return!0}return!1}async renameChapter(e,r,n,i){const a=this.resolveProjectPath(e);if(!a)return!1;const s=this.getDraftsFolderName(a);if(!s)return!1;const l=`${a}/${s}/${r}`,o=`${l}/${n}.md`,c=`${l}/${i}.md`,f=this.app.vault.getAbstractFileByPath(o);if(!f||!(f instanceof y.TFile))return!1;let h=await this.app.vault.read(f),v=`# ${i}`;return h.match(/^---\n([\s\S]*?)\n---/)&&(h=h.replace(/^---\n([\s\S]*?)\n---/,(m,u)=>{let g=u.replace(/^chapter_name:.*\n?/gm,"");return g.endsWith(`
`)||(g+=`
`),g+=`chapter_name: ${JSON.stringify(i)}
`,`---
${g}---`})),h=h.replace(/^#.*$/m,v),n!==i?(await this.app.vault.create(c,h),await this.app.vault.delete(f)):await this.app.vault.modify(f,h),!0}async openChapter(e,r,n){const i=this.resolveProjectPath(e);if(!i)return!1;const a=this.getDraftsFolderName(i);if(!a)return!1;const s=`${i}/${a}/${r}/${n}.md`,l=this.app.vault.getAbstractFileByPath(s);return l&&l instanceof y.TFile?(await He(async()=>{await this.app.workspace.getLeaf().openFile(l)}),!0):!1}resolveProjectPath(e){var r;return e||((r=this.manager)==null?void 0:r.activeProject)||null}getFolderName(e){var n;const r=((n=this.manager)==null?void 0:n.settings)||{};switch(e){case"draftsFolderName":return r.draftsFolderName||"drafts";case"manuscriptsFolderName":return r.manuscriptsFolderName||"manuscripts";case"backupsFolderName":return r.backupsFolderName||".writeaid-backups";default:return"drafts"}}getFileName(e){var n;const r=((n=this.manager)==null?void 0:n.settings)||{};switch(e){case"metaFileName":return r.metaFileName||"meta.md";case"outlineFileName":return r.outlineFileName||"outline.md";default:return"meta.md"}}getDraftsFolderName(e){const r=this.app.vault.getAbstractFileByPath(e),n=this.getFolderName("draftsFolderName");if(r&&r instanceof y.TFolder){for(const i of r.children)if(i instanceof y.TFolder&&i.name.toLowerCase()===n.toLowerCase())return i.name}return null}}class Fs{constructor(e,r){this.chapters=new Gc(e),this.drafts=new Yc(e,this.chapters,r)}}class Es{constructor(e){this.app=e,this.tpl=new Io(e),this.projectFileService=new Fs(e,this)}async createProject(e,r,n,i,a){if(!e)return new y.Notice("Project name is required."),null;const s=i&&i!==""?`${i}/${e}`:e,l=`${s}/${Mt.DRAFTS}`;this.app.vault.getAbstractFileByPath(s)||await this.app.vault.createFolder(s),this.app.vault.getAbstractFileByPath(l)||await this.app.vault.createFolder(l);const o=`${s}/meta.md`;if(!this.app.vault.getAbstractFileByPath(o)){const h=`---
project_type: ${r?"single-file":"multi-file"}
---
`;await this.app.vault.create(o,h)}const c=n||"Draft 1";return await this.projectFileService.drafts.createDraft(c,void 0,s,a),s}async openProject(e){const r=`${e}/meta.md`,n=this.app.vault.getAbstractFileByPath(r);if(n&&n instanceof y.TFile)return await this.app.workspace.getLeaf().openFile(n),!0;const i=[`${e}/${e}.md`,`${e}/Chapter 1.md`,`${e}/Chapter 01.md`,`${e}/outline.md`,`${e}/${Mt.DRAFTS}/Draft 1/outline.md`];for(const a of i){const s=this.app.vault.getAbstractFileByPath(a);if(s&&s instanceof y.TFile)return await this.app.workspace.getLeaf().openFile(s),!0}return new y.Notice("Could not find a file to open in the project."),!1}listAllFolders(){const e=this.app.vault.getRoot(),r=[""];function n(i){for(const a of i.children)a instanceof y.TFolder&&(r.push(a.path),n(a))}return n(e),r}async listProjects(){const e=this.listAllFolders(),r=e.filter(i=>!!i);T(`${A} allFolders:`,e),T(`${A} filteredFolders:`,r);const n=await Vn(r,i=>this.isProjectFolder(i));return T(`${A} found ${r.length} folders, ${n.length} projects:`,n),n}async getProjectType(e){const r=`${e}/${es.META}`,n=await bn(this.app,r);if(n&&n.project_type){const i=n.project_type;if(Object.values(zr).includes(i))return i}return null}getDraftsFolder(e){const r=`${e}/${Mt.DRAFTS}`;let n=this.app.vault.getAbstractFileByPath(r);if(n&&n instanceof y.TFolder)return n;const i=`${e}/Drafts`;return n=this.app.vault.getAbstractFileByPath(i),n&&n instanceof y.TFolder?n:null}async getManuscriptsFolder(e){const r=`${e}/${Mt.MANUSCRIPTS}`,n=this.app.vault.getAbstractFileByPath(r);return n&&n instanceof y.TFolder?n:null}async isProjectFolder(e){if(!e||typeof e!="string")return!1;const r=e.trim().replace(/\\/g,"/").replace(/\/+$/,"");try{const n=y.normalizePath(`${r}/${es.META}`),i=await this.app.vault.adapter.exists(n),a=y.normalizePath(`${r}/${Mt.DRAFTS}`);let s=await this.app.vault.adapter.exists(a);if(!s){const l=y.normalizePath(`${r}/Drafts`);s=await this.app.vault.adapter.exists(l)}if(!i&&!s)return!1;if(i)try{const{readMetaFile:l}=await Promise.resolve().then(()=>rs),{VALID_PROJECT_TYPES:o}=await Promise.resolve().then(()=>Nc),c=await l(this.app,n);if(!c||!o.includes(c.project_type))return!1}catch{return!1}return!0}catch{return!1}}}class Yc{constructor(e,r,n){var i,a,s;this.app=e,this.tpl=new Io(e),this.projectSvc=n,this.backupSvc=new qc,this.chapters=r,this.manager=((s=(a=(i=this.app.plugins).getPlugin)==null?void 0:a.call(i,"obsidian-writeaid-plugin"))==null?void 0:s.manager)??null}resolveProjectPath(e){var r;return e||((r=this.manager)==null?void 0:r.activeProject)||null}getFolderName(e){var n;const r=((n=this.manager)==null?void 0:n.settings)||{};switch(e){case"draftsFolderName":return r.draftsFolderName||"drafts";case"manuscriptsFolderName":return r.manuscriptsFolderName||"manuscripts";case"backupsFolderName":return r.backupsFolderName||".writeaid-backups";default:return"drafts"}}getFileName(e){var n;const r=((n=this.manager)==null?void 0:n.settings)||{};switch(e){case"metaFileName":return r.metaFileName||"meta.md";case"outlineFileName":return r.outlineFileName||"outline.md";default:return"meta.md"}}getDraftsFolderName(e){const r=this.app.vault.getAbstractFileByPath(e),n=this.getFolderName("draftsFolderName");if(r&&r instanceof y.TFolder){for(const i of r.children)if(i instanceof y.TFolder&&i.name.toLowerCase()===n.toLowerCase())return i.name}return null}async suggestNextDraftName(e){const r=this.resolveProjectPath(e);if(!r)return"Draft 1";const n=`${r}/${this.getFileName("metaFileName")}`;let i=0;return await He(async()=>{const a=await bn(this.app,n);a&&typeof a.total_drafts=="number"&&(i=a.total_drafts)}),`Draft ${i+1}`}async createDraft(e,r,n,i){const a=this.resolveProjectPath(n);if(!a){new y.Notice("No project folder detected. Please open a folder named after your project.");return}const l=this.getDraftsFolderName(a)||this.getFolderName("draftsFolderName"),o=`${a}/${l}`,c=`${o}/${e}`,f=a.split("/").pop()||a;if(this.app.vault.getAbstractFileByPath(o)||await this.app.vault.createFolder(o),this.app.vault.getAbstractFileByPath(c)||await this.app.vault.createFolder(c),r){const h=`${o}/${r}`,v=this.app.vault.getFiles().filter(g=>g.path.startsWith(h)),u=`${Et(r,i==null?void 0:i.slugStyle)}.md`;for(const g of v){let b=g.path.substring(h.length+1);b===u&&(b=`${Et(e,i==null?void 0:i.slugStyle)}.md`);const _=`${c}/${b}`,$=_.substring(0,_.lastIndexOf("/"));$!==c&&!this.app.vault.getAbstractFileByPath($)&&await this.app.vault.createFolder($);let P=await this.app.vault.read(g);P=Xc(P,e,f),await this.app.vault.create(_,P)}}else{if((i==null?void 0:i.includeDraftOutline)===!0){const m=(i==null?void 0:i.draftOutlineTemplate)??"",u=await this.tpl.render(m,{draftName:e});await this.app.vault.create(`${c}/outline.md`,u)}if(await this.projectSvc.getProjectType(a)===zr.SINGLE){const u=`${Et(e,i==null?void 0:i.slugStyle)}.md`,g=`${c}/${u}`;if(!this.app.vault.getAbstractFileByPath(g)){const b=`---
draft: ${e}
project: ${f}
created: ${new Date().toISOString()}
---

`,_=await this.tpl.render("# {{draftName}}",{draftName:e});await this.app.vault.create(g,b+_)}}else{const m=this.app.vault.getAbstractFileByPath(c);let u=!1;if(m&&m instanceof y.TFolder){for(const g of m.children)if(g instanceof y.TFile&&g.extension==="md"&&(await He(async()=>{const _=(await this.app.vault.read(g)).match(/^---\n([\s\S]*?)\n---/);if(_){const $=_[1].split(/\r?\n/);for(const P of $){const x=P.match(/^order:\s*(\d+)/i);if(x&&!isNaN(parseInt(x[1],10))){u=!0;break}}}}),u))break}u||await this.chapters.createChapter(a,e,"Chapter 1",i)}}await Rn(this.app,a,e)}listDrafts(e){var i;const r=this.resolveProjectPath(e);if(T(`${A} listDrafts called with projectPath:`,e,"resolved to:",r),!r)return[];const n=this.projectSvc.getDraftsFolder(r);if(T(`${A} getDraftsFolder for ${r} returned:`,n==null?void 0:n.path,(i=n==null?void 0:n.children)==null?void 0:i.length),n&&n instanceof y.TFolder){const a=n.children.filter(s=>s instanceof y.TFolder).map(s=>s.name);return T(`${A} found drafts:`,a),a}return[]}async openDraft(e,r){const n=this.resolveProjectPath(e);if(!n)return!1;const i=this.getDraftsFolderName(n);if(!i)return!1;const a=`${n}/${i}/${r}/${this.getFileName("outlineFileName")}`,s=this.app.vault.getAbstractFileByPath(a);if(await He(async()=>s&&s instanceof y.TFile?(await this.app.workspace.getLeaf().openFile(s),!0):!1))return!0;const o=`${n}/${i}/${r}`,c=this.app.vault.getFiles().filter(f=>f.path.startsWith(o));return c.length>0?(await this.app.workspace.getLeaf().openFile(c[0]),!0):!1}async renameDraft(e,r,n,i=!1,a){const s=this.resolveProjectPath(e);if(!s)return!1;const l=this.getDraftsFolderName(s);if(!l)return!1;const o=`${s}/${l}/${r}`,c=`${s}/${l}/${n}`;try{this.app.vault.getAbstractFileByPath(c)||await this.app.vault.createFolder(c);const f=this.app.vault.getFiles().filter(b=>b.path.startsWith(o));let h="",v="";if(i){const b=a==null?void 0:a.slugStyle;h=Et(r,b),v=Et(n,b)}for(const b of f){let _=b.path.substring(o.length+1),$=`${c}/${_}`;i&&h&&v&&_===`${h}.md`&&(_=`${v}.md`,$=`${c}/${_}`);let P=await this.app.vault.read(b);b.extension==="md"&&(P=P.replace(/^(---\s*\n[\s\S]*?\n)(draft:.*\n)?/m,(x,N)=>N.replace(/^draft:.*\n/m,"").replace(/^(---\s*\n)/,`$1draft: ${n}
`))),await this.app.vault.create($,P),await this.app.vault.delete(b)}const m=this.app.vault.getAbstractFileByPath(o);m&&m instanceof y.TFolder&&await this.app.vault.delete(m,!0),await He(async()=>{await Promise.resolve().then(()=>rs).then(b=>b.updateMetaStats(this.app,s,n))});const u=`${c}/${this.getFileName("metaFileName")}`;return this.app.vault.getAbstractFileByPath(u)&&await He(async()=>{const{readMetaFile:b,writeMetaFile:_}=await Promise.resolve().then(()=>rs),$=await b(this.app,u);$&&($.draft=n,await _(this.app,u,$))}),!0}catch{return!1}}async deleteDraft(e,r,n=!0){const i=this.resolveProjectPath(e);if(!i)return!1;const a=this.getDraftsFolderName(i);if(!a)return!1;const s=`${i}/${a}/${r}`;try{const l=this.app.vault.getFiles().filter(c=>c.path.startsWith(s));n&&await this.backupSvc.createBackup(s);for(const c of l)await He(async()=>{await this.app.vault.delete(c)});const o=this.app.vault.getAbstractFileByPath(s);return o&&o instanceof y.TFolder&&await He(async()=>{await this.app.vault.delete(o)}),!0}catch{return!1}}async generateManuscript(e,r,n){const i=this.resolveProjectPath(e);if(!i)return!1;const a=this.getDraftsFolderName(i);if(!a)return!1;const s=await this.projectSvc.getProjectType(i),l=`${i}/${a}/${r}`;if(!this.app.vault.getAbstractFileByPath(l))return new y.Notice(`Draft folder ${l} does not exist.`),!1;const o=`${i}/${this.getFolderName("manuscriptsFolderName")}`;this.app.vault.getAbstractFileByPath(o)||await this.app.vault.createFolder(o);const c=i.split("/").pop()||i,f=(n==null?void 0:n.manuscriptNameTemplate)||"{{draftName}}";T(`${A} DraftFileService.generateManuscript - manuscriptNameTemplate: "${f}"`),T(`${A} DraftFileService.generateManuscript - settings object:`,n);const h=Et(r,n==null?void 0:n.slugStyle),v=await this.tpl.render(f,{draftName:r,projectName:c,draftSlug:h}),m=`${o}/${v}.md`;let u=`# Manuscript for ${r}

`;if(s===zr.SINGLE){const g=`${h}.md`,b=`${l}/${g}`,_=this.app.vault.getAbstractFileByPath(b);if(_&&_ instanceof y.TFile){const $=await this.app.vault.read(_);u+=Kc(Jc($));const P=this.app.vault.getAbstractFileByPath(m);if(P&&P instanceof y.TFile){if(!await new Uc(this.app,m).open())return!1;T(`${A} Overwriting existing manuscript: ${m}`),await this.app.vault.modify(P,u)}else T(`${A} Creating new manuscript: ${m}`),await this.app.vault.create(m,u)}else return new y.Notice(`Main draft file ${b} not found.`),!1}return!0}}function Jc(t){return t.replace(/^---\n([\s\S]*?)\n---/,"").trim()}function Kc(t){return t.replace(/^#{1,6} .*\n/,"").trim()}function Xc(t,e,r){const n=t.match(/^---\n([\s\S]*?)\n---/);if(!n)return t;const i=n[1],a=t.substring(n[0].length),s=i.split(`
`),l=[];for(const c of s)c.match(/^draft:/i)?l.push(`draft: ${e}`):c.match(/^project:/i)?l.push(`project: ${r}`):c.match(/^created:/i)?l.push(`created: ${new Date().toISOString()}`):l.push(c);return`---
${l.join(`
`)}
---${a}`}const Bo="pen-tool",Zc="5";var Ro;typeof window<"u"&&((Ro=window.__svelte??(window.__svelte={})).v??(Ro.v=new Set)).add(Zc);let ri=!1,Qc=!1;function eu(){ri=!0}eu();const ha=1,pa=2,Vo=4,tu=8,ru=16,nu=1,iu=2,au=4,su=8,ou=16,lu=1,cu=2,Wo="[",va="[!",js="]",Jn={},Be=Symbol(),uu="http://www.w3.org/1999/xhtml",fu="http://www.w3.org/2000/svg",du="@attach",zo=!1;var ni=Array.isArray,hu=Array.prototype.indexOf,As=Array.from,ea=Object.keys,Kn=Object.defineProperty,er=Object.getOwnPropertyDescriptor,Ho=Object.getOwnPropertyDescriptors,pu=Object.prototype,vu=Array.prototype,Ts=Object.getPrototypeOf,oo=Object.isExtensible;function Mn(t){return typeof t=="function"}const Ke=()=>{};function mu(t){return t()}function ns(t){for(var e=0;e<t.length;e++)t[e]()}function Uo(){var t,e,r=new Promise((n,i)=>{t=n,e=i});return{promise:r,resolve:t,reject:e}}function gu(t,e){if(Array.isArray(t))return t;if(!(Symbol.iterator in t))return Array.from(t);const r=[];for(const n of t)if(r.push(n),r.length===e)break;return r}const ct=2,Ns=4,ma=8,wn=16,yr=32,Gr=64,Ds=128,jt=256,ta=512,Ue=1024,bt=2048,_r=4096,It=8192,yn=16384,Os=32768,ii=65536,lo=1<<17,bu=1<<18,_n=1<<19,qo=1<<20,is=1<<21,ga=1<<22,ln=1<<23,tr=Symbol("$state"),Ls=Symbol("legacy props"),wu=Symbol(""),xi=new class extends Error{constructor(){super(...arguments);Ge(this,"name","StaleReactionError");Ge(this,"message","The reaction that called `getAbortSignal()` was re-run or destroyed")}},yu=1,ba=3,ai=8;function wa(t){throw new Error("https://svelte.dev/e/lifecycle_outside_component")}function _u(){throw new Error("https://svelte.dev/e/async_derived_orphan")}function xu(t){throw new Error("https://svelte.dev/e/effect_in_teardown")}function $u(){throw new Error("https://svelte.dev/e/effect_in_unowned_derived")}function Su(t){throw new Error("https://svelte.dev/e/effect_orphan")}function Pu(){throw new Error("https://svelte.dev/e/effect_update_depth_exceeded")}function Cu(){throw new Error("https://svelte.dev/e/hydration_failed")}function ku(t){throw new Error("https://svelte.dev/e/lifecycle_legacy_only")}function Fu(t){throw new Error("https://svelte.dev/e/props_invalid_value")}function Eu(){throw new Error("https://svelte.dev/e/state_descriptors_fixed")}function ju(){throw new Error("https://svelte.dev/e/state_prototype_fixed")}function Au(){throw new Error("https://svelte.dev/e/state_unsafe_mutation")}function Tu(){throw new Error("https://svelte.dev/e/svelte_boundary_reset_onerror")}function ya(t){console.warn("https://svelte.dev/e/hydration_mismatch")}function Nu(){console.warn("https://svelte.dev/e/select_multiple_invalid_value")}function Du(){console.warn("https://svelte.dev/e/svelte_boundary_reset_noop")}let B=!1;function at(t){B=t}let X;function Ve(t){if(t===null)throw ya(),Jn;return X=t}function hn(){return Ve(or(X))}function V(t){if(B){if(or(X)!==null)throw ya(),Jn;X=t}}function Or(t=1){if(B){for(var e=t,r=X;e--;)r=or(r);X=r}}function ra(t=!0){for(var e=0,r=X;;){if(r.nodeType===ai){var n=r.data;if(n===js){if(e===0)return r;e-=1}else(n===Wo||n===va)&&(e+=1)}var i=or(r);t&&r.remove(),r=i}}function Go(t){if(!t||t.nodeType!==ai)throw ya(),Jn;return t.data}function Yo(t){return t===this.v}function Jo(t,e){return t!=t?e==e:t!==e||t!==null&&typeof t=="object"||typeof t=="function"}function Ko(t){return!Jo(t,this.v)}let ve=null;function Xn(t){ve=t}function ut(t,e=!1,r){ve={p:ve,c:null,e:null,s:t,x:null,l:ri&&!e?{s:null,u:null,$:[]}:null}}function ft(t){var e=ve,r=e.e;if(r!==null){e.e=null;for(var n of r)ml(n)}return t!==void 0&&(e.x=t),ve=e.p,t??{}}function Ni(){return!ri||ve!==null&&ve.l===null}let tn=[];function Xo(){var t=tn;tn=[],ns(t)}function nr(t){if(tn.length===0&&!$i){var e=tn;queueMicrotask(()=>{e===tn&&Xo()})}tn.push(t)}function Ou(){for(;tn.length>0;)Xo()}const Lu=new WeakMap;function Zo(t){var e=Q;if(e===null)return ee.f|=ln,t;if(e.f&Os)Zn(t,e);else{if(!(e.f&Ds))throw!e.parent&&t instanceof Error&&Qo(t),t;e.b.error(t)}}function Zn(t,e){for(;e!==null;){if(e.f&Ds)try{e.b.error(t);return}catch(r){t=r}e=e.parent}throw t instanceof Error&&Qo(t),t}function Qo(t){const e=Lu.get(t);e&&(Kn(t,"message",{value:e.message}),Kn(t,"stack",{value:e.stack}))}const Bi=new Set;let we=null,Yi=null,as=new Set,Xt=[],_a=null,ss=!1,$i=!1;var Hn,Un,rn,Ei,qn,Gn,nn,Yn,ji,Ai,At,os,Ji,ls;const Bn=class Bn{constructor(){ce(this,At);Ge(this,"current",new Map);ce(this,Hn,new Map);ce(this,Un,new Set);ce(this,rn,0);ce(this,Ei,null);ce(this,qn,[]);ce(this,Gn,[]);ce(this,nn,[]);ce(this,Yn,[]);ce(this,ji,[]);ce(this,Ai,[]);Ge(this,"skipped_effects",new Set)}process(e){var a;Xt=[],Yi=null;var r=Bn.apply(this);for(const s of e)Ie(this,At,os).call(this,s);if(F(this,rn)===0){Ie(this,At,ls).call(this);var n=F(this,Gn),i=F(this,nn);z(this,Gn,[]),z(this,nn,[]),z(this,Yn,[]),Yi=this,we=null,co(n),co(i),Yi=null,(a=F(this,Ei))==null||a.resolve()}else Ie(this,At,Ji).call(this,F(this,Gn)),Ie(this,At,Ji).call(this,F(this,nn)),Ie(this,At,Ji).call(this,F(this,Yn));r();for(const s of F(this,qn))ei(s);z(this,qn,[])}capture(e,r){F(this,Hn).has(e)||F(this,Hn).set(e,r),this.current.set(e,e.v)}activate(){we=this}deactivate(){we=null}flush(){if(Xt.length>0){if(this.activate(),el(),we!==null&&we!==this)return}else F(this,rn)===0&&Ie(this,At,ls).call(this);this.deactivate();for(const e of as)if(as.delete(e),e(),we!==null)break}increment(){z(this,rn,F(this,rn)+1)}decrement(){z(this,rn,F(this,rn)-1);for(const e of F(this,ji))Xe(e,bt),pn(e);for(const e of F(this,Ai))Xe(e,_r),pn(e);this.flush()}add_callback(e){F(this,Un).add(e)}settled(){return(F(this,Ei)??z(this,Ei,Uo())).promise}static ensure(){if(we===null){const e=we=new Bn;Bi.add(we),$i||Bn.enqueue(()=>{we===e&&e.flush()})}return we}static enqueue(e){nr(e)}static apply(e){return Ke}};Hn=new WeakMap,Un=new WeakMap,rn=new WeakMap,Ei=new WeakMap,qn=new WeakMap,Gn=new WeakMap,nn=new WeakMap,Yn=new WeakMap,ji=new WeakMap,Ai=new WeakMap,At=new WeakSet,os=function(e){var c;e.f^=Ue;for(var r=e.first;r!==null;){var n=r.f,i=(n&(yr|Gr))!==0,a=i&&(n&Ue)!==0,s=a||(n&It)!==0||this.skipped_effects.has(r);if(!s&&r.fn!==null){i?r.f^=Ue:n&Ns?F(this,nn).push(r):n&Ue||(n&ga&&((c=r.b)!=null&&c.is_pending())?F(this,qn).push(r):Oi(r)&&(r.f&wn&&F(this,Yn).push(r),ei(r)));var l=r.first;if(l!==null){r=l;continue}}var o=r.parent;for(r=r.next;r===null&&o!==null;)r=o.next,o=o.parent}},Ji=function(e){for(const r of e)(r.f&bt?F(this,ji):F(this,Ai)).push(r),Xe(r,Ue);e.length=0},ls=function(){var e;for(const r of F(this,Un))r();if(F(this,Un).clear(),Bi.size>1){F(this,Hn).clear();let r=!0;for(const n of Bi){if(n===this){r=!1;continue}for(const[i,a]of this.current){if(n.current.has(i))if(r)n.current.set(i,a);else continue;tl(i)}if(Xt.length>0){we=n;const i=Bn.apply(n);for(const a of Xt)Ie(e=n,At,os).call(e,a);Xt=[],i()}}we=null}Bi.delete(this)};let Qt=Bn;function O(t){var e=$i;$i=!0;try{for(var r;;){if(Ou(),Xt.length===0&&(we==null||we.flush(),Xt.length===0))return _a=null,r;el()}}finally{$i=e}}function el(){var t=Wn;ss=!0;try{var e=0;for(ho(!0);Xt.length>0;){var r=Qt.ensure();if(e++>1e3){var n,i;Mu()}r.process(Xt),Hr.clear()}}finally{ss=!1,ho(t),_a=null}}function Mu(){try{Pu()}catch(t){Zn(t,_a)}}let mr=null;function co(t){var e=t.length;if(e!==0){for(var r=0;r<e;){var n=t[r++];if(!(n.f&(yn|It))&&Oi(n)&&(mr=[],ei(n),n.deps===null&&n.first===null&&n.nodes_start===null&&(n.teardown===null&&n.ac===null?wl(n):n.fn=null),(mr==null?void 0:mr.length)>0)){Hr.clear();for(const i of mr)ei(i);mr=[]}}mr=null}}function tl(t){if(t.reactions!==null)for(const e of t.reactions){const r=e.f;r&ct?tl(e):r&(ga|wn)&&(Xe(e,bt),pn(e))}}function pn(t){for(var e=_a=t;e.parent!==null;){e=e.parent;var r=e.f;if(ss&&e===Q&&r&wn)return;if(r&(Gr|yr)){if(!(r&Ue))return;e.f^=Ue}}Xt.push(e)}function Ru(t){let e=0,r=vn(0),n;return()=>{Xu()&&(p(r),xn(()=>(e===0&&(n=ge(()=>t(()=>Si(r)))),e+=1,()=>{nr(()=>{e-=1,e===0&&(n==null||n(),n=void 0,Si(r))})})))}}var Iu=ii|_n|Ds;function Bu(t,e,r){new Vu(t,e,r)}var Lt,mt,Ti,Yt,an,Jt,kt,ot,Kt,Rr,sn,Ir,on,Br,fa,da,qe,rl,nl,Ki,Xi,cs;class Vu{constructor(e,r,n){ce(this,qe);Ge(this,"parent");ce(this,Lt,!1);ce(this,mt);ce(this,Ti,B?X:null);ce(this,Yt);ce(this,an);ce(this,Jt);ce(this,kt,null);ce(this,ot,null);ce(this,Kt,null);ce(this,Rr,null);ce(this,sn,0);ce(this,Ir,0);ce(this,on,!1);ce(this,Br,null);ce(this,fa,()=>{F(this,Br)&&Qn(F(this,Br),F(this,sn))});ce(this,da,Ru(()=>(z(this,Br,vn(F(this,sn))),()=>{z(this,Br,null)})));z(this,mt,e),z(this,Yt,r),z(this,an,n),this.parent=Q.b,z(this,Lt,!!F(this,Yt).pending),z(this,Jt,$n(()=>{if(Q.b=this,B){const i=F(this,Ti);hn(),i.nodeType===ai&&i.data===va?Ie(this,qe,nl).call(this):Ie(this,qe,rl).call(this)}else{try{z(this,kt,Je(()=>n(F(this,mt))))}catch(i){this.error(i)}F(this,Ir)>0?Ie(this,qe,Xi).call(this):z(this,Lt,!1)}},Iu)),B&&z(this,mt,X)}is_pending(){return F(this,Lt)||!!this.parent&&this.parent.is_pending()}has_pending_snippet(){return!!F(this,Yt).pending}update_pending_count(e){Ie(this,qe,cs).call(this,e),z(this,sn,F(this,sn)+e),as.add(F(this,fa))}get_effect_pending(){return F(this,da).call(this),p(F(this,Br))}error(e){var r=F(this,Yt).onerror;let n=F(this,Yt).failed;if(F(this,on)||!r&&!n)throw e;F(this,kt)&&(We(F(this,kt)),z(this,kt,null)),F(this,ot)&&(We(F(this,ot)),z(this,ot,null)),F(this,Kt)&&(We(F(this,Kt)),z(this,Kt,null)),B&&(Ve(F(this,Ti)),Or(),Ve(ra()));var i=!1,a=!1;const s=()=>{if(i){Du();return}i=!0,a&&Tu(),Qt.ensure(),z(this,sn,0),F(this,Kt)!==null&&cn(F(this,Kt),()=>{z(this,Kt,null)}),z(this,Lt,this.has_pending_snippet()),z(this,kt,Ie(this,qe,Ki).call(this,()=>(z(this,on,!1),Je(()=>F(this,an).call(this,F(this,mt)))))),F(this,Ir)>0?Ie(this,qe,Xi).call(this):z(this,Lt,!1)};var l=ee;try{lt(null),a=!0,r==null||r(e,s),a=!1}catch(o){Zn(o,F(this,Jt)&&F(this,Jt).parent)}finally{lt(l)}n&&nr(()=>{z(this,Kt,Ie(this,qe,Ki).call(this,()=>{z(this,on,!0);try{return Je(()=>{n(F(this,mt),()=>e,()=>s)})}catch(o){return Zn(o,F(this,Jt).parent),null}finally{z(this,on,!1)}}))})}}Lt=new WeakMap,mt=new WeakMap,Ti=new WeakMap,Yt=new WeakMap,an=new WeakMap,Jt=new WeakMap,kt=new WeakMap,ot=new WeakMap,Kt=new WeakMap,Rr=new WeakMap,sn=new WeakMap,Ir=new WeakMap,on=new WeakMap,Br=new WeakMap,fa=new WeakMap,da=new WeakMap,qe=new WeakSet,rl=function(){try{z(this,kt,Je(()=>F(this,an).call(this,F(this,mt))))}catch(e){this.error(e)}z(this,Lt,!1)},nl=function(){const e=F(this,Yt).pending;e&&(z(this,ot,Je(()=>e(F(this,mt)))),Qt.enqueue(()=>{z(this,kt,Ie(this,qe,Ki).call(this,()=>(Qt.ensure(),Je(()=>F(this,an).call(this,F(this,mt)))))),F(this,Ir)>0?Ie(this,qe,Xi).call(this):(cn(F(this,ot),()=>{z(this,ot,null)}),z(this,Lt,!1))}))},Ki=function(e){var r=Q,n=ee,i=ve;ar(F(this,Jt)),lt(F(this,Jt)),Xn(F(this,Jt).ctx);try{return e()}catch(a){return Zo(a),null}finally{ar(r),lt(n),Xn(i)}},Xi=function(){const e=F(this,Yt).pending;F(this,kt)!==null&&(z(this,Rr,document.createDocumentFragment()),Wu(F(this,kt),F(this,Rr))),F(this,ot)===null&&z(this,ot,Je(()=>e(F(this,mt))))},cs=function(e){var r;if(!this.has_pending_snippet()){this.parent&&Ie(r=this.parent,qe,cs).call(r,e);return}z(this,Ir,F(this,Ir)+e),F(this,Ir)===0&&(z(this,Lt,!1),F(this,ot)&&cn(F(this,ot),()=>{z(this,ot,null)}),F(this,Rr)&&(F(this,mt).before(F(this,Rr)),z(this,Rr,null)),nr(()=>{Qt.ensure().flush()}))};function Wu(t,e){for(var r=t.nodes_start,n=t.nodes_end;r!==null;){var i=r===n?null:or(r);e.append(r),r=i}}function il(t,e,r){const n=Ni()?Di:Pi;if(e.length===0){r(t.map(n));return}var i=we,a=Q,s=zu(),l=B;Promise.all(e.map(o=>Hu(o))).then(o=>{s();try{r([...t.map(n),...o])}catch(c){a.f&yn||Zn(c,a)}l&&at(!1),i==null||i.deactivate(),al()}).catch(o=>{Zn(o,a)})}function zu(){var t=Q,e=ee,r=ve,n=we,i=B;if(i)var a=X;return function(){ar(t),lt(e),Xn(r),n==null||n.activate(),i&&(at(!0),Ve(a))}}function al(){ar(null),lt(null),Xn(null)}function Di(t){var e=ct|bt,r=ee!==null&&ee.f&ct?ee:null;return Q===null||r!==null&&r.f&jt?e|=jt:Q.f|=_n,{ctx:ve,deps:null,effects:null,equals:Yo,f:e,fn:t,reactions:null,rv:0,v:Be,wv:0,parent:r??Q,ac:null}}function Hu(t,e){let r=Q;r===null&&_u();var n=r.b,i=void 0,a=vn(Be),s=!ee,l=new Map;return rf(()=>{var v;var o=Uo();i=o.promise;try{Promise.resolve(t()).then(o.resolve,o.reject)}catch(m){o.reject(m)}var c=we,f=n.is_pending();s&&(n.update_pending_count(1),f||(c.increment(),(v=l.get(c))==null||v.reject(xi),l.set(c,o)));const h=(m,u=void 0)=>{f||c.activate(),u?u!==xi&&(a.f|=ln,Qn(a,u)):(a.f&ln&&(a.f^=ln),Qn(a,m)),s&&(n.update_pending_count(-1),f||c.decrement()),al()};o.promise.then(h,m=>h(null,m||"unknown"))}),$a(()=>{for(const o of l.values())o.reject(xi)}),new Promise(o=>{function c(f){function h(){f===i?o(a):c(i)}f.then(h,h)}c(i)})}function Uu(t){const e=Di(t);return xl(e),e}function Pi(t){const e=Di(t);return e.equals=Ko,e}function sl(t){var e=t.effects;if(e!==null){t.effects=null;for(var r=0;r<e.length;r+=1)We(e[r])}}function qu(t){for(var e=t.parent;e!==null;){if(!(e.f&ct))return e;e=e.parent}return null}function Ms(t){var e,r=Q;ar(qu(t));try{sl(t),e=Cl(t)}finally{ar(r)}return e}function ol(t){var e=Ms(t);if(t.equals(e)||(t.v=e,t.wv=Sl()),!Sn){var r=(Vr||t.f&jt)&&t.deps!==null?_r:Ue;Xe(t,r)}}const Hr=new Map;function vn(t,e){var r={f:0,v:t,reactions:null,equals:Yo,rv:0,wv:0};return r}function Dr(t,e){const r=vn(t);return xl(r),r}function te(t,e=!1,r=!0){var i;const n=vn(t);return e||(n.equals=Ko),ri&&r&&ve!==null&&ve.l!==null&&((i=ve.l).s??(i.s=[])).push(n),n}function Vi(t,e){return k(t,ge(()=>p(t))),e}function k(t,e,r=!1){ee!==null&&(!Rt||ee.f&lo)&&Ni()&&ee.f&(ct|wn|ga|lo)&&!(st!=null&&st.includes(t))&&Au();let n=r?In(e):e;return Qn(t,n)}function Qn(t,e){if(!t.equals(e)){var r=t.v;Sn?Hr.set(t,e):Hr.set(t,r),t.v=e;var n=Qt.ensure();n.capture(t,r),t.f&ct&&(t.f&bt&&Ms(t),Xe(t,t.f&jt?_r:Ue)),t.wv=Sl(),ll(t,bt),Ni()&&Q!==null&&Q.f&Ue&&!(Q.f&(yr|Gr))&&(Ct===null?sf([t]):Ct.push(t))}return e}function Si(t){k(t,t.v+1)}function ll(t,e){var r=t.reactions;if(r!==null)for(var n=Ni(),i=r.length,a=0;a<i;a++){var s=r[a],l=s.f;if(!(!n&&s===Q)){var o=(l&bt)===0;o&&Xe(s,e),l&ct?ll(s,_r):o&&(l&wn&&mr!==null&&mr.push(s),pn(s))}}}function In(t){if(typeof t!="object"||t===null||tr in t)return t;const e=Ts(t);if(e!==pu&&e!==vu)return t;var r=new Map,n=ni(t),i=Dr(0),a=un,s=l=>{if(un===a)return l();var o=ee,c=un;lt(null),vo(a);var f=l();return lt(o),vo(c),f};return n&&r.set("length",Dr(t.length)),new Proxy(t,{defineProperty(l,o,c){(!("value"in c)||c.configurable===!1||c.enumerable===!1||c.writable===!1)&&Eu();var f=r.get(o);return f===void 0?f=s(()=>{var h=Dr(c.value);return r.set(o,h),h}):k(f,c.value,!0),!0},deleteProperty(l,o){var c=r.get(o);if(c===void 0){if(o in l){const f=s(()=>Dr(Be));r.set(o,f),Si(i)}}else k(c,Be),Si(i);return!0},get(l,o,c){var m;if(o===tr)return t;var f=r.get(o),h=o in l;if(f===void 0&&(!h||(m=er(l,o))!=null&&m.writable)&&(f=s(()=>{var u=In(h?l[o]:Be),g=Dr(u);return g}),r.set(o,f)),f!==void 0){var v=p(f);return v===Be?void 0:v}return Reflect.get(l,o,c)},getOwnPropertyDescriptor(l,o){var c=Reflect.getOwnPropertyDescriptor(l,o);if(c&&"value"in c){var f=r.get(o);f&&(c.value=p(f))}else if(c===void 0){var h=r.get(o),v=h==null?void 0:h.v;if(h!==void 0&&v!==Be)return{enumerable:!0,configurable:!0,value:v,writable:!0}}return c},has(l,o){var v;if(o===tr)return!0;var c=r.get(o),f=c!==void 0&&c.v!==Be||Reflect.has(l,o);if(c!==void 0||Q!==null&&(!f||(v=er(l,o))!=null&&v.writable)){c===void 0&&(c=s(()=>{var m=f?In(l[o]):Be,u=Dr(m);return u}),r.set(o,c));var h=p(c);if(h===Be)return!1}return f},set(l,o,c,f){var P;var h=r.get(o),v=o in l;if(n&&o==="length")for(var m=c;m<h.v;m+=1){var u=r.get(m+"");u!==void 0?k(u,Be):m in l&&(u=s(()=>Dr(Be)),r.set(m+"",u))}if(h===void 0)(!v||(P=er(l,o))!=null&&P.writable)&&(h=s(()=>Dr(void 0)),k(h,In(c)),r.set(o,h));else{v=h.v!==Be;var g=s(()=>In(c));k(h,g)}var b=Reflect.getOwnPropertyDescriptor(l,o);if(b!=null&&b.set&&b.set.call(f,c),!v){if(n&&typeof o=="string"){var _=r.get("length"),$=Number(o);Number.isInteger($)&&$>=_.v&&k(_,$+1)}Si(i)}return!0},ownKeys(l){p(i);var o=Reflect.ownKeys(l).filter(h=>{var v=r.get(h);return v===void 0||v.v!==Be});for(var[c,f]of r)f.v!==Be&&!(c in l)&&o.push(c);return o},setPrototypeOf(){ju()}})}function uo(t){try{if(t!==null&&typeof t=="object"&&tr in t)return t[tr]}catch{}return t}function Gu(t,e){return Object.is(uo(t),uo(e))}var na,cl,ul,fl;function us(){if(na===void 0){na=window,cl=/Firefox/.test(navigator.userAgent);var t=Element.prototype,e=Node.prototype,r=Text.prototype;ul=er(e,"firstChild").get,fl=er(e,"nextSibling").get,oo(t)&&(t.__click=void 0,t.__className=void 0,t.__attributes=null,t.__style=void 0,t.__e=void 0),oo(r)&&(r.__t=void 0)}}function Tt(t=""){return document.createTextNode(t)}function ir(t){return ul.call(t)}function or(t){return fl.call(t)}function U(t,e){if(!B)return ir(t);var r=ir(X);if(r===null)r=X.appendChild(Tt());else if(e&&r.nodeType!==ba){var n=Tt();return r==null||r.before(n),Ve(n),n}return Ve(r),r}function ke(t,e=!1){if(!B){var r=ir(t);return r instanceof Comment&&r.data===""?or(r):r}if(e&&(X==null?void 0:X.nodeType)!==ba){var n=Tt();return X==null||X.before(n),Ve(n),n}return X}function H(t,e=1,r=!1){let n=B?X:t;for(var i;e--;)i=n,n=or(n);if(!B)return n;if(r&&(n==null?void 0:n.nodeType)!==ba){var a=Tt();return n===null?i==null||i.after(a):n.before(a),Ve(a),a}return Ve(n),n}function dl(t){t.textContent=""}function hl(){return!1}function Yu(t,e){if(e){const r=document.body;t.autofocus=!0,nr(()=>{document.activeElement===r&&t.focus()})}}let fo=!1;function pl(){fo||(fo=!0,document.addEventListener("reset",t=>{Promise.resolve().then(()=>{var e;if(!t.defaultPrevented)for(const r of t.target.elements)(e=r.__on_r)==null||e.call(r)})},{capture:!0}))}function xa(t){var e=ee,r=Q;lt(null),ar(null);try{return t()}finally{lt(e),ar(r)}}function Ju(t,e,r,n=r){t.addEventListener(e,()=>xa(r));const i=t.__on_r;i?t.__on_r=()=>{i(),n(!0)}:t.__on_r=()=>n(!0),pl()}function vl(t){Q===null&&ee===null&&Su(),ee!==null&&ee.f&jt&&Q===null&&$u(),Sn&&xu()}function Ku(t,e){var r=e.last;r===null?e.last=e.first=t:(r.next=t,t.prev=r,e.last=t)}function zt(t,e,r,n=!0){var i=Q;i!==null&&i.f&It&&(t|=It);var a={ctx:ve,deps:null,nodes_start:null,nodes_end:null,f:t|bt,first:null,fn:e,last:null,next:null,parent:i,b:i&&i.b,prev:null,teardown:null,transitions:null,wv:0,ac:null};if(r)try{ei(a),a.f|=Os}catch(o){throw We(a),o}else e!==null&&pn(a);if(n){var s=a;if(r&&s.deps===null&&s.teardown===null&&s.nodes_start===null&&s.first===s.last&&!(s.f&_n)&&(s=s.first),s!==null&&(s.parent=i,i!==null&&Ku(s,i),ee!==null&&ee.f&ct&&!(t&Gr))){var l=ee;(l.effects??(l.effects=[])).push(s)}}return a}function Xu(){return ee!==null&&!Rt}function $a(t){const e=zt(ma,null,!1);return Xe(e,Ue),e.teardown=t,e}function fs(t){vl();var e=Q.f,r=!ee&&(e&yr)!==0&&(e&Os)===0;if(r){var n=ve;(n.e??(n.e=[])).push(t)}else return ml(t)}function ml(t){return zt(Ns|qo,t,!1)}function Zu(t){return vl(),zt(ma|qo,t,!0)}function Qu(t){Qt.ensure();const e=zt(Gr|_n,t,!0);return()=>{We(e)}}function ef(t){Qt.ensure();const e=zt(Gr|_n,t,!0);return(r={})=>new Promise(n=>{r.outro?cn(e,()=>{We(e),n(void 0)}):(We(e),n(void 0))})}function wr(t){return zt(Ns,t,!1)}function se(t,e){var r=ve,n={effect:null,ran:!1,deps:t};r.l.$.push(n),n.effect=xn(()=>{t(),!n.ran&&(n.ran=!0,ge(e))})}function tf(){var t=ve;xn(()=>{for(var e of t.l.$){e.deps();var r=e.effect;r.f&Ue&&Xe(r,_r),Oi(r)&&ei(r),e.ran=!1}})}function rf(t){return zt(ga|_n,t,!0)}function xn(t,e=0){return zt(ma|e,t,!0)}function ze(t,e=[],r=[]){il(e,r,n=>{zt(ma,()=>t(...n.map(p)),!0)})}function $n(t,e=0){var r=zt(wn|e,t,!0);return r}function Je(t,e=!0){return zt(yr|_n,t,!0,e)}function gl(t){var e=t.teardown;if(e!==null){const r=Sn,n=ee;po(!0),lt(null);try{e.call(null)}finally{po(r),lt(n)}}}function bl(t,e=!1){var r=t.first;for(t.first=t.last=null;r!==null;){const i=r.ac;i!==null&&xa(()=>{i.abort(xi)});var n=r.next;r.f&Gr?r.parent=null:We(r,e),r=n}}function nf(t){for(var e=t.first;e!==null;){var r=e.next;e.f&yr||We(e),e=r}}function We(t,e=!0){var r=!1;(e||t.f&bu)&&t.nodes_start!==null&&t.nodes_end!==null&&(af(t.nodes_start,t.nodes_end),r=!0),bl(t,e&&!r),ia(t,0),Xe(t,yn);var n=t.transitions;if(n!==null)for(const a of n)a.stop();gl(t);var i=t.parent;i!==null&&i.first!==null&&wl(t),t.next=t.prev=t.teardown=t.ctx=t.deps=t.fn=t.nodes_start=t.nodes_end=t.ac=null}function af(t,e){for(;t!==null;){var r=t===e?null:or(t);t.remove(),t=r}}function wl(t){var e=t.parent,r=t.prev,n=t.next;r!==null&&(r.next=n),n!==null&&(n.prev=r),e!==null&&(e.first===t&&(e.first=n),e.last===t&&(e.last=r))}function cn(t,e){var r=[];Rs(t,r,!0),yl(r,()=>{We(t),e&&e()})}function yl(t,e){var r=t.length;if(r>0){var n=()=>--r||e();for(var i of t)i.out(n)}else e()}function Rs(t,e,r){if(!(t.f&It)){if(t.f^=It,t.transitions!==null)for(const s of t.transitions)(s.is_global||r)&&e.push(s);for(var n=t.first;n!==null;){var i=n.next,a=(n.f&ii)!==0||(n.f&yr)!==0;Rs(n,e,a?r:!1),n=i}}}function Sa(t){_l(t,!0)}function _l(t,e){if(t.f&It){t.f^=It,t.f&Ue||(Xe(t,bt),pn(t));for(var r=t.first;r!==null;){var n=r.next,i=(r.f&ii)!==0||(r.f&yr)!==0;_l(r,i?e:!1),r=n}if(t.transitions!==null)for(const a of t.transitions)(a.is_global||e)&&a.in()}}let Wn=!1;function ho(t){Wn=t}let Sn=!1;function po(t){Sn=t}let ee=null,Rt=!1;function lt(t){ee=t}let Q=null;function ar(t){Q=t}let st=null;function xl(t){ee!==null&&(st===null?st=[t]:st.push(t))}let it=null,vt=0,Ct=null;function sf(t){Ct=t}let $l=1,Ci=0,un=Ci;function vo(t){un=t}let Vr=!1;function Sl(){return++$l}function Oi(t){var h;var e=t.f;if(e&bt)return!0;if(e&_r){var r=t.deps,n=(e&jt)!==0;if(r!==null){var i,a,s=(e&ta)!==0,l=n&&Q!==null&&!Vr,o=r.length;if((s||l)&&(Q===null||!(Q.f&yn))){var c=t,f=c.parent;for(i=0;i<o;i++)a=r[i],(s||!((h=a==null?void 0:a.reactions)!=null&&h.includes(c)))&&(a.reactions??(a.reactions=[])).push(c);s&&(c.f^=ta),l&&f!==null&&!(f.f&jt)&&(c.f^=jt)}for(i=0;i<o;i++)if(a=r[i],Oi(a)&&ol(a),a.wv>t.wv)return!0}(!n||Q!==null&&!Vr)&&Xe(t,Ue)}return!1}function Pl(t,e,r=!0){var n=t.reactions;if(n!==null&&!(st!=null&&st.includes(t)))for(var i=0;i<n.length;i++){var a=n[i];a.f&ct?Pl(a,e,!1):e===a&&(r?Xe(a,bt):a.f&Ue&&Xe(a,_r),pn(a))}}function Cl(t){var g;var e=it,r=vt,n=Ct,i=ee,a=Vr,s=st,l=ve,o=Rt,c=un,f=t.f;it=null,vt=0,Ct=null,Vr=(f&jt)!==0&&(Rt||!Wn||ee===null),ee=f&(yr|Gr)?null:t,st=null,Xn(t.ctx),Rt=!1,un=++Ci,t.ac!==null&&(xa(()=>{t.ac.abort(xi)}),t.ac=null);try{t.f|=is;var h=t.fn,v=h(),m=t.deps;if(it!==null){var u;if(ia(t,vt),m!==null&&vt>0)for(m.length=vt+it.length,u=0;u<it.length;u++)m[vt+u]=it[u];else t.deps=m=it;if(!Vr||f&ct&&t.reactions!==null)for(u=vt;u<m.length;u++)((g=m[u]).reactions??(g.reactions=[])).push(t)}else m!==null&&vt<m.length&&(ia(t,vt),m.length=vt);if(Ni()&&Ct!==null&&!Rt&&m!==null&&!(t.f&(ct|_r|bt)))for(u=0;u<Ct.length;u++)Pl(Ct[u],t);return i!==null&&i!==t&&(Ci++,Ct!==null&&(n===null?n=Ct:n.push(...Ct))),t.f&ln&&(t.f^=ln),v}catch(b){return Zo(b)}finally{t.f^=is,it=e,vt=r,Ct=n,ee=i,Vr=a,st=s,Xn(l),Rt=o,un=c}}function of(t,e){let r=e.reactions;if(r!==null){var n=hu.call(r,t);if(n!==-1){var i=r.length-1;i===0?r=e.reactions=null:(r[n]=r[i],r.pop())}}r===null&&e.f&ct&&(it===null||!it.includes(e))&&(Xe(e,_r),e.f&(jt|ta)||(e.f^=ta),sl(e),ia(e,0))}function ia(t,e){var r=t.deps;if(r!==null)for(var n=e;n<r.length;n++)of(t,r[n])}function ei(t){var e=t.f;if(!(e&yn)){Xe(t,Ue);var r=Q,n=Wn;Q=t,Wn=!0;try{e&wn?nf(t):bl(t),gl(t);var i=Cl(t);t.teardown=typeof i=="function"?i:null,t.wv=$l;var a;zo&&Qc&&t.f&bt&&t.deps}finally{Wn=n,Q=r}}}async function lf(){await Promise.resolve(),O()}function p(t){var e=t.f,r=(e&ct)!==0;if(ee!==null&&!Rt){var n=Q!==null&&(Q.f&yn)!==0;if(!n&&!(st!=null&&st.includes(t))){var i=ee.deps;if(ee.f&is)t.rv<Ci&&(t.rv=Ci,it===null&&i!==null&&i[vt]===t?vt++:it===null?it=[t]:(!Vr||!it.includes(t))&&it.push(t));else{(ee.deps??(ee.deps=[])).push(t);var a=t.reactions;a===null?t.reactions=[ee]:a.includes(ee)||a.push(ee)}}}else if(r&&t.deps===null&&t.effects===null){var s=t,l=s.parent;l!==null&&!(l.f&jt)&&(s.f^=jt)}if(Sn){if(Hr.has(t))return Hr.get(t);if(r){s=t;var o=s.v;return(!(s.f&Ue)&&s.reactions!==null||kl(s))&&(o=Ms(s)),Hr.set(s,o),o}}else r&&(s=t,Oi(s)&&ol(s));if(t.f&ln)throw t.v;return t.v}function kl(t){if(t.v===Be)return!0;if(t.deps===null)return!1;for(const e of t.deps)if(Hr.has(e)||e.f&ct&&kl(e))return!0;return!1}function ge(t){var e=Rt;try{return Rt=!0,t()}finally{Rt=e}}const cf=-7169;function Xe(t,e){t.f=t.f&cf|e}function D(t){if(!(typeof t!="object"||!t||t instanceof EventTarget)){if(tr in t)ds(t);else if(!Array.isArray(t))for(let e in t){const r=t[e];typeof r=="object"&&r&&tr in r&&ds(r)}}}function ds(t,e=new Set){if(typeof t=="object"&&t!==null&&!(t instanceof EventTarget)&&!e.has(t)){e.add(t),t instanceof Date&&t.getTime();for(let n in t)try{ds(t[n],e)}catch{}const r=Ts(t);if(r!==Object.prototype&&r!==Array.prototype&&r!==Map.prototype&&r!==Set.prototype&&r!==Date.prototype){const n=Ho(r);for(let i in n){const a=n[i].get;if(a)try{a.call(t)}catch{}}}}}const Fl=new Set,hs=new Set;function El(t,e,r,n={}){function i(a){if(n.capture||yi.call(e,a),!a.cancelBubble)return xa(()=>r==null?void 0:r.call(this,a))}return t.startsWith("pointer")||t.startsWith("touch")||t==="wheel"?nr(()=>{e.addEventListener(t,i,n)}):e.addEventListener(t,i,n),i}function De(t,e,r,n,i){var a={capture:n,passive:i},s=El(t,e,r,a);(e===document.body||e===window||e===document||e instanceof HTMLMediaElement)&&$a(()=>{e.removeEventListener(t,s,a)})}function Is(t){for(var e=0;e<t.length;e++)Fl.add(t[e]);for(var r of hs)r(t)}let mo=null;function yi(t){var $;var e=this,r=e.ownerDocument,n=t.type,i=(($=t.composedPath)==null?void 0:$.call(t))||[],a=i[0]||t.target;mo=t;var s=0,l=mo===t&&t.__root;if(l){var o=i.indexOf(l);if(o!==-1&&(e===document||e===window)){t.__root=e;return}var c=i.indexOf(e);if(c===-1)return;o<=c&&(s=o)}if(a=i[s]||t.target,a!==e){Kn(t,"currentTarget",{configurable:!0,get(){return a||r}});var f=ee,h=Q;lt(null),ar(null);try{for(var v,m=[];a!==null;){var u=a.assignedSlot||a.parentNode||a.host||null;try{var g=a["__"+n];if(g!=null&&(!a.disabled||t.target===a))if(ni(g)){var[b,..._]=g;b.apply(a,[t,..._])}else g.call(a,t)}catch(P){v?m.push(P):v=P}if(t.cancelBubble||u===e||u===null)break;a=u}if(v){for(let P of m)queueMicrotask(()=>{throw P});throw v}}finally{t.__root=e,delete t.currentTarget,lt(f),ar(h)}}}function jl(t){var e=document.createElement("template");return e.innerHTML=t.replaceAll("<!>","<!---->"),e.content}function Bt(t,e){var r=Q;r.nodes_start===null&&(r.nodes_start=t,r.nodes_end=e)}function fe(t,e){var r=(e&lu)!==0,n=(e&cu)!==0,i,a=!t.startsWith("<!>");return()=>{if(B)return Bt(X,null),X;i===void 0&&(i=jl(a?t:"<!>"+t),r||(i=ir(i)));var s=n||cl?document.importNode(i,!0):i.cloneNode(!0);if(r){var l=ir(s),o=s.lastChild;Bt(l,o)}else Bt(s,s);return s}}function uf(t,e,r="svg"){var n=!t.startsWith("<!>"),i=`<${r}>${n?t:"<!>"+t}</${r}>`,a;return()=>{if(B)return Bt(X,null),X;if(!a){var s=jl(i),l=ir(s);a=ir(l)}var o=a.cloneNode(!0);return Bt(o,o),o}}function Pa(t,e){return uf(t,e,"svg")}function Gt(t=""){if(!B){var e=Tt(t+"");return Bt(e,e),e}var r=X;return r.nodeType!==ba&&(r.before(r=Tt()),Ve(r)),Bt(r,r),r}function Ae(){if(B)return Bt(X,null),X;var t=document.createDocumentFragment(),e=document.createComment(""),r=Tt();return t.append(e,r),Bt(e,r),t}function R(t,e){if(B){Q.nodes_end=X,hn();return}t!==null&&t.before(e)}function ff(t){return t.endsWith("capture")&&t!=="gotpointercapture"&&t!=="lostpointercapture"}const df=["beforeinput","click","change","dblclick","contextmenu","focusin","focusout","input","keydown","keyup","mousedown","mousemove","mouseout","mouseover","mouseup","pointerdown","pointermove","pointerout","pointerover","pointerup","touchend","touchmove","touchstart"];function hf(t){return df.includes(t)}const pf={formnovalidate:"formNoValidate",ismap:"isMap",nomodule:"noModule",playsinline:"playsInline",readonly:"readOnly",defaultvalue:"defaultValue",defaultchecked:"defaultChecked",srcobject:"srcObject",novalidate:"noValidate",allowfullscreen:"allowFullscreen",disablepictureinpicture:"disablePictureInPicture",disableremoteplayback:"disableRemotePlayback"};function vf(t){return t=t.toLowerCase(),pf[t]??t}const mf=["touchstart","touchmove"];function gf(t){return mf.includes(t)}const bf=["textarea","script","style","title"];function wf(t){return bf.includes(t)}function Lr(t,e){var r=e==null?"":typeof e=="object"?e+"":e;r!==(t.__t??(t.__t=t.nodeValue))&&(t.__t=r,t.nodeValue=r+"")}function Bs(t,e){return Al(t,e)}function yf(t,e){us(),e.intro=e.intro??!1;const r=e.target,n=B,i=X;try{for(var a=ir(r);a&&(a.nodeType!==ai||a.data!==Wo);)a=or(a);if(!a)throw Jn;at(!0),Ve(a);const s=Al(t,{...e,anchor:a});return at(!1),s}catch(s){if(s instanceof Error&&s.message.split(`
`).some(l=>l.startsWith("https://svelte.dev/e/")))throw s;return s!==Jn&&console.warn("Failed to hydrate: ",s),e.recover===!1&&Cu(),us(),dl(r),at(!1),Bs(t,e)}finally{at(n),Ve(i)}}const Dn=new Map;function Al(t,{target:e,anchor:r,props:n={},events:i,context:a,intro:s=!0}){us();var l=new Set,o=h=>{for(var v=0;v<h.length;v++){var m=h[v];if(!l.has(m)){l.add(m);var u=gf(m);e.addEventListener(m,yi,{passive:u});var g=Dn.get(m);g===void 0?(document.addEventListener(m,yi,{passive:u}),Dn.set(m,1)):Dn.set(m,g+1)}}};o(As(Fl)),hs.add(o);var c=void 0,f=ef(()=>{var h=r??e.appendChild(Tt());return Bu(h,{pending:()=>{}},v=>{if(a){ut({});var m=ve;m.c=a}if(i&&(n.$$events=i),B&&Bt(v,null),c=t(v,n)||{},B&&(Q.nodes_end=X,X===null||X.nodeType!==ai||X.data!==js))throw ya(),Jn;a&&ft()}),()=>{var u;for(var v of l){e.removeEventListener(v,yi);var m=Dn.get(v);--m===0?(document.removeEventListener(v,yi),Dn.delete(v)):Dn.set(v,m)}hs.delete(o),h!==r&&((u=h.parentNode)==null||u.removeChild(h))}});return ps.set(c,f),c}let ps=new WeakMap;function _f(t,e){const r=ps.get(t);return r?(ps.delete(t),r(e)):Promise.resolve()}function xr(t,e,...r){var n=t,i=Ke,a;$n(()=>{i!==(i=e())&&(a&&(We(a),a=null),a=Je(()=>i(n,...r)))},ii),B&&(n=X)}function Vs(t){ve===null&&wa(),ri&&ve.l!==null?Tl(ve).m.push(t):fs(()=>{const e=ge(t);if(typeof e=="function")return e})}function Ws(t){ve===null&&wa(),Vs(()=>()=>ge(t))}function xf(t,e,{bubbles:r=!1,cancelable:n=!1}={}){return new CustomEvent(t,{detail:e,bubbles:r,cancelable:n})}function $f(){const t=ve;return t===null&&wa(),(e,r,n)=>{var a;const i=(a=t.s.$$events)==null?void 0:a[e];if(i){const s=ni(i)?i.slice():[i],l=xf(e,r,n);for(const o of s)o.call(t.x,l);return!l.defaultPrevented}return!0}}function Sf(t){ve===null&&wa(),ve.l===null&&ku(),Tl(ve).b.push(t)}function Tl(t){var e=t.l;return e.u??(e.u={a:[],b:[],m:[]})}function me(t,e,r=!1){B&&hn();var n=t,i=null,a=null,s=Be,l=r?ii:0,o=!1;const c=(m,u=!0)=>{o=!0,v(u,m)};var f=null;function h(){f!==null&&(f.lastChild.remove(),n.before(f),f=null);var m=s?i:a,u=s?a:i;m&&Sa(m),u&&cn(u,()=>{s?a=null:i=null})}const v=(m,u)=>{if(s===(s=m))return;let g=!1;if(B){const N=Go(n)===va;!!s===N&&(n=ra(),Ve(n),at(!1),g=!0)}var b=hl(),_=n;if(b&&(f=document.createDocumentFragment(),f.append(_=Tt())),s?i??(i=u&&Je(()=>u(_))):a??(a=u&&Je(()=>u(_))),b){var $=we,P=s?i:a,x=s?a:i;P&&$.skipped_effects.delete(P),x&&$.skipped_effects.add(x),$.add_callback(h)}else h();g&&at(!0)};$n(()=>{o=!1,e(c),o||v(null,null)},l),B&&(n=X)}let fn=null;function go(t){fn=t}function aa(t,e){return e}function Pf(t,e,r){for(var n=t.items,i=[],a=e.length,s=0;s<a;s++)Rs(e[s].e,i,!0);var l=a>0&&i.length===0&&r!==null;if(l){var o=r.parentNode;dl(o),o.append(r),n.clear(),qt(t,e[0].prev,e[a-1].next)}yl(i,()=>{for(var c=0;c<a;c++){var f=e[c];l||(n.delete(f.k),qt(t,f.prev,f.next)),We(f.e,!l)}})}function ki(t,e,r,n,i,a=null){var s=t,l={flags:e,items:new Map,first:null},o=(e&Vo)!==0;if(o){var c=t;s=B?Ve(ir(c)):c.appendChild(Tt())}B&&hn();var f=null,h=!1,v=new Map,m=Pi(()=>{var _=r();return ni(_)?_:_==null?[]:As(_)}),u,g;function b(){Cf(g,u,l,v,s,i,e,n,r),a!==null&&(u.length===0?f?Sa(f):f=Je(()=>a(s)):f!==null&&cn(f,()=>{f=null}))}$n(()=>{g??(g=Q),u=p(m);var _=u.length;if(h&&_===0)return;h=_===0;let $=!1;if(B){var P=Go(s)===va;P!==(_===0)&&(s=ra(),Ve(s),at(!1),$=!0)}if(B){for(var x=null,N,C=0;C<_;C++){if(X.nodeType===ai&&X.data===js){s=X,$=!0,at(!1);break}var E=u[C],w=n(E,C);N=vs(X,l,x,null,E,w,C,i,e,r),l.items.set(w,N),x=N}_>0&&Ve(ra())}if(B)_===0&&a&&(f=Je(()=>a(s)));else if(hl()){var q=new Set,J=we;for(C=0;C<_;C+=1){E=u[C],w=n(E,C);var ye=l.items.get(w)??v.get(w);ye?e&(ha|pa)&&Nl(ye,E,C,e):(N=vs(null,l,null,null,E,w,C,i,e,r,!0),v.set(w,N)),q.add(w)}for(const[K,re]of l.items)q.has(K)||J.skipped_effects.add(re.e);J.add_callback(b)}else b();$&&at(!0),p(m)}),B&&(s=X)}function Cf(t,e,r,n,i,a,s,l,o){var Fe,Nt,Pr,cr;var c=(s&tu)!==0,f=(s&(ha|pa))!==0,h=e.length,v=r.items,m=r.first,u=m,g,b=null,_,$=[],P=[],x,N,C,E;if(c)for(E=0;E<h;E+=1)x=e[E],N=l(x,E),C=v.get(N),C!==void 0&&((Fe=C.a)==null||Fe.measure(),(_??(_=new Set)).add(C));for(E=0;E<h;E+=1){if(x=e[E],N=l(x,E),C=v.get(N),C===void 0){var w=n.get(N);if(w!==void 0){n.delete(N),v.set(N,w);var q=b?b.next:u;qt(r,b,w),qt(r,w,q),Ua(w,q,i),b=w}else{var J=u?u.e.nodes_start:i;b=vs(J,r,b,b===null?r.first:b.next,x,N,E,a,s,o)}v.set(N,b),$=[],P=[],u=b.next;continue}if(f&&Nl(C,x,E,s),C.e.f&It&&(Sa(C.e),c&&((Nt=C.a)==null||Nt.unfix(),(_??(_=new Set)).delete(C))),C!==u){if(g!==void 0&&g.has(C)){if($.length<P.length){var ye=P[0],K;b=ye.prev;var re=$[0],Oe=$[$.length-1];for(K=0;K<$.length;K+=1)Ua($[K],ye,i);for(K=0;K<P.length;K+=1)g.delete(P[K]);qt(r,re.prev,Oe.next),qt(r,b,re),qt(r,Oe,ye),u=ye,b=Oe,E-=1,$=[],P=[]}else g.delete(C),Ua(C,u,i),qt(r,C.prev,C.next),qt(r,C,b===null?r.first:b.next),qt(r,b,C),b=C;continue}for($=[],P=[];u!==null&&u.k!==N;)u.e.f&It||(g??(g=new Set)).add(u),P.push(u),u=u.next;if(u===null)continue;C=u}$.push(C),b=C,u=C.next}if(u!==null||g!==void 0){for(var Te=g===void 0?[]:As(g);u!==null;)u.e.f&It||Te.push(u),u=u.next;var Qe=Te.length;if(Qe>0){var et=s&Vo&&h===0?i:null;if(c){for(E=0;E<Qe;E+=1)(Pr=Te[E].a)==null||Pr.measure();for(E=0;E<Qe;E+=1)(cr=Te[E].a)==null||cr.fix()}Pf(r,Te,et)}}c&&nr(()=>{var wt;if(_!==void 0)for(C of _)(wt=C.a)==null||wt.apply()}),t.first=r.first&&r.first.e,t.last=b&&b.e;for(var W of n.values())We(W.e);n.clear()}function Nl(t,e,r,n){n&ha&&Qn(t.v,e),n&pa?Qn(t.i,r):t.i=r}function vs(t,e,r,n,i,a,s,l,o,c,f){var h=fn,v=(o&ha)!==0,m=(o&ru)===0,u=v?m?te(i,!1,!1):vn(i):i,g=o&pa?vn(s):s,b={i:g,v:u,k:a,a:null,e:null,prev:r,next:n};fn=b;try{if(t===null){var _=document.createDocumentFragment();_.append(t=Tt())}return b.e=Je(()=>l(t,u,g,c),B),b.e.prev=r&&r.e,b.e.next=n&&n.e,r===null?f||(e.first=b):(r.next=b,r.e.next=b.e),n!==null&&(n.prev=b,n.e.prev=b.e),b}finally{fn=h}}function Ua(t,e,r){for(var n=t.next?t.next.e.nodes_start:r,i=e?e.e.nodes_start:r,a=t.e.nodes_start;a!==null&&a!==n;){var s=or(a);i.before(a),a=s}}function qt(t,e,r){e===null?t.first=r:(e.next=r,e.e.next=r&&r.e),r!==null&&(r.prev=e,r.e.prev=e&&e.e)}function Ye(t,e,r,n,i){var l;B&&hn();var a=(l=e.$$slots)==null?void 0:l[r],s=!1;a===!0&&(a=e[r==="default"?"children":r],s=!0),a===void 0?i!==null&&i(t):a(t,s?()=>n:n)}function kf(t){const e={};t.children&&(e.default=!0);for(const r in t.$$slots)e[r]=!0;return e}function Ff(t,e,r,n,i,a){let s=B;B&&hn();var l,o,c=null;B&&X.nodeType===yu&&(c=X,hn());var f=B?X:t,h,v=fn;$n(()=>{const m=e()||null;var u=fu;if(m!==l){var g=fn;go(v),h&&(m===null?cn(h,()=>{h=null,o=null}):m===o?Sa(h):We(h)),m&&m!==o&&(h=Je(()=>{if(c=B?c:document.createElementNS(u,m),Bt(c,c),n){B&&wf(m)&&c.append(document.createComment(""));var b=B?ir(c):c.appendChild(Tt());B&&(b===null?at(!1):Ve(b)),n(c,b)}Q.nodes_end=c,f.before(c)})),l=m,l&&(o=l),go(g)}},ii),s&&(at(!0),Ve(f))}function si(t,e){wr(()=>{var r=t.getRootNode(),n=r.host?r:r.head??r.ownerDocument.head;if(!n.querySelector("#"+e.hash)){const i=document.createElement("style");i.id=e.hash,i.textContent=e.code,n.appendChild(i)}})}function Wi(t,e,r){wr(()=>{var n=ge(()=>e(t,r==null?void 0:r())||{});if(r&&(n!=null&&n.update)){var i=!1,a={};xn(()=>{var s=r();D(s),i&&Jo(a,s)&&(a=s,n.update(s))}),i=!0}if(n!=null&&n.destroy)return()=>n.destroy()})}function Ef(t,e){var r=void 0,n;$n(()=>{r!==(r=e())&&(n&&(We(n),n=null),r&&(n=Je(()=>{wr(()=>r(t))})))})}function Dl(t){var e,r,n="";if(typeof t=="string"||typeof t=="number")n+=t;else if(typeof t=="object")if(Array.isArray(t)){var i=t.length;for(e=0;e<i;e++)t[e]&&(r=Dl(t[e]))&&(n&&(n+=" "),n+=r)}else for(r in t)t[r]&&(n&&(n+=" "),n+=r);return n}function jf(){for(var t,e,r=0,n="",i=arguments.length;r<i;r++)(t=arguments[r])&&(e=Dl(t))&&(n&&(n+=" "),n+=e);return n}function Ol(t){return typeof t=="object"?jf(t):t??""}const bo=[...` 	
\r\f \v\uFEFF`];function Af(t,e,r){var n=t==null?"":""+t;if(e&&(n=n?n+" "+e:e),r){for(var i in r)if(r[i])n=n?n+" "+i:i;else if(n.length)for(var a=i.length,s=0;(s=n.indexOf(i,s))>=0;){var l=s+a;(s===0||bo.includes(n[s-1]))&&(l===n.length||bo.includes(n[l]))?n=(s===0?"":n.substring(0,s))+n.substring(l+1):s=l}}return n===""?null:n}function wo(t,e=!1){var r=e?" !important;":";",n="";for(var i in t){var a=t[i];a!=null&&a!==""&&(n+=" "+i+": "+a+r)}return n}function qa(t){return t[0]!=="-"||t[1]!=="-"?t.toLowerCase():t}function Tf(t,e){if(e){var r="",n,i;if(Array.isArray(e)?(n=e[0],i=e[1]):n=e,t){t=String(t).replaceAll(/\s*\/\*.*?\*\/\s*/g,"").trim();var a=!1,s=0,l=!1,o=[];n&&o.push(...Object.keys(n).map(qa)),i&&o.push(...Object.keys(i).map(qa));var c=0,f=-1;const g=t.length;for(var h=0;h<g;h++){var v=t[h];if(l?v==="/"&&t[h-1]==="*"&&(l=!1):a?a===v&&(a=!1):v==="/"&&t[h+1]==="*"?l=!0:v==='"'||v==="'"?a=v:v==="("?s++:v===")"&&s--,!l&&a===!1&&s===0){if(v===":"&&f===-1)f=h;else if(v===";"||h===g-1){if(f!==-1){var m=qa(t.substring(c,f).trim());if(!o.includes(m)){v!==";"&&h++;var u=t.substring(c,h).trim();r+=" "+u+";"}}c=h+1,f=-1}}}}return n&&(r+=wo(n)),i&&(r+=wo(i,!0)),r=r.trim(),r===""?null:r}return t==null?null:String(t)}function Zt(t,e,r,n,i,a){var s=t.__className;if(B||s!==r||s===void 0){var l=Af(r,n,a);(!B||l!==t.getAttribute("class"))&&(l==null?t.removeAttribute("class"):e?t.className=l:t.setAttribute("class",l)),t.__className=r}else if(a&&i!==a)for(var o in a){var c=!!a[o];(i==null||c!==!!i[o])&&t.classList.toggle(o,c)}return a}function Ga(t,e={},r,n){for(var i in r){var a=r[i];e[i]!==a&&(r[i]==null?t.style.removeProperty(i):t.style.setProperty(i,a,n))}}function zs(t,e,r,n){var i=t.__style;if(B||i!==e){var a=Tf(e,n);(!B||a!==t.getAttribute("style"))&&(a==null?t.removeAttribute("style"):t.style.cssText=a),t.__style=e}else n&&(Array.isArray(n)?(Ga(t,r==null?void 0:r[0],n[0]),Ga(t,r==null?void 0:r[1],n[1],"important")):Ga(t,r,n));return n}function ms(t,e,r=!1){if(t.multiple){if(e==null)return;if(!ni(e))return Nu();for(var n of t.options)n.selected=e.includes(yo(n));return}for(n of t.options){var i=yo(n);if(Gu(i,e)){n.selected=!0;return}}(!r||e!==void 0)&&(t.selectedIndex=-1)}function Nf(t){var e=new MutationObserver(()=>{ms(t,t.__value)});e.observe(t,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),$a(()=>{e.disconnect()})}function yo(t){return"__value"in t?t.__value:t.value}const bi=Symbol("class"),wi=Symbol("style"),Ll=Symbol("is custom element"),Ml=Symbol("is html");function sa(t){if(B){var e=!1,r=()=>{if(!e){if(e=!0,t.hasAttribute("value")){var n=t.value;Ur(t,"value",null),t.value=n}if(t.hasAttribute("checked")){var i=t.checked;Ur(t,"checked",null),t.checked=i}}};t.__on_r=r,nr(r),pl()}}function gs(t,e){var r=Hs(t);r.value===(r.value=e??void 0)||t.value===e&&(e!==0||t.nodeName!=="PROGRESS")||(t.value=e??"")}function Df(t,e){e?t.hasAttribute("selected")||t.setAttribute("selected",""):t.removeAttribute("selected")}function Ur(t,e,r,n){var i=Hs(t);B&&(i[e]=t.getAttribute(e),e==="src"||e==="srcset"||e==="href"&&t.nodeName==="LINK")||i[e]!==(i[e]=r)&&(e==="loading"&&(t[wu]=r),r==null?t.removeAttribute(e):typeof r!="string"&&Rl(t).includes(e)?t[e]=r:t.setAttribute(e,r))}function Of(t,e,r,n,i=!1,a=!1){if(B&&i&&t.tagName==="INPUT"){var s=t,l=s.type==="checkbox"?"defaultChecked":"defaultValue";l in r||sa(s)}var o=Hs(t),c=o[Ll],f=!o[Ml];let h=B&&c;h&&at(!1);var v=e||{},m=t.tagName==="OPTION";for(var u in e)u in r||(r[u]=null);r.class?r.class=Ol(r.class):(n||r[bi])&&(r.class=null),r[wi]&&(r.style??(r.style=null));var g=Rl(t);for(const C in r){let E=r[C];if(m&&C==="value"&&E==null){t.value=t.__value="",v[C]=E;continue}if(C==="class"){var b=t.namespaceURI==="http://www.w3.org/1999/xhtml";Zt(t,b,E,n,e==null?void 0:e[bi],r[bi]),v[C]=E,v[bi]=r[bi];continue}if(C==="style"){zs(t,E,e==null?void 0:e[wi],r[wi]),v[C]=E,v[wi]=r[wi];continue}var _=v[C];if(!(E===_&&!(E===void 0&&t.hasAttribute(C)))){v[C]=E;var $=C[0]+C[1];if($!=="$$")if($==="on"){const w={},q="$$"+C;let J=C.slice(2);var P=hf(J);if(ff(J)&&(J=J.slice(0,-7),w.capture=!0),!P&&_){if(E!=null)continue;t.removeEventListener(J,v[q],w),v[q]=null}if(E!=null)if(P)t[`__${J}`]=E,Is([J]);else{let ye=function(K){v[C].call(this,K)};v[q]=El(J,t,ye,w)}else P&&(t[`__${J}`]=void 0)}else if(C==="style")Ur(t,C,E);else if(C==="autofocus")Yu(t,!!E);else if(!c&&(C==="__value"||C==="value"&&E!=null))t.value=t.__value=E;else if(C==="selected"&&m)Df(t,E);else{var x=C;f||(x=vf(x));var N=x==="defaultValue"||x==="defaultChecked";if(E==null&&!c&&!N)if(o[C]=null,x==="value"||x==="checked"){let w=t;const q=e===void 0;if(x==="value"){let J=w.defaultValue;w.removeAttribute(x),w.defaultValue=J,w.value=w.__value=q?J:null}else{let J=w.defaultChecked;w.removeAttribute(x),w.defaultChecked=J,w.checked=q?J:!1}}else t.removeAttribute(C);else N||g.includes(x)&&(c||typeof E!="string")?(t[x]=E,x in o&&(o[x]=Be)):typeof E!="function"&&Ur(t,x,E)}}}return h&&at(!0),v}function bs(t,e,r=[],n=[],i,a=!1,s=!1){il(r,n,l=>{var o=void 0,c={},f=t.nodeName==="SELECT",h=!1;if($n(()=>{var m=e(...l.map(p)),u=Of(t,o,m,i,a,s);h&&f&&"value"in m&&ms(t,m.value);for(let b of Object.getOwnPropertySymbols(c))m[b]||We(c[b]);for(let b of Object.getOwnPropertySymbols(m)){var g=m[b];b.description===du&&(!o||g!==o[b])&&(c[b]&&We(c[b]),c[b]=Je(()=>Ef(t,()=>g))),u[b]=g}o=u}),f){var v=t;wr(()=>{ms(v,o.value,!0),Nf(v)})}h=!0})}function Hs(t){return t.__attributes??(t.__attributes={[Ll]:t.nodeName.includes("-"),[Ml]:t.namespaceURI===uu})}var _o=new Map;function Rl(t){var e=t.getAttribute("is")||t.nodeName,r=_o.get(e);if(r)return r;_o.set(e,r=[]);for(var n,i=t,a=Element.prototype;a!==i;){n=Ho(i);for(var s in n)n[s].set&&r.push(s);i=Ts(i)}return r}const Lf=()=>performance.now(),br={tick:t=>requestAnimationFrame(t),now:()=>Lf(),tasks:new Set};function Il(){const t=br.now();br.tasks.forEach(e=>{e.c(t)||(br.tasks.delete(e),e.f())}),br.tasks.size!==0&&br.tick(Il)}function Mf(t){let e;return br.tasks.size===0&&br.tick(Il),{promise:new Promise(r=>{br.tasks.add(e={c:t,f:r})}),abort(){br.tasks.delete(e)}}}function Rf(t){if(t==="float")return"cssFloat";if(t==="offset")return"cssOffset";if(t.startsWith("--"))return t;const e=t.split("-");return e.length===1?e[0]:e[0]+e.slice(1).map(r=>r[0].toUpperCase()+r.slice(1)).join("")}function xo(t){const e={},r=t.split(";");for(const n of r){const[i,a]=n.split(":");if(!i||a===void 0)break;const s=Rf(i.trim());e[s]=a.trim()}return e}const If=t=>t;function Bf(t,e,r){var n=fn,i,a,s,l=null;n.a??(n.a={element:t,measure(){i=this.element.getBoundingClientRect()},apply(){if(s==null||s.abort(),a=this.element.getBoundingClientRect(),i.left!==a.left||i.right!==a.right||i.top!==a.top||i.bottom!==a.bottom){const o=e()(this.element,{from:i,to:a},r==null?void 0:r());s=Bl(this.element,o,void 0,1,()=>{s==null||s.abort(),s=void 0})}},fix(){if(!t.getAnimations().length){var{position:o,width:c,height:f}=getComputedStyle(t);if(o!=="absolute"&&o!=="fixed"){var h=t.style;l={position:h.position,width:h.width,height:h.height,transform:h.transform},h.position="absolute",h.width=c,h.height=f;var v=t.getBoundingClientRect();if(i.left!==v.left||i.top!==v.top){var m=`translate(${i.left-v.left}px, ${i.top-v.top}px)`;h.transform=h.transform?`${h.transform} ${m}`:m}}}},unfix(){if(l){var o=t.style;o.position=l.position,o.width=l.width,o.height=l.height,o.transform=l.transform}}}),n.a.element=t}function Bl(t,e,r,n,i){if(Mn(e)){var a,s=!1;return nr(()=>{if(!s){var g=e({direction:"in"});a=Bl(t,g,r,n,i)}}),{abort:()=>{s=!0,a==null||a.abort()},deactivate:()=>a.deactivate(),reset:()=>a.reset(),t:()=>a.t()}}if(!(e!=null&&e.duration))return i(),{abort:Ke,deactivate:Ke,reset:Ke,t:()=>n};const{delay:l=0,css:o,tick:c,easing:f=If}=e;var h=[];if(c&&c(0,1),o){var v=xo(o(0,1));h.push(v,v)}var m=()=>1-n,u=t.animate(h,{duration:l,fill:"forwards"});return u.onfinish=()=>{u.cancel();var g=1-n,b=n-g,_=e.duration*Math.abs(b),$=[];if(_>0){var P=!1;if(o)for(var x=Math.ceil(_/16.666666666666668),N=0;N<=x;N+=1){var C=g+b*f(N/x),E=xo(o(C,1-C));$.push(E),P||(P=E.overflow==="hidden")}P&&(t.style.overflow="hidden"),m=()=>{var w=u.currentTime;return g+b*f(w/_)},c&&Mf(()=>{if(u.playState!=="running")return!1;var w=m();return c(w,1-w),!0})}u=t.animate($,{duration:_,fill:"forwards"}),u.onfinish=()=>{m=()=>n,c==null||c(n,1-n),i()}},{abort:()=>{u&&(u.cancel(),u.effect=null,u.onfinish=Ke)},deactivate:()=>{i=Ke},reset:()=>{},t:()=>m()}}function Vf(t,e,r=e){var n=new WeakSet;Ju(t,"input",async i=>{var a=i?t.defaultValue:t.value;if(a=Ya(t)?Ja(a):a,r(a),we!==null&&n.add(we),await lf(),a!==(a=e())){var s=t.selectionStart,l=t.selectionEnd,o=t.value.length;if(t.value=a??"",l!==null){var c=t.value.length;s===l&&l===o&&c>o?(t.selectionStart=c,t.selectionEnd=c):(t.selectionStart=s,t.selectionEnd=Math.min(l,c))}}}),(B&&t.defaultValue!==t.value||ge(e)==null&&t.value)&&(r(Ya(t)?Ja(t.value):t.value),we!==null&&n.add(we)),xn(()=>{var i=e();if(t===document.activeElement){var a=Yi??we;if(n.has(a))return}Ya(t)&&i===Ja(t.value)||t.type==="date"&&!i&&!t.value||i!==t.value&&(t.value=i??"")})}function Ya(t){var e=t.type;return e==="number"||e==="range"}function Ja(t){return t===""?null:+t}function $o(t,e,r){var n=er(t,e);n&&n.set&&(t[e]=r,$a(()=>{t[e]=null}))}function So(t,e){return t===e||(t==null?void 0:t[tr])===e}function Ka(t={},e,r,n){return wr(()=>{var i,a;return xn(()=>{i=a,a=[],ge(()=>{t!==r(...a)&&(e(t,...a),i&&So(r(...i),t)&&e(null,...i))})}),()=>{nr(()=>{a&&So(r(...a),t)&&e(null,...a)})}}),t}function On(t){return function(...e){var r=e[0];return r.stopPropagation(),t==null?void 0:t.apply(this,e)}}function en(t){return function(...e){var r=e[0];return r.preventDefault(),t==null?void 0:t.apply(this,e)}}function Vl(t=!1){const e=ve,r=e.l.u;if(!r)return;let n=()=>D(e.s);if(t){let i=0,a={};const s=Di(()=>{let l=!1;const o=e.s;for(const c in o)o[c]!==a[c]&&(a[c]=o[c],l=!0);return l&&i++,i});n=()=>p(s)}r.b.length&&Zu(()=>{Po(e,n),ns(r.b)}),fs(()=>{const i=ge(()=>r.m.map(mu));return()=>{for(const a of i)typeof a=="function"&&a()}}),r.a.length&&fs(()=>{Po(e,n),ns(r.a)})}function Po(t,e){if(t.l.s)for(const r of t.l.s)p(r);e()}function zi(t,e){var a;var r=(a=t.$$events)==null?void 0:a[e.type],n=ni(r)?r.slice():r==null?[]:[r];for(var i of n)i.call(this,e)}let Hi=!1;function Wf(t){var e=Hi;try{return Hi=!1,[t(),Hi]}finally{Hi=e}}const zf={get(t,e){if(!t.exclude.includes(e))return t.props[e]},set(t,e){return!1},getOwnPropertyDescriptor(t,e){if(!t.exclude.includes(e)&&e in t.props)return{enumerable:!0,configurable:!0,value:t.props[e]}},has(t,e){return t.exclude.includes(e)?!1:e in t.props},ownKeys(t){return Reflect.ownKeys(t.props).filter(e=>!t.exclude.includes(e))}};function $r(t,e,r){return new Proxy({props:t,exclude:e},zf)}const Hf={get(t,e){let r=t.props.length;for(;r--;){let n=t.props[r];if(Mn(n)&&(n=n()),typeof n=="object"&&n!==null&&e in n)return n[e]}},set(t,e,r){let n=t.props.length;for(;n--;){let i=t.props[n];Mn(i)&&(i=i());const a=er(i,e);if(a&&a.set)return a.set(r),!0}return!1},getOwnPropertyDescriptor(t,e){let r=t.props.length;for(;r--;){let n=t.props[r];if(Mn(n)&&(n=n()),typeof n=="object"&&n!==null&&e in n){const i=er(n,e);return i&&!i.configurable&&(i.configurable=!0),i}}},has(t,e){if(e===tr||e===Ls)return!1;for(let r of t.props)if(Mn(r)&&(r=r()),r!=null&&e in r)return!0;return!1},ownKeys(t){const e=[];for(let r of t.props)if(Mn(r)&&(r=r()),!!r){for(const n in r)e.includes(n)||e.push(n);for(const n of Object.getOwnPropertySymbols(r))e.includes(n)||e.push(n)}return e}};function Yr(...t){return new Proxy({props:t},Hf)}function L(t,e,r,n){var P;var i=!ri||(r&iu)!==0,a=(r&su)!==0,s=(r&ou)!==0,l=n,o=!0,c=()=>(o&&(o=!1,l=s?ge(n):n),l),f;if(a){var h=tr in t||Ls in t;f=((P=er(t,e))==null?void 0:P.set)??(h&&e in t?x=>t[e]=x:void 0)}var v,m=!1;a?[v,m]=Wf(()=>t[e]):v=t[e],v===void 0&&n!==void 0&&(v=c(),f&&(i&&Fu(),f(v)));var u;if(i?u=()=>{var x=t[e];return x===void 0?c():(o=!0,x)}:u=()=>{var x=t[e];return x!==void 0&&(l=void 0),x===void 0?l:x},i&&!(r&au))return u;if(f){var g=t.$$legacy;return function(x,N){return arguments.length>0?((!i||!N||g||m)&&f(N?u():x),x):u()}}var b=!1,_=(r&nu?Di:Pi)(()=>(b=!1,u()));a&&p(_);var $=Q;return function(x,N){if(arguments.length>0){const C=N?p(_):i&&a?In(x):x;return k(_,C),b=!0,l!==void 0&&(l=C),x}return Sn&&b||$.f&yn?_.v:p(_)}}function Uf(t){return new qf(t)}var gr,Ft;class qf{constructor(e){ce(this,gr);ce(this,Ft);var a;var r=new Map,n=(s,l)=>{var o=te(l,!1,!1);return r.set(s,o),o};const i=new Proxy({...e.props||{},$$events:{}},{get(s,l){return p(r.get(l)??n(l,Reflect.get(s,l)))},has(s,l){return l===Ls?!0:(p(r.get(l)??n(l,Reflect.get(s,l))),Reflect.has(s,l))},set(s,l,o){return k(r.get(l)??n(l,o),o),Reflect.set(s,l,o)}});z(this,Ft,(e.hydrate?yf:Bs)(e.component,{target:e.target,anchor:e.anchor,props:i,context:e.context,intro:e.intro??!1,recover:e.recover})),(!((a=e==null?void 0:e.props)!=null&&a.$$host)||e.sync===!1)&&O(),z(this,gr,i.$$events);for(const s of Object.keys(F(this,Ft)))s==="$set"||s==="$destroy"||s==="$on"||Kn(this,s,{get(){return F(this,Ft)[s]},set(l){F(this,Ft)[s]=l},enumerable:!0});F(this,Ft).$set=s=>{Object.assign(i,s)},F(this,Ft).$destroy=()=>{_f(F(this,Ft))}}$set(e){F(this,Ft).$set(e)}$on(e,r){F(this,gr)[e]=F(this,gr)[e]||[];const n=(...i)=>r.call(this,...i);return F(this,gr)[e].push(n),()=>{F(this,gr)[e]=F(this,gr)[e].filter(i=>i!==n)}}$destroy(){F(this,Ft).$destroy()}}gr=new WeakMap,Ft=new WeakMap;let Wl;typeof HTMLElement=="function"&&(Wl=class extends HTMLElement{constructor(e,r,n){super();Ge(this,"$$ctor");Ge(this,"$$s");Ge(this,"$$c");Ge(this,"$$cn",!1);Ge(this,"$$d",{});Ge(this,"$$r",!1);Ge(this,"$$p_d",{});Ge(this,"$$l",{});Ge(this,"$$l_u",new Map);Ge(this,"$$me");this.$$ctor=e,this.$$s=r,n&&this.attachShadow({mode:"open"})}addEventListener(e,r,n){if(this.$$l[e]=this.$$l[e]||[],this.$$l[e].push(r),this.$$c){const i=this.$$c.$on(e,r);this.$$l_u.set(r,i)}super.addEventListener(e,r,n)}removeEventListener(e,r,n){if(super.removeEventListener(e,r,n),this.$$c){const i=this.$$l_u.get(r);i&&(i(),this.$$l_u.delete(r))}}async connectedCallback(){if(this.$$cn=!0,!this.$$c){let e=function(i){return a=>{const s=document.createElement("slot");i!=="default"&&(s.name=i),R(a,s)}};if(await Promise.resolve(),!this.$$cn||this.$$c)return;const r={},n=Gf(this);for(const i of this.$$s)i in n&&(i==="default"&&!this.$$d.children?(this.$$d.children=e(i),r.default=!0):r[i]=e(i));for(const i of this.attributes){const a=this.$$g_p(i.name);a in this.$$d||(this.$$d[a]=Zi(a,i.value,this.$$p_d,"toProp"))}for(const i in this.$$p_d)!(i in this.$$d)&&this[i]!==void 0&&(this.$$d[i]=this[i],delete this[i]);this.$$c=Uf({component:this.$$ctor,target:this.shadowRoot||this,props:{...this.$$d,$$slots:r,$$host:this}}),this.$$me=Qu(()=>{xn(()=>{var i;this.$$r=!0;for(const a of ea(this.$$c)){if(!((i=this.$$p_d[a])!=null&&i.reflect))continue;this.$$d[a]=this.$$c[a];const s=Zi(a,this.$$d[a],this.$$p_d,"toAttribute");s==null?this.removeAttribute(this.$$p_d[a].attribute||a):this.setAttribute(this.$$p_d[a].attribute||a,s)}this.$$r=!1})});for(const i in this.$$l)for(const a of this.$$l[i]){const s=this.$$c.$on(i,a);this.$$l_u.set(a,s)}this.$$l={}}}attributeChangedCallback(e,r,n){var i;this.$$r||(e=this.$$g_p(e),this.$$d[e]=Zi(e,n,this.$$p_d,"toProp"),(i=this.$$c)==null||i.$set({[e]:this.$$d[e]}))}disconnectedCallback(){this.$$cn=!1,Promise.resolve().then(()=>{!this.$$cn&&this.$$c&&(this.$$c.$destroy(),this.$$me(),this.$$c=void 0)})}$$g_p(e){return ea(this.$$p_d).find(r=>this.$$p_d[r].attribute===e||!this.$$p_d[r].attribute&&r.toLowerCase()===e)||e}});function Zi(t,e,r,n){var a;const i=(a=r[t])==null?void 0:a.type;if(e=i==="Boolean"&&typeof e!="boolean"?e!=null:e,!n||!r[t])return e;if(n==="toAttribute")switch(i){case"Object":case"Array":return e==null?null:JSON.stringify(e);case"Boolean":return e?"":null;case"Number":return e??null;default:return e}else switch(i){case"Object":case"Array":return e&&JSON.parse(e);case"Boolean":return e;case"Number":return e!=null?+e:e;default:return e}}function Gf(t){const e={};return t.childNodes.forEach(r=>{e[r.slot||"default"]=!0}),e}function Ze(t,e,r,n,i,a){let s=class extends Wl{constructor(){super(t,r,i),this.$$p_d=e}static get observedAttributes(){return ea(e).map(l=>(e[l].attribute||l).toLowerCase())}};return ea(e).forEach(l=>{Kn(s.prototype,l,{get(){return this.$$c&&l in this.$$c?this.$$c[l]:this.$$d[l]},set(o){var h;o=Zi(l,o,e),this.$$d[l]=o;var c=this.$$c;if(c){var f=(h=er(c,l))==null?void 0:h.get;f?c[l]=o:c.$set({[l]:o})}}})}),n.forEach(l=>{Kn(s.prototype,l,{get(){var o;return(o=this.$$c)==null?void 0:o[l]}})}),t.element=s,s}var Yf=fe("<button><!></button>");function Ut(t,e){ut(e,!1);let r=L(e,"variant",12,"default"),n=L(e,"disabled",12,!1),i=L(e,"style",12,""),a=L(e,"title",12,""),s=L(e,"onclick",12,void 0);var l={get variant(){return r()},set variant(f){r(f),O()},get disabled(){return n()},set disabled(f){n(f),O()},get style(){return i()},set style(f){i(f),O()},get title(){return a()},set title(f){a(f),O()},get onclick(){return s()},set onclick(f){s(f),O()}},o=Yf();o.__click=function(...f){var h;(h=s())==null||h.apply(this,f)};var c=U(o);return Ye(c,e,"default",{},null),V(o),ze(()=>{Zt(o,1,`wa-button ${r()==="primary"?"primary":r()==="ghost"?"ghost":""}`),Ur(o,"aria-label",a()),o.disabled=n(),zs(o,i())}),R(t,o),ft(l)}Is(["click"]);Ze(Ut,{variant:{},disabled:{},style:{},title:{},onclick:{}},["default"],[],!0);var Jf=fe("<button><span><!></span></button>");const Kf={hash:"svelte-f3n0ii",code:`.spinning.svelte-f3n0ii {
    animation: svelte-f3n0ii-spin 1s linear infinite;}
  @keyframes svelte-f3n0ii-spin {
    100% {
      transform: rotate(360deg);
    }
  }`};function Pt(t,e){ut(e,!1),si(t,Kf);let r=L(e,"ariaLabel",12,""),n=L(e,"variant",12,"default"),i=L(e,"disabled",12,!1),a=L(e,"title",12),s=L(e,"onclick",12,void 0),l=L(e,"spinning",12,!1);var o={get ariaLabel(){return r()},set ariaLabel(v){r(v),O()},get variant(){return n()},set variant(v){n(v),O()},get disabled(){return i()},set disabled(v){i(v),O()},get title(){return a()},set title(v){a(v),O()},get onclick(){return s()},set onclick(v){s(v),O()},get spinning(){return l()},set spinning(v){l(v),O()}},c=Jf();c.__click=function(...v){var m;(m=s())==null||m.apply(this,v)};var f=U(c),h=U(f);return Ye(h,e,"default",{},null),V(f),V(c),ze(()=>{Zt(c,1,`wa-icon-btn clickable-icon ${n()==="ghost"?"ghost":""}`,"svelte-f3n0ii"),Ur(c,"aria-label",r()),c.disabled=i(),Ur(c,"title",a()),Zt(f,1,Ol(l()?"spinning":""),"svelte-f3n0ii")}),R(t,c),ft(o)}Is(["click"]);Ze(Pt,{ariaLabel:{},variant:{},disabled:{},title:{},onclick:{},spinning:{}},["default"],[],!0);class Co extends y.Modal{constructor(e,r,n,i="draft"){super(e),this.name=r,this.onConfirm=n,this.type=i}onOpen(){const{contentEl:e}=this;e.addClass("wa-centered-modal");const r=this.type==="chapter"?"chapter":"draft";e.createEl("h3",{text:`Delete ${r} '${this.name}'?`}),this.type==="draft"&&e.createEl("p",{text:"This will create a backup copy before deleting."});const n=e.createDiv({cls:"modal-button-row wa-button-group"}),i=n.createEl("button",{text:"Delete",cls:"mod-cta wa-button"}),a=n.createEl("button",{text:"Cancel",cls:"wa-button"});i.onclick=async()=>{this.close(),await this.onConfirm()},a.onclick=()=>{this.close()}}}class Xf extends y.Modal{constructor(e,r){super(e),this.props=r}onOpen(){const{contentEl:e}=this;e.createEl("h2",{text:`Duplicate Draft: ${this.props.sourceDraftName}`});let r="";new y.Setting(e).setName("New draft name").addText(n=>n.setPlaceholder(this.props.suggestedName).setValue(this.props.suggestedName).onChange(i=>r=i)),new y.Setting(e).addButton(n=>n.setButtonText("Duplicate").setCta().onClick(()=>{this.close();const i=r&&r.trim()?r.trim():this.props.suggestedName;this.props.onSubmit(i)}))}onClose(){this.contentEl.empty()}}class Zf extends y.Modal{constructor(e,r,n){super(e),this.oldName=r,this.onSubmit=n}onOpen(){var a;const{contentEl:e}=this;e.empty(),e.createEl("h3",{text:"Rename Chapter"}),e.createEl("div",{text:`Current name: '${this.oldName}'`,cls:"wa-rename-info"});const r=e.createEl("label",{text:"New chapter name",cls:"wa-rename-label"});this.inputEl=e.createEl("input",{type:"text",value:this.oldName,placeholder:"Enter new chapter name",cls:"wa-rename-input",attr:{"aria-label":"New chapter name"}}),r.appendChild(this.inputEl),this.errorEl=e.createEl("div",{cls:"wa-rename-error"}),this.errorEl.style.color="var(--color-red, #d43c3c)",this.errorEl.style.display="none";const n=e.createEl("div",{cls:"wa-rename-btn-row"}),i=n.createEl("button",{text:"Rename",cls:"mod-cta"});this.cancelBtn=n.createEl("button",{text:"Cancel",cls:"mod-cancel"}),setTimeout(()=>{var s,l;(s=this.inputEl)==null||s.focus(),(l=this.inputEl)==null||l.select()},0),(a=this.inputEl)==null||a.addEventListener("keydown",s=>{s.key==="Enter"?this.submit():s.key==="Escape"&&this.close()}),i.addEventListener("click",()=>this.submit()),this.cancelBtn.addEventListener("click",()=>this.close())}submit(){var r,n,i;const e=(r=this.inputEl)==null?void 0:r.value.trim();if(!e){this.errorEl&&(this.errorEl.textContent="Chapter name cannot be empty.",this.errorEl.style.display=""),(n=this.inputEl)==null||n.focus();return}if(e===this.oldName){this.errorEl&&(this.errorEl.textContent="Please enter a different name.",this.errorEl.style.display=""),(i=this.inputEl)==null||i.focus();return}this.errorEl&&(this.errorEl.style.display="none"),this.onSubmit(e),this.close()}}/**
 * @license @lucide/svelte v0.545.0 - ISC
 *
 * ISC License
 * 
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2023 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2025.
 * 
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 * 
 * ---
 * 
 * The MIT License (MIT) (for portions derived from Feather)
 * 
 * Copyright (c) 2013-2023 Cole Bemis
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 * 
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 * 
 */const Qf={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":2,"stroke-linecap":"round","stroke-linejoin":"round"};var ed=Pa("<svg><!><!></svg>");function Sr(t,e){ut(e,!0);const r=L(e,"name",7),n=L(e,"color",7,"currentColor"),i=L(e,"size",7,24),a=L(e,"strokeWidth",7,2),s=L(e,"absoluteStrokeWidth",7,!1),l=L(e,"iconNode",23,()=>[]),o=L(e,"children",7),c=$r(e,["$$slots","$$events","$$legacy","$$host","name","color","size","strokeWidth","absoluteStrokeWidth","iconNode","children"]);var f={get name(){return r()},set name(u){r(u),O()},get color(){return n()},set color(u="currentColor"){n(u),O()},get size(){return i()},set size(u=24){i(u),O()},get strokeWidth(){return a()},set strokeWidth(u=2){a(u),O()},get absoluteStrokeWidth(){return s()},set absoluteStrokeWidth(u=!1){s(u),O()},get iconNode(){return l()},set iconNode(u=[]){l(u),O()},get children(){return o()},set children(u){o(u),O()}},h=ed();bs(h,u=>({...Qf,...c,width:i(),height:i(),stroke:n(),"stroke-width":u,class:["lucide-icon lucide",r()&&`lucide-${r()}`,e.class]}),[()=>s()?Number(a())*24/Number(i()):a()]);var v=U(h);ki(v,17,l,aa,(u,g)=>{var b=Uu(()=>gu(p(g),2));let _=()=>p(b)[0],$=()=>p(b)[1];var P=Ae(),x=ke(P);Ff(x,_,!0,(N,C)=>{bs(N,()=>({...$()}))}),R(u,P)});var m=H(v);return xr(m,()=>o()??Ke),V(h),R(t,h),ft(f)}Ze(Sr,{name:{},color:{},size:{},strokeWidth:{},absoluteStrokeWidth:{},iconNode:{},children:{}},[],[],!0);function ws(t,e){ut(e,!0);/**
 * @license @lucide/svelte v0.545.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2023 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2025.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 * ---
 *
 * The MIT License (MIT) (for portions derived from Feather)
 *
 * Copyright (c) 2013-2023 Cole Bemis
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */let r=$r(e,["$$slots","$$events","$$legacy","$$host"]);const n=[["path",{d:"M12 5v14"}],["path",{d:"m19 12-7 7-7-7"}]];Sr(t,Yr({name:"arrow-down"},()=>r,{get iconNode(){return n},children:(i,a)=>{var s=Ae(),l=ke(s);xr(l,()=>e.children??Ke),R(i,s)},$$slots:{default:!0}})),ft()}Ze(ws,{},[],[],!0);function ys(t,e){ut(e,!0);/**
 * @license @lucide/svelte v0.545.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2023 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2025.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 * ---
 *
 * The MIT License (MIT) (for portions derived from Feather)
 *
 * Copyright (c) 2013-2023 Cole Bemis
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */let r=$r(e,["$$slots","$$events","$$legacy","$$host"]);const n=[["path",{d:"m5 12 7-7 7 7"}],["path",{d:"M12 19V5"}]];Sr(t,Yr({name:"arrow-up"},()=>r,{get iconNode(){return n},children:(i,a)=>{var s=Ae(),l=ke(s);xr(l,()=>e.children??Ke),R(i,s)},$$slots:{default:!0}})),ft()}Ze(ys,{},[],[],!0);function zl(t,e){ut(e,!0);/**
 * @license @lucide/svelte v0.545.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2023 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2025.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 * ---
 *
 * The MIT License (MIT) (for portions derived from Feather)
 *
 * Copyright (c) 2013-2023 Cole Bemis
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */let r=$r(e,["$$slots","$$events","$$legacy","$$host"]);const n=[["path",{d:"M12 21V7"}],["path",{d:"m16 12 2 2 4-4"}],["path",{d:"M22 6V4a1 1 0 0 0-1-1h-5a4 4 0 0 0-4 4 4 4 0 0 0-4-4H3a1 1 0 0 0-1 1v13a1 1 0 0 0 1 1h6a3 3 0 0 1 3 3 3 3 0 0 1 3-3h6a1 1 0 0 0 1-1v-1.3"}]];Sr(t,Yr({name:"book-open-check"},()=>r,{get iconNode(){return n},children:(i,a)=>{var s=Ae(),l=ke(s);xr(l,()=>e.children??Ke),R(i,s)},$$slots:{default:!0}})),ft()}Ze(zl,{},[],[],!0);function Hl(t,e){ut(e,!0);/**
 * @license @lucide/svelte v0.545.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2023 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2025.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 * ---
 *
 * The MIT License (MIT) (for portions derived from Feather)
 *
 * Copyright (c) 2013-2023 Cole Bemis
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */let r=$r(e,["$$slots","$$events","$$legacy","$$host"]);const n=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"}]];Sr(t,Yr({name:"copy"},()=>r,{get iconNode(){return n},children:(i,a)=>{var s=Ae(),l=ke(s);xr(l,()=>e.children??Ke),R(i,s)},$$slots:{default:!0}})),ft()}Ze(Hl,{},[],[],!0);function _s(t,e){ut(e,!0);/**
 * @license @lucide/svelte v0.545.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2023 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2025.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 * ---
 *
 * The MIT License (MIT) (for portions derived from Feather)
 *
 * Copyright (c) 2013-2023 Cole Bemis
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */let r=$r(e,["$$slots","$$events","$$legacy","$$host"]);const n=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0"}],["circle",{cx:"12",cy:"12",r:"3"}]];Sr(t,Yr({name:"eye"},()=>r,{get iconNode(){return n},children:(i,a)=>{var s=Ae(),l=ke(s);xr(l,()=>e.children??Ke),R(i,s)},$$slots:{default:!0}})),ft()}Ze(_s,{},[],[],!0);function xs(t,e){ut(e,!0);/**
 * @license @lucide/svelte v0.545.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2023 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2025.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 * ---
 *
 * The MIT License (MIT) (for portions derived from Feather)
 *
 * Copyright (c) 2013-2023 Cole Bemis
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */let r=$r(e,["$$slots","$$events","$$legacy","$$host"]);const n=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z"}],["path",{d:"m15 5 4 4"}]];Sr(t,Yr({name:"pencil"},()=>r,{get iconNode(){return n},children:(i,a)=>{var s=Ae(),l=ke(s);xr(l,()=>e.children??Ke),R(i,s)},$$slots:{default:!0}})),ft()}Ze(xs,{},[],[],!0);function $s(t,e){ut(e,!0);/**
 * @license @lucide/svelte v0.545.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2023 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2025.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 * ---
 *
 * The MIT License (MIT) (for portions derived from Feather)
 *
 * Copyright (c) 2013-2023 Cole Bemis
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */let r=$r(e,["$$slots","$$events","$$legacy","$$host"]);const n=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8"}],["path",{d:"M3 3v5h5"}]];Sr(t,Yr({name:"rotate-ccw"},()=>r,{get iconNode(){return n},children:(i,a)=>{var s=Ae(),l=ke(s);xr(l,()=>e.children??Ke),R(i,s)},$$slots:{default:!0}})),ft()}Ze($s,{},[],[],!0);function Ss(t,e){ut(e,!0);/**
 * @license @lucide/svelte v0.545.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2023 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2025.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 * ---
 *
 * The MIT License (MIT) (for portions derived from Feather)
 *
 * Copyright (c) 2013-2023 Cole Bemis
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */let r=$r(e,["$$slots","$$events","$$legacy","$$host"]);const n=[["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6"}],["path",{d:"M3 6h18"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"}]];Sr(t,Yr({name:"trash"},()=>r,{get iconNode(){return n},children:(i,a)=>{var s=Ae(),l=ke(s);xr(l,()=>e.children??Ke),R(i,s)},$$slots:{default:!0}})),ft()}Ze(Ss,{},[],[],!0);const oa=Math.min,dn=Math.max,la=Math.round,Ui=Math.floor,rr=t=>({x:t,y:t}),td={left:"right",right:"left",bottom:"top",top:"bottom"},rd={start:"end",end:"start"};function ko(t,e,r){return dn(t,oa(e,r))}function Ca(t,e){return typeof t=="function"?t(e):t}function mn(t){return t.split("-")[0]}function ka(t){return t.split("-")[1]}function Ul(t){return t==="x"?"y":"x"}function ql(t){return t==="y"?"height":"width"}const nd=new Set(["top","bottom"]);function Wr(t){return nd.has(mn(t))?"y":"x"}function Gl(t){return Ul(Wr(t))}function id(t,e,r){r===void 0&&(r=!1);const n=ka(t),i=Gl(t),a=ql(i);let s=i==="x"?n===(r?"end":"start")?"right":"left":n==="start"?"bottom":"top";return e.reference[a]>e.floating[a]&&(s=ca(s)),[s,ca(s)]}function ad(t){const e=ca(t);return[Ps(t),e,Ps(e)]}function Ps(t){return t.replace(/start|end/g,e=>rd[e])}const Fo=["left","right"],Eo=["right","left"],sd=["top","bottom"],od=["bottom","top"];function ld(t,e,r){switch(t){case"top":case"bottom":return r?e?Eo:Fo:e?Fo:Eo;case"left":case"right":return e?sd:od;default:return[]}}function cd(t,e,r,n){const i=ka(t);let a=ld(mn(t),r==="start",n);return i&&(a=a.map(s=>s+"-"+i),e&&(a=a.concat(a.map(Ps)))),a}function ca(t){return t.replace(/left|right|bottom|top/g,e=>td[e])}function ud(t){return{top:0,right:0,bottom:0,left:0,...t}}function fd(t){return typeof t!="number"?ud(t):{top:t,right:t,bottom:t,left:t}}function ua(t){const{x:e,y:r,width:n,height:i}=t;return{width:n,height:i,top:r,left:e,right:e+n,bottom:r+i,x:e,y:r}}function jo(t,e,r){let{reference:n,floating:i}=t;const a=Wr(e),s=Gl(e),l=ql(s),o=mn(e),c=a==="y",f=n.x+n.width/2-i.width/2,h=n.y+n.height/2-i.height/2,v=n[l]/2-i[l]/2;let m;switch(o){case"top":m={x:f,y:n.y-i.height};break;case"bottom":m={x:f,y:n.y+n.height};break;case"right":m={x:n.x+n.width,y:h};break;case"left":m={x:n.x-i.width,y:h};break;default:m={x:n.x,y:n.y}}switch(ka(e)){case"start":m[s]-=v*(r&&c?-1:1);break;case"end":m[s]+=v*(r&&c?-1:1);break}return m}const dd=async(t,e,r)=>{const{placement:n="bottom",strategy:i="absolute",middleware:a=[],platform:s}=r,l=a.filter(Boolean),o=await(s.isRTL==null?void 0:s.isRTL(e));let c=await s.getElementRects({reference:t,floating:e,strategy:i}),{x:f,y:h}=jo(c,n,o),v=n,m={},u=0;for(let g=0;g<l.length;g++){const{name:b,fn:_}=l[g],{x:$,y:P,data:x,reset:N}=await _({x:f,y:h,initialPlacement:n,placement:v,strategy:i,middlewareData:m,rects:c,platform:s,elements:{reference:t,floating:e}});f=$??f,h=P??h,m={...m,[b]:{...m[b],...x}},N&&u<=50&&(u++,typeof N=="object"&&(N.placement&&(v=N.placement),N.rects&&(c=N.rects===!0?await s.getElementRects({reference:t,floating:e,strategy:i}):N.rects),{x:f,y:h}=jo(c,v,o)),g=-1)}return{x:f,y:h,placement:v,strategy:i,middlewareData:m}};async function Yl(t,e){var r;e===void 0&&(e={});const{x:n,y:i,platform:a,rects:s,elements:l,strategy:o}=t,{boundary:c="clippingAncestors",rootBoundary:f="viewport",elementContext:h="floating",altBoundary:v=!1,padding:m=0}=Ca(e,t),u=fd(m),b=l[v?h==="floating"?"reference":"floating":h],_=ua(await a.getClippingRect({element:(r=await(a.isElement==null?void 0:a.isElement(b)))==null||r?b:b.contextElement||await(a.getDocumentElement==null?void 0:a.getDocumentElement(l.floating)),boundary:c,rootBoundary:f,strategy:o})),$=h==="floating"?{x:n,y:i,width:s.floating.width,height:s.floating.height}:s.reference,P=await(a.getOffsetParent==null?void 0:a.getOffsetParent(l.floating)),x=await(a.isElement==null?void 0:a.isElement(P))?await(a.getScale==null?void 0:a.getScale(P))||{x:1,y:1}:{x:1,y:1},N=ua(a.convertOffsetParentRelativeRectToViewportRelativeRect?await a.convertOffsetParentRelativeRectToViewportRelativeRect({elements:l,rect:$,offsetParent:P,strategy:o}):$);return{top:(_.top-N.top+u.top)/x.y,bottom:(N.bottom-_.bottom+u.bottom)/x.y,left:(_.left-N.left+u.left)/x.x,right:(N.right-_.right+u.right)/x.x}}const hd=function(t){return t===void 0&&(t={}),{name:"flip",options:t,async fn(e){var r,n;const{placement:i,middlewareData:a,rects:s,initialPlacement:l,platform:o,elements:c}=e,{mainAxis:f=!0,crossAxis:h=!0,fallbackPlacements:v,fallbackStrategy:m="bestFit",fallbackAxisSideDirection:u="none",flipAlignment:g=!0,...b}=Ca(t,e);if((r=a.arrow)!=null&&r.alignmentOffset)return{};const _=mn(i),$=Wr(l),P=mn(l)===l,x=await(o.isRTL==null?void 0:o.isRTL(c.floating)),N=v||(P||!g?[ca(l)]:ad(l)),C=u!=="none";!v&&C&&N.push(...cd(l,g,u,x));const E=[l,...N],w=await Yl(e,b),q=[];let J=((n=a.flip)==null?void 0:n.overflows)||[];if(f&&q.push(w[_]),h){const Oe=id(i,s,x);q.push(w[Oe[0]],w[Oe[1]])}if(J=[...J,{placement:i,overflows:q}],!q.every(Oe=>Oe<=0)){var ye,K;const Oe=(((ye=a.flip)==null?void 0:ye.index)||0)+1,Te=E[Oe];if(Te&&(!(h==="alignment"?$!==Wr(Te):!1)||J.every(W=>Wr(W.placement)===$?W.overflows[0]>0:!0)))return{data:{index:Oe,overflows:J},reset:{placement:Te}};let Qe=(K=J.filter(et=>et.overflows[0]<=0).sort((et,W)=>et.overflows[1]-W.overflows[1])[0])==null?void 0:K.placement;if(!Qe)switch(m){case"bestFit":{var re;const et=(re=J.filter(W=>{if(C){const Fe=Wr(W.placement);return Fe===$||Fe==="y"}return!0}).map(W=>[W.placement,W.overflows.filter(Fe=>Fe>0).reduce((Fe,Nt)=>Fe+Nt,0)]).sort((W,Fe)=>W[1]-Fe[1])[0])==null?void 0:re[0];et&&(Qe=et);break}case"initialPlacement":Qe=l;break}if(i!==Qe)return{reset:{placement:Qe}}}return{}}}},pd=new Set(["left","top"]);async function vd(t,e){const{placement:r,platform:n,elements:i}=t,a=await(n.isRTL==null?void 0:n.isRTL(i.floating)),s=mn(r),l=ka(r),o=Wr(r)==="y",c=pd.has(s)?-1:1,f=a&&o?-1:1,h=Ca(e,t);let{mainAxis:v,crossAxis:m,alignmentAxis:u}=typeof h=="number"?{mainAxis:h,crossAxis:0,alignmentAxis:null}:{mainAxis:h.mainAxis||0,crossAxis:h.crossAxis||0,alignmentAxis:h.alignmentAxis};return l&&typeof u=="number"&&(m=l==="end"?u*-1:u),o?{x:m*f,y:v*c}:{x:v*c,y:m*f}}const md=function(t){return t===void 0&&(t=0),{name:"offset",options:t,async fn(e){var r,n;const{x:i,y:a,placement:s,middlewareData:l}=e,o=await vd(e,t);return s===((r=l.offset)==null?void 0:r.placement)&&(n=l.arrow)!=null&&n.alignmentOffset?{}:{x:i+o.x,y:a+o.y,data:{...o,placement:s}}}}},gd=function(t){return t===void 0&&(t={}),{name:"shift",options:t,async fn(e){const{x:r,y:n,placement:i}=e,{mainAxis:a=!0,crossAxis:s=!1,limiter:l={fn:b=>{let{x:_,y:$}=b;return{x:_,y:$}}},...o}=Ca(t,e),c={x:r,y:n},f=await Yl(e,o),h=Wr(mn(i)),v=Ul(h);let m=c[v],u=c[h];if(a){const b=v==="y"?"top":"left",_=v==="y"?"bottom":"right",$=m+f[b],P=m-f[_];m=ko($,m,P)}if(s){const b=h==="y"?"top":"left",_=h==="y"?"bottom":"right",$=u+f[b],P=u-f[_];u=ko($,u,P)}const g=l.fn({...e,[v]:m,[h]:u});return{...g,data:{x:g.x-r,y:g.y-n,enabled:{[v]:a,[h]:s}}}}}};function Fa(){return typeof window<"u"}function oi(t){return Jl(t)?(t.nodeName||"").toLowerCase():"#document"}function gt(t){var e;return(t==null||(e=t.ownerDocument)==null?void 0:e.defaultView)||window}function lr(t){var e;return(e=(Jl(t)?t.ownerDocument:t.document)||window.document)==null?void 0:e.documentElement}function Jl(t){return Fa()?t instanceof Node||t instanceof gt(t).Node:!1}function Vt(t){return Fa()?t instanceof Element||t instanceof gt(t).Element:!1}function sr(t){return Fa()?t instanceof HTMLElement||t instanceof gt(t).HTMLElement:!1}function Ao(t){return!Fa()||typeof ShadowRoot>"u"?!1:t instanceof ShadowRoot||t instanceof gt(t).ShadowRoot}const bd=new Set(["inline","contents"]);function Li(t){const{overflow:e,overflowX:r,overflowY:n,display:i}=Wt(t);return/auto|scroll|overlay|hidden|clip/.test(e+n+r)&&!bd.has(i)}const wd=new Set(["table","td","th"]);function yd(t){return wd.has(oi(t))}const _d=[":popover-open",":modal"];function Ea(t){return _d.some(e=>{try{return t.matches(e)}catch{return!1}})}const xd=["transform","translate","scale","rotate","perspective"],$d=["transform","translate","scale","rotate","perspective","filter"],Sd=["paint","layout","strict","content"];function Us(t){const e=qs(),r=Vt(t)?Wt(t):t;return xd.some(n=>r[n]?r[n]!=="none":!1)||(r.containerType?r.containerType!=="normal":!1)||!e&&(r.backdropFilter?r.backdropFilter!=="none":!1)||!e&&(r.filter?r.filter!=="none":!1)||$d.some(n=>(r.willChange||"").includes(n))||Sd.some(n=>(r.contain||"").includes(n))}function Pd(t){let e=qr(t);for(;sr(e)&&!ti(e);){if(Us(e))return e;if(Ea(e))return null;e=qr(e)}return null}function qs(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}const Cd=new Set(["html","body","#document"]);function ti(t){return Cd.has(oi(t))}function Wt(t){return gt(t).getComputedStyle(t)}function ja(t){return Vt(t)?{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}:{scrollLeft:t.scrollX,scrollTop:t.scrollY}}function qr(t){if(oi(t)==="html")return t;const e=t.assignedSlot||t.parentNode||Ao(t)&&t.host||lr(t);return Ao(e)?e.host:e}function Kl(t){const e=qr(t);return ti(e)?t.ownerDocument?t.ownerDocument.body:t.body:sr(e)&&Li(e)?e:Kl(e)}function Fi(t,e,r){var n;e===void 0&&(e=[]),r===void 0&&(r=!0);const i=Kl(t),a=i===((n=t.ownerDocument)==null?void 0:n.body),s=gt(i);if(a){const l=Cs(s);return e.concat(s,s.visualViewport||[],Li(i)?i:[],l&&r?Fi(l):[])}return e.concat(i,Fi(i,[],r))}function Cs(t){return t.parent&&Object.getPrototypeOf(t.parent)?t.frameElement:null}function Xl(t){const e=Wt(t);let r=parseFloat(e.width)||0,n=parseFloat(e.height)||0;const i=sr(t),a=i?t.offsetWidth:r,s=i?t.offsetHeight:n,l=la(r)!==a||la(n)!==s;return l&&(r=a,n=s),{width:r,height:n,$:l}}function Gs(t){return Vt(t)?t:t.contextElement}function zn(t){const e=Gs(t);if(!sr(e))return rr(1);const r=e.getBoundingClientRect(),{width:n,height:i,$:a}=Xl(e);let s=(a?la(r.width):r.width)/n,l=(a?la(r.height):r.height)/i;return(!s||!Number.isFinite(s))&&(s=1),(!l||!Number.isFinite(l))&&(l=1),{x:s,y:l}}const kd=rr(0);function Zl(t){const e=gt(t);return!qs()||!e.visualViewport?kd:{x:e.visualViewport.offsetLeft,y:e.visualViewport.offsetTop}}function Fd(t,e,r){return e===void 0&&(e=!1),!r||e&&r!==gt(t)?!1:e}function gn(t,e,r,n){e===void 0&&(e=!1),r===void 0&&(r=!1);const i=t.getBoundingClientRect(),a=Gs(t);let s=rr(1);e&&(n?Vt(n)&&(s=zn(n)):s=zn(t));const l=Fd(a,r,n)?Zl(a):rr(0);let o=(i.left+l.x)/s.x,c=(i.top+l.y)/s.y,f=i.width/s.x,h=i.height/s.y;if(a){const v=gt(a),m=n&&Vt(n)?gt(n):n;let u=v,g=Cs(u);for(;g&&n&&m!==u;){const b=zn(g),_=g.getBoundingClientRect(),$=Wt(g),P=_.left+(g.clientLeft+parseFloat($.paddingLeft))*b.x,x=_.top+(g.clientTop+parseFloat($.paddingTop))*b.y;o*=b.x,c*=b.y,f*=b.x,h*=b.y,o+=P,c+=x,u=gt(g),g=Cs(u)}}return ua({width:f,height:h,x:o,y:c})}function Aa(t,e){const r=ja(t).scrollLeft;return e?e.left+r:gn(lr(t)).left+r}function Ql(t,e){const r=t.getBoundingClientRect(),n=r.left+e.scrollLeft-Aa(t,r),i=r.top+e.scrollTop;return{x:n,y:i}}function Ed(t){let{elements:e,rect:r,offsetParent:n,strategy:i}=t;const a=i==="fixed",s=lr(n),l=e?Ea(e.floating):!1;if(n===s||l&&a)return r;let o={scrollLeft:0,scrollTop:0},c=rr(1);const f=rr(0),h=sr(n);if((h||!h&&!a)&&((oi(n)!=="body"||Li(s))&&(o=ja(n)),sr(n))){const m=gn(n);c=zn(n),f.x=m.x+n.clientLeft,f.y=m.y+n.clientTop}const v=s&&!h&&!a?Ql(s,o):rr(0);return{width:r.width*c.x,height:r.height*c.y,x:r.x*c.x-o.scrollLeft*c.x+f.x+v.x,y:r.y*c.y-o.scrollTop*c.y+f.y+v.y}}function jd(t){return Array.from(t.getClientRects())}function Ad(t){const e=lr(t),r=ja(t),n=t.ownerDocument.body,i=dn(e.scrollWidth,e.clientWidth,n.scrollWidth,n.clientWidth),a=dn(e.scrollHeight,e.clientHeight,n.scrollHeight,n.clientHeight);let s=-r.scrollLeft+Aa(t);const l=-r.scrollTop;return Wt(n).direction==="rtl"&&(s+=dn(e.clientWidth,n.clientWidth)-i),{width:i,height:a,x:s,y:l}}const To=25;function Td(t,e){const r=gt(t),n=lr(t),i=r.visualViewport;let a=n.clientWidth,s=n.clientHeight,l=0,o=0;if(i){a=i.width,s=i.height;const f=qs();(!f||f&&e==="fixed")&&(l=i.offsetLeft,o=i.offsetTop)}const c=Aa(n);if(c<=0){const f=n.ownerDocument,h=f.body,v=getComputedStyle(h),m=f.compatMode==="CSS1Compat"&&parseFloat(v.marginLeft)+parseFloat(v.marginRight)||0,u=Math.abs(n.clientWidth-h.clientWidth-m);u<=To&&(a-=u)}else c<=To&&(a+=c);return{width:a,height:s,x:l,y:o}}const Nd=new Set(["absolute","fixed"]);function Dd(t,e){const r=gn(t,!0,e==="fixed"),n=r.top+t.clientTop,i=r.left+t.clientLeft,a=sr(t)?zn(t):rr(1),s=t.clientWidth*a.x,l=t.clientHeight*a.y,o=i*a.x,c=n*a.y;return{width:s,height:l,x:o,y:c}}function No(t,e,r){let n;if(e==="viewport")n=Td(t,r);else if(e==="document")n=Ad(lr(t));else if(Vt(e))n=Dd(e,r);else{const i=Zl(t);n={x:e.x-i.x,y:e.y-i.y,width:e.width,height:e.height}}return ua(n)}function ec(t,e){const r=qr(t);return r===e||!Vt(r)||ti(r)?!1:Wt(r).position==="fixed"||ec(r,e)}function Od(t,e){const r=e.get(t);if(r)return r;let n=Fi(t,[],!1).filter(l=>Vt(l)&&oi(l)!=="body"),i=null;const a=Wt(t).position==="fixed";let s=a?qr(t):t;for(;Vt(s)&&!ti(s);){const l=Wt(s),o=Us(s);!o&&l.position==="fixed"&&(i=null),(a?!o&&!i:!o&&l.position==="static"&&!!i&&Nd.has(i.position)||Li(s)&&!o&&ec(t,s))?n=n.filter(f=>f!==s):i=l,s=qr(s)}return e.set(t,n),n}function Ld(t){let{element:e,boundary:r,rootBoundary:n,strategy:i}=t;const s=[...r==="clippingAncestors"?Ea(e)?[]:Od(e,this._c):[].concat(r),n],l=s[0],o=s.reduce((c,f)=>{const h=No(e,f,i);return c.top=dn(h.top,c.top),c.right=oa(h.right,c.right),c.bottom=oa(h.bottom,c.bottom),c.left=dn(h.left,c.left),c},No(e,l,i));return{width:o.right-o.left,height:o.bottom-o.top,x:o.left,y:o.top}}function Md(t){const{width:e,height:r}=Xl(t);return{width:e,height:r}}function Rd(t,e,r){const n=sr(e),i=lr(e),a=r==="fixed",s=gn(t,!0,a,e);let l={scrollLeft:0,scrollTop:0};const o=rr(0);function c(){o.x=Aa(i)}if(n||!n&&!a)if((oi(e)!=="body"||Li(i))&&(l=ja(e)),n){const m=gn(e,!0,a,e);o.x=m.x+e.clientLeft,o.y=m.y+e.clientTop}else i&&c();a&&!n&&i&&c();const f=i&&!n&&!a?Ql(i,l):rr(0),h=s.left+l.scrollLeft-o.x-f.x,v=s.top+l.scrollTop-o.y-f.y;return{x:h,y:v,width:s.width,height:s.height}}function Xa(t){return Wt(t).position==="static"}function Do(t,e){if(!sr(t)||Wt(t).position==="fixed")return null;if(e)return e(t);let r=t.offsetParent;return lr(t)===r&&(r=r.ownerDocument.body),r}function tc(t,e){const r=gt(t);if(Ea(t))return r;if(!sr(t)){let i=qr(t);for(;i&&!ti(i);){if(Vt(i)&&!Xa(i))return i;i=qr(i)}return r}let n=Do(t,e);for(;n&&yd(n)&&Xa(n);)n=Do(n,e);return n&&ti(n)&&Xa(n)&&!Us(n)?r:n||Pd(t)||r}const Id=async function(t){const e=this.getOffsetParent||tc,r=this.getDimensions,n=await r(t.floating);return{reference:Rd(t.reference,await e(t.floating),t.strategy),floating:{x:0,y:0,width:n.width,height:n.height}}};function Bd(t){return Wt(t).direction==="rtl"}const Vd={convertOffsetParentRelativeRectToViewportRelativeRect:Ed,getDocumentElement:lr,getClippingRect:Ld,getOffsetParent:tc,getElementRects:Id,getClientRects:jd,getDimensions:Md,getScale:zn,isElement:Vt,isRTL:Bd};function rc(t,e){return t.x===e.x&&t.y===e.y&&t.width===e.width&&t.height===e.height}function Wd(t,e){let r=null,n;const i=lr(t);function a(){var l;clearTimeout(n),(l=r)==null||l.disconnect(),r=null}function s(l,o){l===void 0&&(l=!1),o===void 0&&(o=1),a();const c=t.getBoundingClientRect(),{left:f,top:h,width:v,height:m}=c;if(l||e(),!v||!m)return;const u=Ui(h),g=Ui(i.clientWidth-(f+v)),b=Ui(i.clientHeight-(h+m)),_=Ui(f),P={rootMargin:-u+"px "+-g+"px "+-b+"px "+-_+"px",threshold:dn(0,oa(1,o))||1};let x=!0;function N(C){const E=C[0].intersectionRatio;if(E!==o){if(!x)return s();E?s(!1,E):n=setTimeout(()=>{s(!1,1e-7)},1e3)}E===1&&!rc(c,t.getBoundingClientRect())&&s(),x=!1}try{r=new IntersectionObserver(N,{...P,root:i.ownerDocument})}catch{r=new IntersectionObserver(N,P)}r.observe(t)}return s(!0),a}function zd(t,e,r,n){n===void 0&&(n={});const{ancestorScroll:i=!0,ancestorResize:a=!0,elementResize:s=typeof ResizeObserver=="function",layoutShift:l=typeof IntersectionObserver=="function",animationFrame:o=!1}=n,c=Gs(t),f=i||a?[...c?Fi(c):[],...Fi(e)]:[];f.forEach(_=>{i&&_.addEventListener("scroll",r,{passive:!0}),a&&_.addEventListener("resize",r)});const h=c&&l?Wd(c,r):null;let v=-1,m=null;s&&(m=new ResizeObserver(_=>{let[$]=_;$&&$.target===c&&m&&(m.unobserve(e),cancelAnimationFrame(v),v=requestAnimationFrame(()=>{var P;(P=m)==null||P.observe(e)})),r()}),c&&!o&&m.observe(c),m.observe(e));let u,g=o?gn(t):null;o&&b();function b(){const _=gn(t);g&&!rc(g,_)&&r(),g=_,u=requestAnimationFrame(b)}return r(),()=>{var _;f.forEach($=>{i&&$.removeEventListener("scroll",r),a&&$.removeEventListener("resize",r)}),h==null||h(),(_=m)==null||_.disconnect(),m=null,o&&cancelAnimationFrame(u)}}const Hd=md,Ud=gd,qd=hd,Gd=(t,e,r)=>{const n=new Map,i={platform:Vd,...r},a={...i.platform,_c:n};return dd(t,e,{...i,platform:a})};function Yd(t){let e,r;const n={autoUpdate:!0};let i=t;const a=f=>({...n,...t||{},...f||{}}),s=f=>{e&&r&&(i=a(f),Gd(e,r,i).then(h=>{Object.assign(r.style,{position:h.strategy,left:`${h.x}px`,top:`${h.y}px`}),i!=null&&i.onComputed&&i.onComputed(h)}))},l=f=>{if("subscribe"in f)return c(f),{};e=f,s()},o=(f,h)=>{let v;r=f,i=a(h),setTimeout(()=>s(h),0),s(h);const m=()=>{v&&(v(),v=void 0)},u=({autoUpdate:g}=i||{})=>{if(m(),g!==!1)return zd(e,r,()=>s(i),g===!0?{}:g)};return v=u(),{update(g){s(g),v=u(g)},destroy(){m()}}},c=f=>{const h=f.subscribe(v=>{e===void 0?(e=v,s()):(Object.assign(e,v),s())});Ws(h)};return[l,o,s]}function Jd({loadOptions:t,filterText:e,items:r,multiple:n,value:i,itemId:a,groupBy:s,filterSelectedItems:l,itemFilter:o,convertStringItemsToObjects:c,filterGroupedItems:f,label:h}){if(r&&t)return r;if(!r)return[];r&&r.length>0&&typeof r[0]!="object"&&(r=c(r));let v=r.filter(m=>{let u=o(m[h],e,m);return u&&n&&(i!=null&&i.length)&&(u=!i.some(g=>l?g[a]===m[a]:!1)),u});return s&&(v=f(v)),v}async function Kd({dispatch:t,loadOptions:e,convertStringItemsToObjects:r,filterText:n}){let i=await e(n).catch(a=>{console.warn("svelte-select loadOptions error :>> ",a),t("error",{type:"loadOptions",details:a})});if(i&&!i.cancelled)return i?(i&&i.length>0&&typeof i[0]!="object"&&(i=r(i)),t("loaded",{items:i})):i=[],{filteredItems:i,loading:!1,focused:!0,listOpen:!0}}var Xd=Pa(`<svg width="100%" height="100%" viewBox="0 0 20 20" focusable="false" aria-hidden="true" class="svelte-1cjxppd"><path fill="currentColor" d="M4.516 7.548c0.436-0.446 1.043-0.481 1.576 0l3.908 3.747
          3.908-3.747c0.533-0.481 1.141-0.446 1.574 0 0.436 0.445 0.408 1.197 0
          1.615-0.406 0.418-4.695 4.502-4.695 4.502-0.217 0.223-0.502
          0.335-0.787 0.335s-0.57-0.112-0.789-0.335c0
          0-4.287-4.084-4.695-4.502s-0.436-1.17 0-1.615z"></path></svg>`);const Zd={hash:"svelte-1cjxppd",code:"svg.svelte-1cjxppd {width:var(--chevron-icon-width, 20px);height:var(--chevron-icon-width, 20px);color:var(--chevron-icon-colour, currentColor);}"};function nc(t){si(t,Zd);var e=Xd();R(t,e)}Ze(nc,{},[],[],!0);var Qd=Pa(`<svg width="100%" height="100%" viewBox="-2 -2 50 50" focusable="false" aria-hidden="true" role="presentation" class="svelte-1tqf49v"><path fill="currentColor" d="M34.923,37.251L24,26.328L13.077,37.251L9.436,33.61l10.923-10.923L9.436,11.765l3.641-3.641L24,19.047L34.923,8.124
    l3.641,3.641L27.641,22.688L38.564,33.61L34.923,37.251z"></path></svg>`);const eh={hash:"svelte-1tqf49v",code:"svg.svelte-1tqf49v {width:var(--clear-icon-width, 20px);height:var(--clear-icon-width, 20px);color:var(--clear-icon-color, currentColor);}"};function Qi(t){si(t,eh);var e=Qd();R(t,e)}Ze(Qi,{},[],[],!0);var th=Pa('<svg class="loading svelte-5svtgc" viewBox="25 25 50 50"><circle class="circle_path svelte-5svtgc" cx="50" cy="50" r="20" fill="none" stroke="currentColor" stroke-width="5" stroke-miterlimit="10"></circle></svg>');const rh={hash:"svelte-5svtgc",code:`.loading.svelte-5svtgc {width:var(--spinner-width, 20px);height:var(--spinner-height, 20px);color:var(--spinner-color, var(--icons-color));
        animation: svelte-5svtgc-rotate 0.75s linear infinite;transform-origin:center center;transform:none;}.circle_path.svelte-5svtgc {stroke-dasharray:90;stroke-linecap:round;}

    @keyframes svelte-5svtgc-rotate {
        100% {
            transform: rotate(360deg);
        }
    }`};function ic(t){si(t,rh);var e=th();R(t,e)}Ze(ic,{},[],[],!0);var nh=fe('<div class="list-item svelte-di53br" tabindex="-1" role="none"><div><!></div></div>'),ih=fe('<div class="empty svelte-di53br">No options</div>'),ah=fe("<div><!> <!> <!></div>"),sh=fe('<span id="aria-selection" class="svelte-di53br"> </span> <span id="aria-context" class="svelte-di53br"> </span>',1),oh=fe('<div class="multi-item-clear svelte-di53br"><!></div>'),lh=fe('<div role="none"><span class="multi-item-text svelte-di53br"><!></span> <!></div>'),ch=fe("<div><!></div>"),uh=fe('<div class="icon loading svelte-di53br" aria-hidden="true"><!></div>'),fh=fe('<button type="button" class="icon clear-select svelte-di53br"><!></button>'),dh=fe('<div class="icon chevron svelte-di53br" aria-hidden="true"><!></div>'),hh=fe('<input type="hidden" class="svelte-di53br"/>'),ph=fe('<select class="required svelte-di53br" required tabindex="-1" aria-hidden="true"></select>'),vh=fe('<div role="none"><!> <span aria-live="polite" aria-atomic="false" aria-relevant="additions text" class="a11y-text svelte-di53br"><!></span> <div class="prepend svelte-di53br"><!></div> <div class="value-container svelte-di53br"><!> <input/></div> <div class="indicators svelte-di53br"><!> <!> <!></div> <!> <!></div>');const mh={hash:"svelte-di53br",code:`.svelte-select.svelte-di53br {
        /* deprecating camelCase custom props in favour of kebab-case for v5 */--borderRadius: var(--border-radius);--clearSelectColor: var(--clear-select-color);--clearSelectWidth: var(--clear-select-width);--disabledBackground: var(--disabled-background);--disabledBorderColor: var(--disabled-border-color);--disabledColor: var(--disabled-color);--disabledPlaceholderColor: var(--disabled-placeholder-color);--disabledPlaceholderOpacity: var(--disabled-placeholder-opacity);--errorBackground: var(--error-background);--errorBorder: var(--error-border);--groupItemPaddingLeft: var(--group-item-padding-left);--groupTitleColor: var(--group-title-color);--groupTitleFontSize: var(--group-title-font-size);--groupTitleFontWeight: var(--group-title-font-weight);--groupTitlePadding: var(--group-title-padding);--groupTitleTextTransform: var(--group-title-text-transform);--groupTitleBorderColor: var(--group-title-border-color);--groupTitleBorderWidth: var(--group-title-border-width);--groupTitleBorderStyle: var(--group-title-border-style);--indicatorColor: var(--chevron-color);--indicatorHeight: var(--chevron-height);--indicatorWidth: var(--chevron-width);--inputColor: var(--input-color);--inputLeft: var(--input-left);--inputLetterSpacing: var(--input-letter-spacing);--inputMargin: var(--input-margin);--inputPadding: var(--input-padding);--itemActiveBackground: var(--item-active-background);--itemColor: var(--item-color);--itemFirstBorderRadius: var(--item-first-border-radius);--itemHoverBG: var(--item-hover-bg);--itemHoverColor: var(--item-hover-color);--itemIsActiveBG: var(--item-is-active-bg);--itemIsActiveColor: var(--item-is-active-color);--itemIsNotSelectableColor: var(--item-is-not-selectable-color);--itemPadding: var(--item-padding);--listBackground: var(--list-background);--listBorder: var(--list-border);--listBorderRadius: var(--list-border-radius);--listEmptyColor: var(--list-empty-color);--listEmptyPadding: var(--list-empty-padding);--listEmptyTextAlign: var(--list-empty-text-align);--listMaxHeight: var(--list-max-height);--listPosition: var(--list-position);--listShadow: var(--list-shadow);--listZIndex: var(--list-z-index);--multiItemBG: var(--multi-item-bg);--multiItemBorderRadius: var(--multi-item-border-radius);--multiItemDisabledHoverBg: var(--multi-item-disabled-hover-bg);--multiItemDisabledHoverColor: var(--multi-item-disabled-hover-color);--multiItemHeight: var(--multi-item-height);--multiItemMargin: var(--multi-item-margin);--multiItemPadding: var(--multi-item-padding);--multiSelectInputMargin: var(--multi-select-input-margin);--multiSelectInputPadding: var(--multi-select-input-padding);--multiSelectPadding: var(--multi-select-padding);--placeholderColor: var(--placeholder-color);--placeholderOpacity: var(--placeholder-opacity);--selectedItemPadding: var(--selected-item-padding);--spinnerColor: var(--spinner-color);--spinnerHeight: var(--spinner-height);--spinnerWidth: var(--spinner-width);--internal-padding: 0 0 0 16px;border:var(--border, 1px solid #d8dbdf);border-radius:var(--border-radius, 6px);min-height:var(--height, 42px);position:relative;display:flex;align-items:stretch;padding:var(--padding, var(--internal-padding));background:var(--background, #fff);margin:var(--margin, 0);width:var(--width, 100%);font-size:var(--font-size, 16px);max-height:var(--max-height);}.svelte-di53br {box-sizing:var(--box-sizing, border-box);}.svelte-select.svelte-di53br:hover {border:var(--border-hover, 1px solid #b2b8bf);}.value-container.svelte-di53br {display:flex;flex:1 1 0%;flex-wrap:wrap;align-items:center;gap:5px 10px;padding:var(--value-container-padding, 5px 0);position:relative;overflow:var(--value-container-overflow, hidden);align-self:stretch;}.prepend.svelte-di53br,
    .indicators.svelte-di53br {display:flex;flex-shrink:0;align-items:center;}.indicators.svelte-di53br {position:var(--indicators-position);top:var(--indicators-top);right:var(--indicators-right);bottom:var(--indicators-bottom);}input.svelte-di53br {position:absolute;cursor:default;border:none;color:var(--input-color, var(--item-color));padding:var(--input-padding, 0);letter-spacing:var(--input-letter-spacing, inherit);margin:var(--input-margin, 0);min-width:10px;top:0;right:0;bottom:0;left:0;background:transparent;font-size:var(--font-size, 16px);}.svelte-di53br:not(.multi) > .value-container:where(.svelte-di53br) > input:where(.svelte-di53br) {width:100%;height:100%;}input.svelte-di53br::placeholder {color:var(--placeholder-color, #78848f);opacity:var(--placeholder-opacity, 1);}input.svelte-di53br:focus {outline:none;}.svelte-select.focused.svelte-di53br {border:var(--border-focused, 1px solid #006fe8);border-radius:var(--border-radius-focused, var(--border-radius, 6px));}.disabled.svelte-di53br {background:var(--disabled-background, #ebedef);border-color:var(--disabled-border-color, #ebedef);color:var(--disabled-color, #c1c6cc);}.disabled.svelte-di53br input:where(.svelte-di53br)::placeholder {color:var(--disabled-placeholder-color, #c1c6cc);opacity:var(--disabled-placeholder-opacity, 1);}.selected-item.svelte-di53br {position:relative;overflow:var(--selected-item-overflow, hidden);padding:var(--selected-item-padding, 0 20px 0 0);text-overflow:ellipsis;white-space:nowrap;color:var(--selected-item-color, inherit);font-size:var(--font-size, 16px);}.multi.svelte-di53br .selected-item:where(.svelte-di53br) {position:absolute;line-height:var(--height, 42px);height:var(--height, 42px);}.selected-item.svelte-di53br:focus {outline:none;}.hide-selected-item.svelte-di53br {opacity:0;}.icon.svelte-di53br {display:flex;align-items:center;justify-content:center;}.clear-select.svelte-di53br {all:unset;display:flex;align-items:center;justify-content:center;width:var(--clear-select-width, 40px);height:var(--clear-select-height, 100%);color:var(--clear-select-color, var(--icons-color));margin:var(--clear-select-margin, 0);pointer-events:all;flex-shrink:0;}.clear-select.svelte-di53br:focus {outline:var(--clear-select-focus-outline, 1px solid #006fe8);}.loading.svelte-di53br {width:var(--loading-width, 40px);height:var(--loading-height);color:var(--loading-color, var(--icons-color));margin:var(--loading--margin, 0);flex-shrink:0;}.chevron.svelte-di53br {width:var(--chevron-width, 40px);height:var(--chevron-height, 40px);background:var(--chevron-background, transparent);pointer-events:var(--chevron-pointer-events, none);color:var(--chevron-color, var(--icons-color));border:var(--chevron-border, 0 0 0 1px solid #d8dbdf);flex-shrink:0;}.multi.svelte-di53br {padding:var(--multi-select-padding, var(--internal-padding));}.multi.svelte-di53br input:where(.svelte-di53br) {padding:var(--multi-select-input-padding, 0);position:relative;margin:var(--multi-select-input-margin, 5px 0);flex:1 1 40px;}.svelte-select.error.svelte-di53br {border:var(--error-border, 1px solid #ff2d55);background:var(--error-background, #fff);}.a11y-text.svelte-di53br {z-index:9999;border:0px;clip:rect(1px, 1px, 1px, 1px);height:1px;width:1px;position:absolute;overflow:hidden;padding:0px;white-space:nowrap;}.multi-item.svelte-di53br {background:var(--multi-item-bg, #ebedef);margin:var(--multi-item-margin, 0);outline:var(--multi-item-outline, 1px solid #ddd);border-radius:var(--multi-item-border-radius, 4px);height:var(--multi-item-height, 25px);line-height:var(--multi-item-height, 25px);display:flex;cursor:default;padding:var(--multi-item-padding, 0 5px);overflow:hidden;gap:var(--multi-item-gap, 4px);outline-offset:-1px;max-width:var(--multi-max-width, none);color:var(--multi-item-color, var(--item-color));}.multi-item.disabled.svelte-di53br:hover {background:var(--multi-item-disabled-hover-bg, #ebedef);color:var(--multi-item-disabled-hover-color, #c1c6cc);}.multi-item-text.svelte-di53br {overflow:hidden;text-overflow:ellipsis;white-space:nowrap;}.multi-item-clear.svelte-di53br {display:flex;align-items:center;justify-content:center;--clear-icon-color: var(--multi-item-clear-icon-color, #000);}.multi-item.active.svelte-di53br {outline:var(--multi-item-active-outline, 1px solid #006fe8);}.svelte-select-list.svelte-di53br {box-shadow:var(--list-shadow, 0 2px 3px 0 rgba(44, 62, 80, 0.24));border-radius:var(--list-border-radius, 4px);max-height:var(--list-max-height, 252px);overflow-y:auto;background:var(--list-background, #fff);position:var(--list-position, absolute);z-index:var(--list-z-index, 2);border:var(--list-border);}.prefloat.svelte-di53br {opacity:0;pointer-events:none;}.list-group-title.svelte-di53br {color:var(--group-title-color, #8f8f8f);cursor:default;font-size:var(--group-title-font-size, 16px);font-weight:var(--group-title-font-weight, 600);height:var(--height, 42px);line-height:var(--height, 42px);padding:var(--group-title-padding, 0 20px);text-overflow:ellipsis;overflow-x:hidden;white-space:nowrap;text-transform:var(--group-title-text-transform, uppercase);border-width:var(--group-title-border-width, medium);border-style:var(--group-title-border-style, none);border-color:var(--group-title-border-color, color);}.empty.svelte-di53br {text-align:var(--list-empty-text-align, center);padding:var(--list-empty-padding, 20px 0);color:var(--list-empty-color, #78848f);}.item.svelte-di53br {cursor:default;height:var(--item-height, var(--height, 42px));line-height:var(--item-line-height, var(--height, 42px));padding:var(--item-padding, 0 20px);color:var(--item-color, inherit);text-overflow:ellipsis;overflow:hidden;white-space:nowrap;transition:var(--item-transition, all 0.2s);align-items:center;width:100%;}.item.group-item.svelte-di53br {padding-left:var(--group-item-padding-left, 40px);}.item.svelte-di53br:active {background:var(--item-active-background, #b9daff);}.item.active.svelte-di53br {background:var(--item-is-active-bg, #007aff);color:var(--item-is-active-color, #fff);}.item.first.svelte-di53br {border-radius:var(--item-first-border-radius, 4px 4px 0 0);}.item.hover.svelte-di53br:not(.active) {background:var(--item-hover-bg, #e7f2ff);color:var(--item-hover-color, inherit);}.item.not-selectable.svelte-di53br,
    .item.hover.item.not-selectable.svelte-di53br,
    .item.active.item.not-selectable.svelte-di53br,
    .item.not-selectable.svelte-di53br:active {color:var(--item-is-not-selectable-color, #999);background:transparent;}.required.svelte-di53br {opacity:0;z-index:-1;position:absolute;top:0;left:0;bottom:0;right:0;}`};function ac(t,e){const r=kf(e);ut(e,!1),si(t,mh);const n=te(),i=te(),a=te(),s=te(),l=te(),o=te(),c=te(),f=te(),h=te(),v=$f();let m=L(e,"justValue",12,null),u=L(e,"filter",12,Jd),g=L(e,"getItems",12,Kd),b=L(e,"id",12,null),_=L(e,"name",12,null),$=L(e,"container",12,void 0),P=L(e,"input",12,void 0),x=L(e,"multiple",12,!1),N=L(e,"multiFullItemClearable",12,!1),C=L(e,"disabled",12,!1),E=L(e,"focused",12,!1),w=L(e,"value",12,null),q=L(e,"filterText",12,""),J=L(e,"placeholder",12,"Please select"),ye=L(e,"placeholderAlwaysShow",12,!1),K=L(e,"items",12,null),re=L(e,"label",12,"label"),Oe=L(e,"itemFilter",12,(d,S,Y)=>`${d}`.toLowerCase().includes(S.toLowerCase())),Te=L(e,"groupBy",12,void 0),Qe=L(e,"groupFilter",12,d=>d),et=L(e,"groupHeaderSelectable",12,!1),W=L(e,"itemId",12,"value"),Fe=L(e,"loadOptions",12,void 0),Nt=L(e,"containerStyles",12,""),Pr=L(e,"hasError",12,!1),cr=L(e,"filterSelectedItems",12,!0),wt=L(e,"required",12,!1),li=L(e,"closeListOnChange",12,!0),Jr=L(e,"clearFilterTextOnBlur",12,!0),Kr=L(e,"createGroupHeaderItem",12,(d,S)=>({value:d,[re()]:d}));const Pn=()=>p(c);let Cr=L(e,"searchable",12,!0),Cn=L(e,"inputStyles",12,""),kn=L(e,"clearable",12,!0),yt=L(e,"loading",12,!1),Z=L(e,"listOpen",12,!1),ci,ui=L(e,"debounce",12,(d,S=1)=>{clearTimeout(ci),ci=setTimeout(d,S)}),Fn=L(e,"debounceWait",12,300),fi=L(e,"hideEmptyState",12,!1),kr=L(e,"inputAttributes",28,()=>({})),di=L(e,"listAutoWidth",12,!0),En=L(e,"showChevron",12,!1),hi=L(e,"listOffset",12,5),ie=L(e,"hoverItemIndex",12,0),j=L(e,"floatingConfig",28,()=>({})),I=L(e,"class",12,""),M=te(),he=te(),_e=te(),oe=te();function tt(){if(typeof w()=="string"){let d=(K()||[]).find(S=>S[W()]===w());w(d||{[W()]:w(),label:w()})}else x()&&Array.isArray(w())&&w().length>0&&w(w().map(d=>typeof d=="string"?{value:d,label:d}:d))}let Le=te();function ne(){k(Le,Object.assign({autocapitalize:"none",autocomplete:"off",autocorrect:"off",spellcheck:!1,tabindex:0,type:"text","aria-autocomplete":"list"},kr())),b()&&Vi(Le,p(Le).id=b()),Cr()||Vi(Le,p(Le).readonly=!0)}function dt(d){return d.map((S,Y)=>({index:Y,value:S,label:`${S}`}))}function ur(d){const S=[],Y={};d.forEach(rt=>{const je=Te()(rt);S.includes(je)||(S.push(je),Y[je]=[],je&&Y[je].push(Object.assign(Kr()(je,rt),{id:je,groupHeader:!0,selectable:et()}))),Y[je].push(Object.assign({groupItem:!!je},rt))});const Se=[];return Qe()(S).forEach(rt=>{Y[rt]&&Se.push(...Y[rt])}),Se}function Ee(){if(x()){JSON.stringify(w())!==JSON.stringify(p(he))&&pe()&&v("input",w());return}(!p(he)||JSON.stringify(w()[W()])!==JSON.stringify(p(he)[W()]))&&v("input",w())}function ht(){w()&&(Array.isArray(w())?w([...w()]):w([w()]))}function _t(){w()&&w(null)}function Fr(){const d=p(c).findIndex(S=>S[W()]===w()[W()]);le(d,!0)}function Pe(d){v("hoverItem",d)}function le(d=0,S){ie(d<0?0:d),!S&&Te()&&p(c)[ie()]&&!p(c)[ie()].selectable&&Mi(1)}function xe(){!Fe()&&q().length===0||(Fe()?ui()(async function(){yt(!0);let d=await g()({dispatch:v,loadOptions:Fe(),convertStringItemsToObjects:dt,filterText:q()});d?(yt(d.loading),Z(Z()?d.listOpen:q().length>0),E(Z()&&d.focused),K(Te()?ur(d.filteredItems):d.filteredItems)):(yt(!1),E(!0),Z(!0))},Fn()):(Z(!0),x()&&k(M,void 0)))}function $e(d){Z()&&v("filter",d)}Sf(async()=>{k(he,w()),k(_e,q()),k(oe,x())});function Me(){return x()?w()?w().map(d=>d[W()]):null:w()?w()[W()]:w()}function pe(){let d=!0;if(w()){const S=[],Y=[];w().forEach(Se=>{S.includes(Se[W()])?d=!1:(S.push(Se[W()]),Y.push(Se))}),d||w(Y)}return d}function Ce(d){let S=d?d[W()]:w()[W()];return K().find(Y=>Y[W()]===S)}function Dt(d){!d||d.length===0||d.some(S=>typeof S!="object")||!w()||(x()?w().some(S=>!S||!S[W()]):!w()[W()])||(Array.isArray(w())?w(w().map(S=>Ce(S)||S)):w(Ce()||w()))}async function Xr(d){const S=w()[d];w().length===1?w(void 0):w(w().filter(Y=>Y!==S)),v("clear",S)}function Er(d){if(E())switch(d.stopPropagation(),d.key){case"Escape":d.preventDefault(),be();break;case"Enter":if(d.preventDefault(),Z()){if(p(c).length===0)break;const S=p(c)[ie()];if(w()&&!x()&&w()[W()]===S[W()]){be();break}else Na(p(c)[ie()])}break;case"ArrowDown":d.preventDefault(),Z()?Mi(1):(Z(!0),k(M,void 0));break;case"ArrowUp":d.preventDefault(),Z()?Mi(-1):(Z(!0),k(M,void 0));break;case"Tab":if(Z()&&E()){if(p(c).length===0||w()&&w()[W()]===p(c)[ie()][W()])return be();d.preventDefault(),Na(p(c)[ie()]),be()}break;case"Backspace":if(!x()||q().length>0)return;if(x()&&w()&&w().length>0){if(Xr(p(M)!==void 0?p(M):w().length-1),p(M)===0||p(M)===void 0)break;k(M,w().length>p(M)?p(M)-1:void 0)}break;case"ArrowLeft":if(!w()||!x()||q().length>0)return;p(M)===void 0?k(M,w().length-1):w().length>p(M)&&p(M)!==0&&k(M,p(M)-1);break;case"ArrowRight":if(!w()||!x()||q().length>0||p(M)===void 0)return;p(M)===w().length-1?k(M,void 0):p(M)<w().length-1&&k(M,p(M)+1);break}}function fr(d){var S;E()&&P()===(document==null?void 0:document.activeElement)||(d&&v("focus",d),(S=P())==null||S.focus(),E(!0))}async function jr(d){var S;Ta||(Z()||E())&&(v("blur",d),be(),E(!1),k(M,void 0),(S=P())==null||S.blur())}function jn(){if(!C()){if(q().length>0)return Z(!0);Z(!Z())}}function dr(){v("clear",w()),w(void 0),be(),fr()}Vs(()=>{Z()&&E(!0),E()&&P()&&P().focus()});function An(d){if(d){q("");const S=Object.assign({},d);if(S.groupHeader&&!S.selectable)return;w(x()?w()?w().concat([S]):[S]:w(S)),setTimeout(()=>{li()&&be(),k(M,void 0),v("change",w()),v("select",d)})}}function be(){Jr()&&q(""),Z(!1)}let G=L(e,"ariaValues",12,d=>`Option ${d}, selected.`),Ne=L(e,"ariaListOpen",12,(d,S)=>`You are currently focused on option ${d}. There are ${S} results available.`),Ar=L(e,"ariaFocused",12,()=>"Select is focused, type to refine list, press down to open the menu.");function pi(d){let S;return d&&w().length>0?S=w().map(Y=>Y[re()]).join(", "):S=w()[re()],G()(S)}function cc(){if(!p(c)||p(c).length===0)return"";let d=p(c)[ie()];if(Z()&&d){let S=p(c)?p(c).length:0;return Ne()(d[re()],S)}else return Ar()()}let xt=te(null),Ys;function Js(){clearTimeout(Ys),Ys=setTimeout(()=>{Ta=!1},100)}function uc(d){var S;!Z()&&!E()&&$()&&!$().contains(d.target)&&!((S=p(xt))!=null&&S.contains(d.target))&&jr()}Ws(()=>{var d;(d=p(xt))==null||d.remove()});let Ta=!1;function Na(d){!d||d.selectable===!1||An(d)}function Ks(d){Ta||ie(d)}function fc(d){const{item:S,i:Y}=d;if((S==null?void 0:S.selectable)!==!1){if(w()&&!x()&&w()[W()]===S[W()])return be();hc(S)&&(ie(Y),Na(S))}}function Mi(d){if(p(c).filter(Se=>!Object.hasOwn(Se,"selectable")||Se.selectable===!0).length===0)return ie(0);d>0&&ie()===p(c).length-1?ie(0):d<0&&ie()===0?ie(p(c).length-1):ie(ie()+d);const Y=p(c)[ie()];if(Y&&Y.selectable===!1){(d===1||d===-1)&&Mi(d);return}}function Xs(d,S,Y){if(!x())return S&&S[Y]===d[Y]}function dc(d){return d===0}function hc(d){return d.groupHeader&&d.selectable||d.selectable||!d.hasOwnProperty("selectable")}const Da=Zs,Oa=Zs;function Zs(d){return{update(S){S.scroll&&(Js(),d.scrollIntoView({behavior:"auto",block:"nearest"}))}}}function pc(){const{width:d}=$().getBoundingClientRect();Vi(xt,p(xt).style.width=di()?d+"px":"auto")}let vi=te({strategy:"absolute",placement:"bottom-start",middleware:[Hd(hi()),qd(),Ud()],autoUpdate:!1});const[La,Ma,vc]=Yd(p(vi));let Ra=te(!0);function mc(d,S){if(!d||!S)return k(Ra,!0);setTimeout(()=>{k(Ra,!1)},0)}se(()=>(D(K()),D(w())),()=>{K(),w()&&tt()}),se(()=>(D(kr()),D(Cr())),()=>{(kr()||!Cr())&&ne()}),se(()=>D(x()),()=>{x()&&ht()}),se(()=>(p(oe),D(x())),()=>{p(oe)&&!x()&&_t()}),se(()=>(D(x()),D(w())),()=>{x()&&w()&&w().length>1&&pe()}),se(()=>D(w()),()=>{w()&&Ee()}),se(()=>(D(w()),D(x()),p(he)),()=>{!w()&&x()&&p(he)&&v("input",w())}),se(()=>(D(E()),D(P())),()=>{!E()&&P()&&be()}),se(()=>(D(q()),p(_e)),()=>{q()!==p(_e)&&xe()}),se(()=>(D(u()),D(Fe()),D(q()),D(K()),D(x()),D(w()),D(W()),D(Te()),D(re()),D(cr()),D(Oe())),()=>{k(c,u()({loadOptions:Fe(),filterText:q(),items:K(),multiple:x(),value:w(),itemId:W(),groupBy:Te(),label:re(),filterSelectedItems:cr(),itemFilter:Oe(),convertStringItemsToObjects:dt,filterGroupedItems:ur}))}),se(()=>(D(x()),D(Z()),D(w()),p(c)),()=>{!x()&&Z()&&w()&&p(c)&&Fr()}),se(()=>(D(Z()),D(x())),()=>{Z()&&x()&&ie(0)}),se(()=>D(q()),()=>{q()&&ie(0)}),se(()=>D(ie()),()=>{Pe(ie())}),se(()=>(D(x()),D(w())),()=>{k(n,x()?w()&&w().length>0:w())}),se(()=>(p(n),D(q())),()=>{k(i,p(n)&&q().length>0)}),se(()=>(p(n),D(kn()),D(C()),D(yt())),()=>{k(a,p(n)&&kn()&&!C()&&!yt())}),se(()=>(D(ye()),D(x()),D(J()),D(w())),()=>{var d;k(s,ye()&&x()||x()&&((d=w())==null?void 0:d.length)===0?J():w()?"":J())}),se(()=>(D(w()),D(x())),()=>{k(l,w()?pi(x()):"")}),se(()=>(p(c),D(ie()),D(E()),D(Z())),()=>{k(o,cc({filteredItems:p(c),hoverItemIndex:ie(),focused:E(),listOpen:Z()}))}),se(()=>D(K()),()=>{Dt(K())}),se(()=>(D(x()),D(w()),D(W())),()=>{m(Me(x(),w(),W()))}),se(()=>(D(x()),p(he),D(w())),()=>{!x()&&p(he)&&!w()&&v("input",w())}),se(()=>(D(Z()),p(c),D(x()),D(w())),()=>{Z()&&p(c)&&!x()&&!w()&&le()}),se(()=>p(c),()=>{$e(p(c))}),se(()=>(D($()),D(j()),p(vi)),()=>{$()&&j()&&vc(Object.assign(p(vi),j()))}),se(()=>p(xt),()=>{k(f,!!p(xt))}),se(()=>(p(xt),D(Z())),()=>{mc(p(xt),Z())}),se(()=>(D(Z()),D($()),p(xt)),()=>{Z()&&$()&&p(xt)&&pc()}),se(()=>D(ie()),()=>{k(h,ie())}),se(()=>(D(P()),D(Z()),D(E())),()=>{P()&&Z()&&!E()&&fr()}),se(()=>(D($()),D(j())),()=>{var d;$()&&((d=j())==null?void 0:d.autoUpdate)===void 0&&Vi(vi,p(vi).autoUpdate=!0)}),tf();var gc={getFilteredItems:Pn,handleClear:dr,get justValue(){return m()},set justValue(d){m(d),O()},get filter(){return u()},set filter(d){u(d),O()},get getItems(){return g()},set getItems(d){g(d),O()},get id(){return b()},set id(d){b(d),O()},get name(){return _()},set name(d){_(d),O()},get container(){return $()},set container(d){$(d),O()},get input(){return P()},set input(d){P(d),O()},get multiple(){return x()},set multiple(d){x(d),O()},get multiFullItemClearable(){return N()},set multiFullItemClearable(d){N(d),O()},get disabled(){return C()},set disabled(d){C(d),O()},get focused(){return E()},set focused(d){E(d),O()},get value(){return w()},set value(d){w(d),O()},get filterText(){return q()},set filterText(d){q(d),O()},get placeholder(){return J()},set placeholder(d){J(d),O()},get placeholderAlwaysShow(){return ye()},set placeholderAlwaysShow(d){ye(d),O()},get items(){return K()},set items(d){K(d),O()},get label(){return re()},set label(d){re(d),O()},get itemFilter(){return Oe()},set itemFilter(d){Oe(d),O()},get groupBy(){return Te()},set groupBy(d){Te(d),O()},get groupFilter(){return Qe()},set groupFilter(d){Qe(d),O()},get groupHeaderSelectable(){return et()},set groupHeaderSelectable(d){et(d),O()},get itemId(){return W()},set itemId(d){W(d),O()},get loadOptions(){return Fe()},set loadOptions(d){Fe(d),O()},get containerStyles(){return Nt()},set containerStyles(d){Nt(d),O()},get hasError(){return Pr()},set hasError(d){Pr(d),O()},get filterSelectedItems(){return cr()},set filterSelectedItems(d){cr(d),O()},get required(){return wt()},set required(d){wt(d),O()},get closeListOnChange(){return li()},set closeListOnChange(d){li(d),O()},get clearFilterTextOnBlur(){return Jr()},set clearFilterTextOnBlur(d){Jr(d),O()},get createGroupHeaderItem(){return Kr()},set createGroupHeaderItem(d){Kr(d),O()},get searchable(){return Cr()},set searchable(d){Cr(d),O()},get inputStyles(){return Cn()},set inputStyles(d){Cn(d),O()},get clearable(){return kn()},set clearable(d){kn(d),O()},get loading(){return yt()},set loading(d){yt(d),O()},get listOpen(){return Z()},set listOpen(d){Z(d),O()},get debounce(){return ui()},set debounce(d){ui(d),O()},get debounceWait(){return Fn()},set debounceWait(d){Fn(d),O()},get hideEmptyState(){return fi()},set hideEmptyState(d){fi(d),O()},get inputAttributes(){return kr()},set inputAttributes(d){kr(d),O()},get listAutoWidth(){return di()},set listAutoWidth(d){di(d),O()},get showChevron(){return En()},set showChevron(d){En(d),O()},get listOffset(){return hi()},set listOffset(d){hi(d),O()},get hoverItemIndex(){return ie()},set hoverItemIndex(d){ie(d),O()},get floatingConfig(){return j()},set floatingConfig(d){j(d),O()},get class(){return I()},set class(d){I(d),O()},get ariaValues(){return G()},set ariaValues(d){G(d),O()},get ariaListOpen(){return Ne()},set ariaListOpen(d){Ne(d),O()},get ariaFocused(){return Ar()},set ariaFocused(d){Ar(d),O()}};Vl();var Tr=vh();De("click",na,uc),De("keydown",na,Er);let Qs;var eo=U(Tr);{var bc=d=>{var S=ah();let Y;var Se=U(S);{var rt=ae=>{var Re=Ae(),Ht=ke(Re);Ye(Ht,e,"list-prepend",{},null),R(ae,Re)};me(Se,ae=>{ge(()=>r["list-prepend"])&&ae(rt)})}var je=H(Se,2);{var hr=ae=>{var Re=Ae(),Ht=ke(Re);Ye(Ht,e,"list",{get filteredItems(){return p(c)}},null),R(ae,Re)},Nn=ae=>{var Re=Ae(),Ht=ke(Re);{var gi=Nr=>{var Zr=Ae(),pt=ke(Zr);ki(pt,1,()=>p(c),aa,(Ot,nt,$t)=>{var vr=nh(),Qr=U(vr);let Ri;var Ec=U(Qr);Ye(Ec,e,"item",{get item(){return p(nt)},index:$t},St=>{var Ii=Gt();ze(()=>Lr(Ii,(p(nt),D(re()),ge(()=>{var ao;return(ao=p(nt))==null?void 0:ao[re()]})))),R(St,Ii)}),V(Qr),Wi(Qr,(St,Ii)=>Da==null?void 0:Da(St),()=>({scroll:Xs(p(nt),w(),W()),listDom:p(f)})),Wi(Qr,(St,Ii)=>Oa==null?void 0:Oa(St),()=>({scroll:p(h)===$t,listDom:p(f)})),V(vr),ze(St=>Ri=Zt(Qr,1,"item svelte-di53br",null,Ri,St),[()=>{var St;return{"list-group-title":p(nt).groupHeader,active:Xs(p(nt),w(),W()),first:dc($t),hover:ie()===$t,"group-item":p(nt).groupItem,"not-selectable":((St=p(nt))==null?void 0:St.selectable)===!1}}]),De("mouseover",vr,()=>Ks($t)),De("focus",vr,()=>Ks($t)),De("click",vr,On(()=>fc({item:p(nt),i:$t}))),De("keydown",vr,en(On(function(St){zi.call(this,e,St)}))),R(Ot,vr)}),R(Nr,Zr)},za=Nr=>{var Zr=Ae(),pt=ke(Zr);{var Ot=nt=>{var $t=Ae(),vr=ke($t);Ye(vr,e,"empty",{},Qr=>{var Ri=ih();R(Qr,Ri)}),R(nt,$t)};me(pt,nt=>{fi()||nt(Ot)},!0)}R(Nr,Zr)};me(Ht,Nr=>{p(c),ge(()=>p(c).length>0)?Nr(gi):Nr(za,!1)},!0)}R(ae,Re)};me(je,ae=>{ge(()=>r.list)?ae(hr):ae(Nn,!1)})}var mi=H(je,2);{var pr=ae=>{var Re=Ae(),Ht=ke(Re);Ye(Ht,e,"list-append",{},null),R(ae,Re)};me(mi,ae=>{ge(()=>r["list-append"])&&ae(pr)})}V(S),Wi(S,ae=>Ma==null?void 0:Ma(ae)),Ka(S,ae=>k(xt,ae),()=>p(xt)),wr(()=>De("scroll",S,Js)),wr(()=>De("pointerup",S,en(On(function(ae){zi.call(this,e,ae)})))),wr(()=>De("mousedown",S,en(On(function(ae){zi.call(this,e,ae)})))),ze(ae=>Y=Zt(S,1,"svelte-select-list svelte-di53br",null,Y,ae),[()=>({prefloat:p(Ra)})]),R(d,S)};me(eo,d=>{Z()&&d(bc)})}var Ia=H(eo,2),wc=U(Ia);{var yc=d=>{var S=sh(),Y=ke(S),Se=U(Y,!0);V(Y);var rt=H(Y,2),je=U(rt,!0);V(rt),ze(()=>{Lr(Se,p(l)),Lr(je,p(o))}),R(d,S)};me(wc,d=>{E()&&d(yc)})}V(Ia);var Ba=H(Ia,2),_c=U(Ba);Ye(_c,e,"prepend",{},null),V(Ba);var Va=H(Ba,2),to=U(Va);{var xc=d=>{var S=Ae(),Y=ke(S);{var Se=je=>{var hr=Ae(),Nn=ke(hr);ki(Nn,1,w,aa,(mi,pr,ae)=>{var Re=lh();let Ht;var gi=U(Re),za=U(gi);Ye(za,e,"selection",{get selection(){return p(pr)},index:ae},pt=>{var Ot=Gt();ze(()=>Lr(Ot,(p(pr),D(re()),ge(()=>p(pr)[re()])))),R(pt,Ot)}),V(gi);var Nr=H(gi,2);{var Zr=pt=>{var Ot=oh(),nt=U(Ot);Ye(nt,e,"multi-clear-icon",{},$t=>{Qi($t)}),V(Ot),De("pointerup",Ot,en(On(()=>Xr(ae)))),R(pt,Ot)};me(Nr,pt=>{!C()&&!N()&&Qi&&pt(Zr)})}V(Re),ze(pt=>Ht=Zt(Re,1,"multi-item svelte-di53br",null,Ht,pt),[()=>({active:p(M)===ae,disabled:C()})]),De("click",Re,en(()=>N()?Xr(ae):{})),De("keydown",Re,en(On(function(pt){zi.call(this,e,pt)}))),R(mi,Re)}),R(je,hr)},rt=je=>{var hr=ch();let Nn;var mi=U(hr);Ye(mi,e,"selection",{get selection(){return w()}},pr=>{var ae=Gt();ze(()=>Lr(ae,(D(w()),D(re()),ge(()=>w()[re()])))),R(pr,ae)}),V(hr),ze(pr=>Nn=Zt(hr,1,"selected-item svelte-di53br",null,Nn,pr),[()=>({"hide-selected-item":p(i)})]),R(je,hr)};me(Y,je=>{x()?je(Se):je(rt,!1)})}R(d,S)};me(to,d=>{p(n)&&d(xc)})}var Tn=H(to,2);bs(Tn,()=>({readOnly:!Cr(),...p(Le),placeholder:p(s),style:Cn(),disabled:C()}),void 0,void 0,"svelte-di53br",!0),Ka(Tn,d=>P(d),()=>P()),V(Va);var Wa=H(Va,2),ro=U(Wa);{var $c=d=>{var S=uh(),Y=U(S);Ye(Y,e,"loading-icon",{},Se=>{ic(Se)}),V(S),R(d,S)};me(ro,d=>{yt()&&d($c)})}var no=H(ro,2);{var Sc=d=>{var S=fh(),Y=U(S);Ye(Y,e,"clear-icon",{},Se=>{Qi(Se)}),V(S),De("click",S,dr),R(d,S)};me(no,d=>{p(a)&&d(Sc)})}var Pc=H(no,2);{var Cc=d=>{var S=dh(),Y=U(S);Ye(Y,e,"chevron-icon",{get listOpen(){return Z()}},Se=>{nc(Se)}),V(S),R(d,S)};me(Pc,d=>{En()&&d(Cc)})}V(Wa);var io=H(Wa,2);Ye(io,e,"input-hidden",{get value(){return w()}},d=>{var S=hh();sa(S),ze(Y=>{Ur(S,"name",_()),gs(S,Y)},[()=>(D(w()),ge(()=>w()?JSON.stringify(w()):null))]),R(d,S)});var kc=H(io,2);{var Fc=d=>{var S=Ae(),Y=ke(S);Ye(Y,e,"required",{get value(){return w()}},Se=>{var rt=ph();R(Se,rt)}),R(d,S)};me(kc,d=>{D(wt()),D(w()),ge(()=>wt()&&(!w()||w().length===0))&&d(Fc)})}return V(Tr),wr(()=>De("pointerup",Tr,en(jn))),Ka(Tr,d=>$(d),()=>$()),Wi(Tr,d=>La==null?void 0:La(d)),ze(d=>{Qs=Zt(Tr,1,`svelte-select ${I()??""}`,"svelte-di53br",Qs,d),zs(Tr,Nt())},[()=>({multi:x(),disabled:C(),focused:E(),"list-open":Z(),"show-chevron":En(),error:Pr()})]),De("keydown",Tn,Er),De("blur",Tn,jr),De("focus",Tn,fr),Vf(Tn,q),R(t,Tr),$o(e,"getFilteredItems",Pn),$o(e,"handleClear",dr),ft(gc)}Ze(ac,{justValue:{},filter:{},getItems:{},id:{},name:{},container:{},input:{},multiple:{},multiFullItemClearable:{},disabled:{},focused:{},value:{},filterText:{},placeholder:{},placeholderAlwaysShow:{},items:{},label:{},itemFilter:{},groupBy:{},groupFilter:{},groupHeaderSelectable:{},itemId:{},loadOptions:{},containerStyles:{},hasError:{},filterSelectedItems:{},required:{},closeListOnChange:{},clearFilterTextOnBlur:{},createGroupHeaderItem:{},searchable:{},inputStyles:{},clearable:{},loading:{},listOpen:{},debounce:{},debounceWait:{},hideEmptyState:{},inputAttributes:{},listAutoWidth:{},showChevron:{},listOffset:{},hoverItemIndex:{},floatingConfig:{},class:{},ariaValues:{},ariaListOpen:{},ariaFocused:{}},["list-prepend","list","item","empty","list-append","prepend","selection","multi-clear-icon","loading-icon","clear-icon","chevron-icon","input-hidden","required"],["getFilteredItems","handleClear"],!0);function sc(t){const e=t-1;return e*e*e+1}function gh(t,{from:e,to:r},n={}){var{delay:i=0,duration:a=C=>Math.sqrt(C)*120,easing:s=sc}=n,l=getComputedStyle(t),o=l.transform==="none"?"":l.transform,[c,f]=l.transformOrigin.split(" ").map(parseFloat);c/=t.clientWidth,f/=t.clientHeight;var h=bh(t),v=t.clientWidth/r.width/h,m=t.clientHeight/r.height/h,u=e.left+e.width*c,g=e.top+e.height*f,b=r.left+r.width*c,_=r.top+r.height*f,$=(u-b)*v,P=(g-_)*m,x=e.width/r.width,N=e.height/r.height;return{delay:i,duration:typeof a=="function"?a(Math.sqrt($*$+P*P)):a,easing:s,css:(C,E)=>{var w=E*$,q=E*P,J=C+E*x,ye=C+E*N;return`transform: ${o} translate(${w}px, ${q}px) scale(${J}, ${ye});`}}}function bh(t){if("currentCSSZoom"in t)return t.currentCSSZoom;for(var e=t,r=1;e!==null;)r*=+getComputedStyle(e).zoom,e=e.parentElement;return r}var wh=fe('<div class="wa-muted svelte-1yd9ia5" style="margin: 4rem auto 0; font-size: 18px; width: fit-content;">No projects found.</div>'),yh=fe('<div style="margin:20px 0;" class="svelte-1yd9ia5"><label for="wa-project-select" class="svelte-1yd9ia5">Select project</label> <div class="project-select-row svelte-1yd9ia5"><!></div></div>'),_h=fe('<div class="create-inline wa-row svelte-1yd9ia5"><input class="wa-create-draft-input svelte-1yd9ia5" type="text" placeholder="Draft name"/> <!> <!></div>'),xh=fe('<div class="svelte-1yd9ia5">No drafts found.</div>'),$h=fe('<span class="wa-draft-active-indicator svelte-1yd9ia5" title="Active draft">●</span>'),Sh=fe('<div><div class="wa-draft-name wa-row svelte-1yd9ia5"><!> </div> <div class="wa-draft-actions svelte-1yd9ia5"><!> <!> <!> <!> <!></div></div>'),Ph=fe('<div class="wa-draft-list svelte-1yd9ia5"></div>'),Ch=fe('<div class="draft-controls svelte-1yd9ia5" style="margin-top:16px;"><div class="wa-panel-header svelte-1yd9ia5"><div class="wa-row justify-between svelte-1yd9ia5"><div class="wa-button-group svelte-1yd9ia5"><div class="wa-title svelte-1yd9ia5">Drafts</div> <!></div> <div class="wa-button-group svelte-1yd9ia5"><!> <!></div></div></div> <!> <!> <!></div>'),kh=fe('<div class="create-inline wa-row svelte-1yd9ia5"><input class="wa-create-draft-input svelte-1yd9ia5" type="text" placeholder="Chapter name"/> <!> <!></div>'),Fh=fe('<div class="svelte-1yd9ia5">Loading chapters...</div>'),Eh=fe('<div style="margin-top: 1em;" class="svelte-1yd9ia5">No chapters found.</div>'),jh=fe('<div class="wa-draft-item svelte-1yd9ia5"><div class="wa-draft-name svelte-1yd9ia5"> </div> <div class="wa-draft-actions svelte-1yd9ia5"><!> <!> <!> <!> <!></div></div>'),Ah=fe('<div class="wa-draft-list svelte-1yd9ia5"></div>'),Th=fe('<div class="chapter-controls svelte-1yd9ia5" style="margin-top:18px;"><div class="wa-panel-header svelte-1yd9ia5"><div class="wa-row justify-between svelte-1yd9ia5"><div class="wa-title svelte-1yd9ia5">Chapters</div> <div class="wa-button-group svelte-1yd9ia5"><!></div></div></div> <!> <!></div>'),Nh=fe('<div class="project-list wa-panel svelte-1yd9ia5"><div class="wa-row justify-between svelte-1yd9ia5"><div class="wa-title svelte-1yd9ia5"> </div> <div class="svelte-1yd9ia5"><!></div></div> <div class="wa-row svelte-1yd9ia5" style="margin: 18px 0 10px 0;"><!></div> <!> <!> <!> <!></div>');const Dh={hash:"svelte-1yd9ia5",code:`.project-list.svelte-1yd9ia5 {padding:8px;}.project-select-row.svelte-1yd9ia5 {display:flex;gap:8px;align-items:center;}.create-inline.svelte-1yd9ia5 {margin-top:8px;justify-content:center;}.wa-panel.svelte-1yd9ia5 {padding:8px;height:100%;border-radius:0;}.wa-panel-header.svelte-1yd9ia5 {display:flex;flex-direction:column;}.wa-draft-item.active.svelte-1yd9ia5 .wa-draft-name:where(.svelte-1yd9ia5) {font-weight:bold;color:var(--color-accent, #3b82f6);}.wa-draft-active-indicator.svelte-1yd9ia5 {color:var(--color-accent, #3b82f6);font-size:1em;vertical-align:middle;}
  @keyframes svelte-1yd9ia5-spin {
    100% {
      transform: rotate(360deg);
    }
  }`};function _i(t,e){var ie;ut(e,!1),si(t,Dh);let r=L(e,"projectFileService",12),n=L(e,"projectService",12),i=L(e,"manager",12),a=L(e,"activeProject",12,null),s=te([]),l=te(void 0),o=te(null),c=te([]),f=te(!1),h=te([]),v=!1,m=te(!1),u=te(!1),g=te(""),b="",_=te(!0),$=te(((ie=i())==null?void 0:ie.activeDraft)??null),P=null;const x=20;let N=te([]),C=te(!1),E=te(!1),w=te(""),q=te(""),J=te(!1);async function ye(j=!1){k(f,!0);const I=new Promise(ne=>setTimeout(ne,400)),M=[...p(s)],he=a();let _e=[],oe=[];try{_e=n().listAllFolders(),oe=[];for(const ne of _e)await n().isProjectFolder(ne)&&oe.push(ne)}catch{oe=[]}const tt=oe.filter(ne=>!M.includes(ne)),Le=M.filter(ne=>!oe.includes(ne));if(j&&tt.length>0&&new y.Notice(`${tt.length} new project${tt.length>1?"s":""} discovered.`),j&&Le.length>0&&new y.Notice(`${Le.length} project${Le.length>1?"s":""} removed.`),k(s,oe),k(h,oe.map(ne=>({value:ne,label:ne}))),oe.length===0)a(null),k(l,void 0),k(o,null);else if(oe.length===1){a(oe[0]),k(l,p(h)[0]),k(o,oe[0]);try{T(`${A} panel refresh selected single project '${p(o)}'`)}catch{}}else if(he&&!oe.includes(he)){a(oe[0]),k(l,p(h)[0]),k(o,oe[0]);try{T(`${A} panel refresh selected fallback project '${p(o)}'`)}catch{}}else{const ne=p(h).find(dt=>dt.value===he);if(ne){a(he),k(l,ne),k(o,ne.value);try{T(`${A} panel refresh kept project '${p(o)}'`)}catch{}}else a(null),k(l,void 0),k(o,null)}return await I,k(f,!1),p(o)&&await K(),oe}async function K(){k(m,!0);const j=new Promise(I=>setTimeout(I,400));try{if(!p(o)){k(c,[]);return}k(c,r().drafts.listDrafts(p(o))||[]),k(c,Array.from(p(c))),p(c).sort((I,M)=>I>M?1:I<M?-1:0),p(_)||p(c).reverse()}catch{k(c,[])}finally{await j,k(m,!1)}}async function re(){var I;k(C,!0);const j=new Promise(M=>setTimeout(M,400));try{if(!p(o)){k(N,[]),k(J,!1);return}const M=`${p(o)}/meta.md`,he=await bn(i().app,M);if(k(J,(he==null?void 0:he.project_type)==="multi-file"),!p(J)){k(N,[]);return}if(!((I=i())!=null&&I.activeDraft)){k(N,[]);return}let _e=[];_e=await r().chapters.listChapters(p(o),i().activeDraft),k(N,Array.isArray(_e)?_e:[])}catch{k(N,[]),k(J,!1)}finally{await j,k(C,!1)}}async function Oe(){if(!(!p(o)||!p(g).trim())){try{await r().drafts.createDraft(p(g).trim(),b||void 0,p(o))}catch{}k(g,""),k(u,!1),await K()}}async function Te(){k(u,!0)}async function Qe(j){var M;if(!p(o))return;let I=!1;I=await r().drafts.openDraft(p(o),j),I||(M=i())!=null&&M.setActiveDraft&&await i().setActiveDraft(j,p(o)),await K(),await re()}async function et(j){if(!p(o))return;const I=`${j} Copy`;new Xf(i().app,{sourceDraftName:j,suggestedName:I,onSubmit:async M=>{try{await i().createNewDraft(M,j,p(o)||void 0),await K(),new y.Notice(`Draft '${M}' created as duplicate of '${j}'.`)}catch(he){console.error("Failed to duplicate draft:",he),new y.Notice("Failed to duplicate draft.")}}}).open()}async function W(j){const I=window!=null&&window.prompt?window.prompt(`Rename draft '${j}' to:`,j):null;if(!(!I||!p(o)))try{await i().renameDraft(j,I,p(o),!1),await K()}catch{}}async function Fe(j){if(!p(o))return;new Co(i().app,j,async()=>{await i().deleteDraft(j,p(o)||void 0),await K()},"draft").open()}async function Nt(j){var I,M;j&&((I=i())!=null&&I.setActiveProject&&await i().setActiveProject(j),a(j),k(o,j),k($,((M=i())==null?void 0:M.activeDraft)??null),await K(),await re())}async function Pr(j){var I;if(!(!j||!i()))try{i().activeProject!==j&&typeof i().setActiveProject=="function"&&await i().setActiveProject(j),a(j),k(o,j),k($,((I=i())==null?void 0:I.activeDraft)??null),await K(),await re()}catch{}}async function cr(j){var I,M;p(o)&&((I=i())!=null&&I.setActiveDraft&&await i().setActiveDraft(j,p(o)),k($,((M=i())==null?void 0:M.activeDraft)??null),await K(),await re())}let wt=null;Vs(async()=>{await ye(!1),p(o)&&await Nt(p(o)),setTimeout(async()=>{try{p(o)&&i()&&i().activeProject!==p(o)&&await Pr(p(o))}catch{}},200);try{i()&&typeof i().addActiveDraftListener=="function"&&(wt=j=>{k($,j),K().catch(()=>{}),re().catch(()=>{})},i().addActiveDraftListener(wt),k($,i().activeDraft??null))}catch{}try{i()&&typeof i().addActiveProjectListener=="function"&&(P=j=>{a(j),k(o,j),ye().catch(()=>{}),K().catch(()=>{}),k(l,p(h).find(I=>I.value===j)||void 0)},i().addActiveProjectListener(P),a(i().activeProject??null),k(o,a()),K().catch(()=>{}),k(l,p(h).find(j=>j.value===a())||void 0),re().catch(()=>{}))}catch{}}),Ws(()=>{try{i()&&typeof i().removeActiveDraftListener=="function"&&wt&&i().removeActiveDraftListener(wt)}catch{}try{i()&&typeof i().removeActiveProjectListener=="function"&&P&&i().removeActiveProjectListener(P)}catch{}});var li={get projectFileService(){return r()},set projectFileService(j){r(j),O()},get projectService(){return n()},set projectService(j){n(j),O()},get manager(){return i()},set manager(j){i(j),O()},get activeProject(){return a()},set activeProject(j){a(j),O()}};Vl();var Jr=Nh(),Kr=U(Jr),Pn=U(Kr),Cr=U(Pn);V(Pn);var Cn=H(Pn,2),kn=U(Cn);Pt(kn,{ariaLabel:"Refresh projects",onclick:()=>ye(!0),title:void 0,get spinning(){return p(f)},children:(j,I)=>{$s(j,{})},$$slots:{default:!0}}),V(Cn),V(Kr);var yt=H(Kr,2),Z=U(yt);Ut(Z,{onclick:async()=>{const j=i().app,{CreateProjectModal:I}=await Promise.resolve().then(()=>Bh);let M=null;new I(j,async(_e,oe,tt)=>{if(!_e||(M=await n().createProject(_e,oe,tt,void 0,i().settings),!M))return;let Le=[],ne=null;for(let dt=0;dt<20;dt++){await new Promise(Ee=>setTimeout(Ee,100)),Le=await ye();const ur=Le.find(Ee=>Ee===M);if(ne=typeof ur=="string"?ur:null,ne)break}typeof ne=="string"&&ne&&(a(ne),k(l,{value:ne,label:ne}),k(o,ne),i().setActiveDraft?await i().setActiveDraft(ne,tt):i(i().activeDraft=tt??null,!0),await K(),await re())}).open()},variant:"primary",style:"width: 40%; margin: 0 auto;",children:(j,I)=>{Or();var M=Gt("New Project");R(j,M)},$$slots:{default:!0}}),V(yt);var ci=H(yt,2);{var ui=j=>{var I=wh();R(j,I)};me(ci,j=>{p(s),ge(()=>p(s).length===0)&&j(ui)})}var Fn=H(ci,2);{var fi=j=>{var I=yh(),M=H(U(I),2),he=U(M);ac(he,{name:"wa-project-select",class:"wa-select",get items(){return p(h)},showChevron:!0,disabled:v,clearable:!1,searchable:!1,placeholder:"Choose a project...",containerStyles:"background: var(--select-bg); color: var(--select-text); border: 1px solid var(--select-border); border-radius: none; min-height: 38px; box-shadow: none; font-size: 1em; transition: border 0.2s;",get value(){return p(l)},set value(_e){k(l,_e)},$$events:{select:_e=>{const oe=_e.detail;k(l,oe),k(o,typeof oe=="string"?oe:oe?oe.value:void 0),a(p(o)??null),Nt(p(o)??null)}},$$legacy:!0}),V(M),V(I),R(j,I)};me(Fn,j=>{p(s),ge(()=>p(s).length>0)&&j(fi)})}var kr=H(Fn,2);{var di=j=>{var I=Ch(),M=U(I),he=U(M),_e=U(he),oe=H(U(_e),2);Pt(oe,{ariaLabel:"Toggle draft sort order",title:void 0,onclick:()=>{k(_,!p(_)),K()},children:(Pe,le)=>{var xe=Ae(),$e=ke(xe);{var Me=Ce=>{ys(Ce,{})},pe=Ce=>{ws(Ce,{})};me($e,Ce=>{p(_)?Ce(Me):Ce(pe,!1)})}R(Pe,xe)},$$slots:{default:!0}}),V(_e);var tt=H(_e,2),Le=U(tt);Ut(Le,{onclick:Te,variant:"primary",children:(Pe,le)=>{Or();var xe=Gt("New Draft");R(Pe,xe)},$$slots:{default:!0}});var ne=H(Le,2);Pt(ne,{ariaLabel:"Refresh drafts",title:void 0,onclick:K,get disabled(){return p(m)},get spinning(){return p(m)},children:(Pe,le)=>{$s(Pe,{})},$$slots:{default:!0}}),V(tt),V(he),V(M);var dt=H(M,2);{var ur=Pe=>{var le=_h(),xe=U(le);sa(xe);var $e=H(xe,2);Ut($e,{onclick:Oe,variant:"primary",children:(pe,Ce)=>{Or();var Dt=Gt("Create");R(pe,Dt)},$$slots:{default:!0}});var Me=H($e,2);Ut(Me,{onclick:()=>{k(u,!1),k(g,"")},children:(pe,Ce)=>{Or();var Dt=Gt("Cancel");R(pe,Dt)},$$slots:{default:!0}}),V(le),ze(()=>gs(xe,p(g))),De("input",xe,pe=>{const Ce=pe.target;Ce&&k(g,Ce.value)}),R(Pe,le)};me(dt,Pe=>{p(u)&&Pe(ur)})}var Ee=H(dt,2);{var ht=Pe=>{var le=xh();R(Pe,le)};me(Ee,Pe=>{p(c),ge(()=>p(c).length===0)&&Pe(ht)})}var _t=H(Ee,2);{var Fr=Pe=>{var le=Ph();ki(le,5,()=>p(c),aa,(xe,$e)=>{var Me=Sh(),pe=U(Me),Ce=U(pe);{var Dt=G=>{var Ne=$h();R(G,Ne)};me(Ce,G=>{p($)===p($e)&&G(Dt)})}var Xr=H(Ce);V(pe);var Er=H(pe,2),fr=U(Er);Pt(fr,{ariaLabel:"Open draft",title:void 0,onclick:()=>Qe(p($e)),children:(G,Ne)=>{_s(G,{size:x})},$$slots:{default:!0}});var jr=H(fr,2);{var jn=G=>{Pt(G,{ariaLabel:"Set active draft",title:void 0,onclick:()=>cr(p($e)),children:(Ne,Ar)=>{zl(Ne,{size:x})},$$slots:{default:!0}})};me(jr,G=>{p($)!==p($e)&&G(jn)})}var dr=H(jr,2);Pt(dr,{ariaLabel:"Rename draft",title:void 0,onclick:()=>W(p($e)),children:(G,Ne)=>{xs(G,{size:x})},$$slots:{default:!0}});var An=H(dr,2);Pt(An,{ariaLabel:"Duplicate draft",title:void 0,onclick:()=>et(p($e)),children:(G,Ne)=>{Hl(G,{size:x})},$$slots:{default:!0}});var be=H(An,2);Pt(be,{ariaLabel:"Delete draft",title:void 0,onclick:()=>Fe(p($e)),children:(G,Ne)=>{Ss(G,{size:x})},$$slots:{default:!0}}),V(Er),V(Me),ze(()=>{Zt(Me,1,`wa-draft-item ${p($)===p($e)?"active":""}`,"svelte-1yd9ia5"),Lr(Xr,` ${p($e)??""}`)}),R(xe,Me)}),V(le),R(Pe,le)};me(_t,Pe=>{p(c),ge(()=>p(c).length>0)&&Pe(Fr)})}V(I),R(j,I)};me(kr,j=>{p(o)&&j(di)})}var En=H(kr,2);{var hi=j=>{var I=Th(),M=U(I),he=U(M),_e=H(U(he),2),oe=U(_e);Ut(oe,{onclick:()=>k(E,!p(E)),variant:"primary",children:(Ee,ht)=>{Or();var _t=Gt("New Chapter");R(Ee,_t)},$$slots:{default:!0}}),V(_e),V(he),V(M);var tt=H(M,2);{var Le=Ee=>{var ht=kh(),_t=U(ht);sa(_t);var Fr=H(_t,2);Ut(Fr,{onclick:async()=>{var le;!p(o)||!((le=i())!=null&&le.activeDraft)||!p(w).trim()||(await i().createChapter(p(o),i().activeDraft,p(w).trim()),k(w,""),k(q,""),k(E,!1),await re())},variant:"primary",children:(le,xe)=>{Or();var $e=Gt("Create");R(le,$e)},$$slots:{default:!0}});var Pe=H(Fr,2);Ut(Pe,{onclick:()=>{k(E,!1),k(w,""),k(q,"")},children:(le,xe)=>{Or();var $e=Gt("Cancel");R(le,$e)},$$slots:{default:!0}}),V(ht),ze(()=>gs(_t,p(w))),De("input",_t,le=>{const xe=le.target;xe&&k(w,xe.value)}),R(Ee,ht)};me(tt,Ee=>{p(E)&&Ee(Le)})}var ne=H(tt,2);{var dt=Ee=>{var ht=Fh();R(Ee,ht)},ur=Ee=>{var ht=Ae(),_t=ke(ht);{var Fr=le=>{var xe=Eh();R(le,xe)},Pe=le=>{var xe=Ah();ki(xe,15,()=>p(N),$e=>$e.chapterName,($e,Me,pe)=>{var Ce=jh(),Dt=U(Ce),Xr=U(Dt,!0);V(Dt);var Er=H(Dt,2),fr=U(Er);{let be=Pi(()=>p(pe)===0);Ut(fr,{title:"Move chapter up",onclick:async()=>{if(p(pe)===0)return;const G=p(N).slice();[G[p(pe)-1],G[p(pe)]]=[G[p(pe)],G[p(pe)-1]];const Ne=G.map((Ar,pi)=>({chapterName:Ar.chapterName,order:pi+1}));await i().reorderChapters(p(o),i().activeDraft,Ne),await re()},get disabled(){return p(be)},children:(G,Ne)=>{ys(G,{})},$$slots:{default:!0}})}var jr=H(fr,2);{let be=Pi(()=>(D(p(pe)),p(N),ge(()=>p(pe)===p(N).length-1)));Ut(jr,{title:"Move chapter down",onclick:async()=>{if(p(pe)===p(N).length-1)return;const G=p(N).slice();[G[p(pe)],G[p(pe)+1]]=[G[p(pe)+1],G[p(pe)]];const Ne=G.map((Ar,pi)=>({chapterName:Ar.chapterName,order:pi+1}));await i().reorderChapters(p(o),i().activeDraft,Ne),await re()},get disabled(){return p(be)},children:(G,Ne)=>{ws(G,{})},$$slots:{default:!0}})}var jn=H(jr,2);Pt(jn,{ariaLabel:"Open chapter",title:"Open chapter",onclick:async()=>{var be;!p(o)||!((be=i())!=null&&be.activeDraft)||await i().openChapter(p(o),i().activeDraft,p(Me).chapterName)},children:(be,G)=>{_s(be,{size:x})},$$slots:{default:!0}});var dr=H(jn,2);Pt(dr,{ariaLabel:"Rename chapter",title:"Rename chapter",onclick:()=>{var G;if(!p(o)||!((G=i())!=null&&G.activeDraft))return;new Zf(i().app,p(Me).chapterName,async Ne=>{await i().renameChapter(p(o),i().activeDraft,p(Me).chapterName,Ne),await re()}).open()},children:(be,G)=>{xs(be,{size:x})},$$slots:{default:!0}});var An=H(dr,2);Pt(An,{ariaLabel:"Delete chapter",title:"Delete chapter",onclick:async()=>{var G;if(!p(o)||!((G=i())!=null&&G.activeDraft))return;new Co(i().app,p(Me).chapterName,async()=>{await i().deleteChapter(p(o),i().activeDraft,p(Me).chapterName),await re()},"chapter").open()},children:(be,G)=>{Ss(be,{size:x})},$$slots:{default:!0}}),V(Er),V(Ce),ze(()=>Lr(Xr,(p(Me),ge(()=>p(Me).chapterName)))),Bf(Ce,()=>gh,()=>({duration:500,easing:sc})),R($e,Ce)}),V(xe),R(le,xe)};me(_t,le=>{p(N),ge(()=>p(N).length===0)?le(Fr):le(Pe,!1)},!0)}R(Ee,ht)};me(ne,Ee=>{p(C)?Ee(dt):Ee(ur,!1)})}V(I),R(j,I)};me(En,j=>{p(o),D(i()),p(J),ge(()=>{var I;return p(o)&&((I=i())==null?void 0:I.activeDraft)&&p(J)})&&j(hi)})}return V(Jr),ze(()=>Lr(Cr,`${ue} Projects`)),R(t,Jr),ft(li)}Ze(_i,{projectFileService:{},projectService:{},manager:{},activeProject:{}},[],[],!0);const Mr="writeaid-project-panel";class Oh extends y.ItemView{constructor(e,r){super(e),this.containerElInner=null,this.selectedProject=null,this.svelteComponent=null,this.app=r,this.projectService=new Es(r),this.projectFileService=new Fs(r,this.projectService)}getViewType(){return Mr}getDisplayText(){return`${ue} Projects`}getIcon(){return Bo}async onOpen(){var e,r,n,i,a,s,l,o;this.containerElInner=this.containerEl.createDiv({cls:"writeaid-project-panel"});try{const c=(_i==null?void 0:_i.default)??_i;if(!c){new y.Notice(`${ue}: failed to load project panel component.`);return}const f=(n=(r=(e=this.app.plugins).getPlugin)==null?void 0:r.call(e,"obsidian-writeaid-plugin"))==null?void 0:n.manager;if(!f){new y.Notice(`${ue}: manager not available, cannot mount project panel.`);return}const h={app:this.app,manager:f,projectService:this.projectService,projectFileService:this.projectFileService};let v=!1;if(typeof c=="function"&&c.prototype instanceof HTMLElement)try{const u=new c;de(()=>{u.projectService=this.projectService}),de(()=>{var g,b,_;u.manager=(_=(b=(g=this.app.plugins).getPlugin)==null?void 0:b.call(g,"obsidian-writeaid-plugin"))==null?void 0:_.manager}),de(()=>{u.draftService=this.projectFileService.drafts}),de(()=>{var g,b,_,$;u.activeProject=(($=(_=(b=(g=this.app.plugins).getPlugin)==null?void 0:b.call(g,"obsidian-writeaid-plugin"))==null?void 0:_.manager)==null?void 0:$.activeProject)??null}),this.svelteComponent=u,v=!0}catch(u){console.warn(`${ue}: creating custom element instance failed:`,u)}if(!v&&typeof customElements<"u")try{const u="wa-project-panel";if(customElements.get(u)){const g=document.createElement(u);de(()=>{g.projectService=this.projectService}),de(()=>{var b,_,$;g.manager=($=(_=(b=this.app.plugins).getPlugin)==null?void 0:_.call(b,"obsidian-writeaid-plugin"))==null?void 0:$.manager}),de(()=>{g.draftService=this.projectFileService.drafts}),de(()=>{var b,_,$,P;g.activeProject=((P=($=(_=(b=this.app.plugins).getPlugin)==null?void 0:_.call(b,"obsidian-writeaid-plugin"))==null?void 0:$.manager)==null?void 0:P.activeProject)??null}),this.svelteComponent=g,v=!0}}catch(u){console.warn(`${ue}: attempting to create by tag failed:`,u)}if(!v)try{this.svelteComponent=Bs(c,{target:this.containerElInner,props:h}),v=!0}catch(u){console.warn(`${ue}: svelte.mount failed; trying constructor:`,u);try{this.svelteComponent=new c({target:this.containerElInner,props:h}),v=!0}catch(g){console.error(`${ue}: failed to mount ProjectPanel (mount + constructor failed)`,g),de(()=>{console.error(`${ue}: component snapshot:`,c)}),new y.Notice(`${ue}: error mounting project panel component. See console.`);return}}this.svelteComponent&&(typeof this.svelteComponent.destroy=="function"&&(this.svelteComponent.$destroy=(i=this.svelteComponent.destroy)==null?void 0:i.bind(this.svelteComponent)),typeof this.svelteComponent.set=="function"&&(this.svelteComponent.$set=(a=this.svelteComponent.set)==null?void 0:a.bind(this.svelteComponent)));try{const u=(l=(s=this.app.plugins)==null?void 0:s.getPlugin)==null?void 0:l.call(s,"obsidian-writeaid-plugin"),g=((o=u==null?void 0:u.manager)==null?void 0:o.activeProject)??null;g!==null&&this.svelteComponent&&(typeof this.svelteComponent.$set=="function"?de(()=>{this.svelteComponent.$set({activeProject:g})}):this.svelteComponent instanceof HTMLElement?de(()=>{this.svelteComponent.activeProject=g}):typeof this.svelteComponent.set=="function"&&de(()=>{this.svelteComponent.set({activeProject:g})}),typeof this.svelteComponent.setActiveProject=="function"&&de(()=>{this.svelteComponent.setActiveProject(g)}))}catch{}de(()=>{this.svelteComponent&&typeof this.svelteComponent.refreshPanel=="function"&&this.svelteComponent.refreshPanel()}),setTimeout(()=>{de(()=>{var b,_,$;const u=(_=(b=this.app.plugins)==null?void 0:b.getPlugin)==null?void 0:_.call(b,"obsidian-writeaid-plugin"),g=(($=u==null?void 0:u.manager)==null?void 0:$.activeProject)??null;g&&this.svelteComponent&&(typeof this.svelteComponent.$set=="function"?this.svelteComponent.$set({activeProject:g}):this.svelteComponent instanceof HTMLElement?this.svelteComponent.activeProject=g:typeof this.svelteComponent.set=="function"&&this.svelteComponent.set({activeProject:g}),typeof this.svelteComponent.setActiveProject=="function"&&this.svelteComponent.setActiveProject(g))})},0),de(()=>{var g,b;const u=(b=(g=this.app.plugins)==null?void 0:g.getPlugin)==null?void 0:b.call(g,"obsidian-writeaid-plugin");u&&u.manager&&typeof u.manager.addActiveProjectListener=="function"&&u.manager.addActiveProjectListener(this.onActiveProjectChanged.bind(this))})}catch{}}onActiveProjectChanged(){}}function Lh(t,e){return()=>{const r={type:Mr,active:!0},n=e.workspace.getLeavesOfType(Mr);if(n.length>0){const i=n[0];e.workspace.revealLeaf(i)}else{let i=e.workspace.getRightLeaf(!1);i||(i=e.workspace.getRightLeaf(!0)),i.setViewState(r),e.workspace.revealLeaf(i)}}}function Mh(t){return()=>t.updateProjectMetadataPrompt()}class Rh extends y.Modal{constructor(e,r,n,i){super(e),this.path=r,this.onCreateAnyway=n,this.onOpenExisting=i}onOpen(){const{contentEl:e}=this;e.createEl("h2",{text:"Project already exists"}),e.createEl("p",{text:`A folder named '${this.path}' already exists in the vault.`}),new y.Setting(e).addButton(r=>r.setButtonText("Open Existing").onClick(()=>{this.close(),this.onOpenExisting()})),new y.Setting(e).addButton(r=>r.setButtonText("Create Anyway").setCta().onClick(()=>{this.close(),this.onCreateAnyway(!0)})),new y.Setting(e).addButton(r=>r.setButtonText("Cancel").onClick(()=>{this.close()}))}onClose(){this.contentEl.empty()}}class Ih extends y.Modal{constructor(e,r){super(e),this.props=r}onOpen(){const{contentEl:e}=this;e.createEl("h2",{text:"Create New Draft"});const r=this.props.suggestedName;let n="",i="";new y.Setting(e).setName("Draft name").addText(s=>s.setPlaceholder(r).onChange(l=>n=l));const a=this.props.drafts;a.length>0&&new y.Setting(e).setName("Copy from existing draft").addDropdown(s=>{s.addOption("","Start blank");for(const l of a)s.addOption(l,l);s.onChange(l=>i=l)}),new y.Setting(e).addButton(s=>s.setButtonText("Create").setCta().onClick(()=>{this.close();const l=n&&n.trim()?n.trim():r;this.props.onSubmit(l,i||void 0)}))}onClose(){this.contentEl.empty()}}class oc extends y.Modal{constructor(e,r){super(e),this.onSubmit=r}onOpen(){const{contentEl:e}=this;e.createEl("h2",{text:"Create New Project"});let r="",n=!0,i="Draft 1";new y.Setting(e).setName("Project folder name").addText(a=>a.onChange(s=>r=s)),new y.Setting(e).setName("Project type").addDropdown(a=>{a.addOption("single","Single-file project"),a.addOption("multi","Multi-file project (chapters)"),a.onChange(s=>n=s==="single")}),new y.Setting(e).setName("Initial draft name (optional)").addText(a=>a.setPlaceholder("Draft 1").onChange(s=>i=s||"Draft 1")),new y.Setting(e).addButton(a=>a.setButtonText("Create Project").setCta().onClick(()=>{this.close(),this.onSubmit(r,n,i||void 0)}))}onClose(){this.contentEl.empty()}}const Bh=Object.freeze(Object.defineProperty({__proto__:null,CreateProjectModal:oc},Symbol.toStringTag,{value:"Module"}));class Oo extends y.Modal{constructor(e,r,n){super(e),this.projectPath=r,this.onOpenProject=n}onOpen(){const{contentEl:e}=this;e.createEl("h2",{text:"Project created"}),e.createEl("p",{text:`Project '${this.projectPath}' was created.`}),new y.Setting(e).addButton(r=>r.setButtonText("Open Project").setCta().onClick(async()=>{this.close(),this.onOpenProject&&await this.onOpenProject()})),new y.Setting(e).addButton(r=>r.setButtonText("Close").onClick(()=>this.close()))}onClose(){this.contentEl.empty()}}class Za extends y.Modal{constructor(e,r){super(e),this.props=r}onOpen(){const{contentEl:e}=this;e.createEl("h2",{text:"Select Project for Draft"});let r="";const n=this.props.folders||[];new y.Setting(e).setName("Project folder").addDropdown(i=>{i.addOption("","(Vault root)");for(const a of n)i.addOption(a,a||"(Vault root)");i.onChange(a=>r=a)}),new y.Setting(e).addButton(i=>i.setButtonText("Select").setCta().onClick(()=>{this.close(),this.props.onSubmit(r||"")}))}onClose(){this.contentEl.empty()}}class Vh extends y.Modal{constructor(e,r,n){super(e),this.drafts=r,this.onSubmit=n}onOpen(){const{contentEl:e}=this;e.createEl("h2",{text:"Switch Active Draft"});for(const r of this.drafts)new y.Setting(e).setName(r).addButton(n=>n.setButtonText("Select").onClick(()=>{this.close(),this.onSubmit(r)}))}onClose(){this.contentEl.empty()}}class Wh{constructor(e,r,n){var i;this.activeDraft=null,this.activeProject=null,this.activeProjectListeners=[],this.activeDraftListeners=[],this.panelRefreshListeners=[],this._panelRefreshTimer=null,this._panelRefreshDebounceMs=250,this.app=e,this.plugin=r,this.settings=r==null?void 0:r.settings,typeof n=="number"&&Number.isFinite(n)&&(this._panelRefreshDebounceMs=Math.max(0,Math.floor(n))),this.activeProject=((i=this.settings)==null?void 0:i.activeProject)||null,this.projectService=new Es(e),this.projectFileService=new Fs(e,this.projectService)}async reorderChapters(e,r,n){return await this.projectFileService.chapters.reorderChapters(e,r,n)}async listChapters(e,r){return await this.projectFileService.chapters.listChapters(e,r)}async createChapter(e,r,n){return await this.projectFileService.chapters.createChapter(e,r,n,this.settings)}async deleteChapter(e,r,n){return await this.projectFileService.chapters.deleteChapter(e,r,n)}async renameChapter(e,r,n,i){return await this.projectFileService.chapters.renameChapter(e,r,n,i)}async openChapter(e,r,n){return await this.projectFileService.chapters.openChapter(e,r,n)}get panelRefreshDebounceMs(){return this._panelRefreshDebounceMs}set panelRefreshDebounceMs(e){typeof e=="number"&&Number.isFinite(e)&&(this._panelRefreshDebounceMs=Math.max(0,Math.floor(e)))}addActiveProjectListener(e){this.activeProjectListeners.push(e)}addActiveDraftListener(e){this.activeDraftListeners.push(e)}removeActiveDraftListener(e){this.activeDraftListeners=this.activeDraftListeners.filter(r=>r!==e)}notifyActiveDraftListeners(e){for(const r of this.activeDraftListeners)de(()=>r(e))}addPanelRefreshListener(e){this.panelRefreshListeners.push(e)}removePanelRefreshListener(e){this.panelRefreshListeners=this.panelRefreshListeners.filter(r=>r!==e)}notifyPanelRefresh(){try{this._panelRefreshTimer&&clearTimeout(this._panelRefreshTimer),this._panelRefreshTimer=setTimeout(()=>{for(const e of this.panelRefreshListeners)de(()=>e());this._panelRefreshTimer=null},this._panelRefreshDebounceMs)}catch{for(const e of this.panelRefreshListeners)de(()=>e())}}removeActiveProjectListener(e){this.activeProjectListeners=this.activeProjectListeners.filter(r=>r!==e)}async setActiveProject(e){e&&(e=e.trim().replace(/^\/+/,"").replace(/\/+$/,"")),T(`${A} setActiveProject called with '${e}'`),this.activeProject=e,await He(async()=>{if(this.plugin){const r=this.plugin;r.settings||(r.settings={}),r.settings.activeProject=e??void 0,typeof r.saveSettings=="function"&&await r.saveSettings()}});for(const r of this.activeProjectListeners)de(()=>r(e));try{if(!e){this.activeDraft=null,this.notifyActiveDraftListeners(null);return}const r=this.listDrafts(e);if(!r||r.length===0){this.activeDraft=null;return}if(r.length===1){await this.setActiveDraft(r[0],e,!1),T(`${A} auto-selected single draft '${r[0]}' for project '${e}'`);return}await He(async()=>{const s=await bn(this.app,`${e}/meta.md`);if(s&&s.current_active_draft&&r.includes(s.current_active_draft)){await this.setActiveDraft(s.current_active_draft,e,!1),T(`${A} auto-selected meta draft '${s.current_active_draft}' for project '${e}'`);return}});let n=null,i=0;const a=this.app.vault.getFiles();for(const s of r){const l=`${e}/${Mt.DRAFTS}/${s}/`;let o=0;for(const c of a)if(c.path.startsWith(l)){const f=c.stat&&typeof c.stat.mtime=="number"?c.stat.mtime:0;f>o&&(o=f)}o>i&&(i=o,n=s)}n||(n=r[0]),T(`${A} auto-selected draft '${n}' for project '${e}'`),await this.setActiveDraft(n,e,!1)}catch{}}async createNewProjectPrompt(){new oc(this.app,async(e,r,n,i)=>{if(!e){new y.Notice("Project name is required.");return}const a=i&&i!==""?`${i}/${e}`:e;this.app.vault.getAbstractFileByPath(a)?new Rh(this.app,a,async l=>{l&&(await this.createNewProject(e,r,n,i),new Oo(this.app,a,async()=>await this.openProject(a)).open())},async()=>{await this.openProject(a)}).open():(await this.createNewProject(e,r,n,i),new Oo(this.app,a,async()=>await this.openProject(a)).open())}).open()}async openProject(e){return await this.projectService.openProject(e)}async createNewProject(e,r,n,i){const a=await this.projectService.createProject(e,r,n,i,this.settings);if(a){await this.setActiveProject(a);const s=n||"Draft 1";await this.setActiveDraft(s,a),de(()=>this.notifyPanelRefresh())}return a}listAllFolders(){return this.projectService.listAllFolders()}async createNewDraftPrompt(){const e=this.listAllFolders(),r=await Vn(e,n=>this.projectService.isProjectFolder(n));new Za(this.app,{folders:r,onSubmit:async n=>{const i=await this.suggestNextDraftName(n);new Ih(this.app,{suggestedName:i,drafts:this.listDrafts(n),projectPath:n,onSubmit:async(a,s)=>{await this.projectFileService.drafts.createDraft(a,s,n,this.settings),new y.Notice(`Draft "${a}" created in ${n}.`)}}).open()}}).open()}async switchDraftPrompt(){const e=this.listDrafts();if(e.length===0){new y.Notice("No drafts found in the current project.");return}new Vh(this.app,e,async r=>{this.activeDraft=r,new y.Notice(`Switched to draft: ${r}`);const n=this.getCurrentProjectPath();n&&await Rn(this.app,n,r)}).open()}async updateProjectMetadataPrompt(){if(this.activeProject){await Rn(this.app,this.activeProject),new y.Notice(`Metadata updated for ${this.activeProject}`);return}(async()=>{const e=this.listAllFolders(),r=await Vn(e,n=>this.projectService.isProjectFolder(n));new Za(this.app,{folders:r,onSubmit:async n=>{await Rn(this.app,n),new y.Notice(`Metadata updated for ${n}`)}}).open()})()}async selectActiveProjectPrompt(){const e=this.listAllFolders(),r=await Vn(e,n=>this.projectService.isProjectFolder(n));if(r.length===0){new y.Notice(`No ${ue} projects found in the vault.`);return}new Za(this.app,{folders:r,onSubmit:async n=>{await this.setActiveProject(n),new y.Notice(`Active project set to ${n}`)}}).open()}async createNewDraft(e,r,n){const i=await this.projectFileService.drafts.createDraft(e,r,n,this.settings);return de(()=>this.notifyPanelRefresh()),i}listDrafts(e){return this.projectFileService.drafts.listDrafts(e)}async setActiveDraft(e,r,n=!0){const i=r||this.activeProject||this.getCurrentProjectPath();return i?(this.activeDraft=e,await He(async()=>{await Rn(this.app,i,e)}),this.notifyActiveDraftListeners(this.activeDraft),n&&new y.Notice(`Active draft set to ${e}`),!0):(n&&new y.Notice("No project selected to set active draft on."),!1)}async renameDraft(e,r,n,i=!1){const a=n||this.activeProject||this.getCurrentProjectPath();if(!a)return new y.Notice("No project selected to rename draft."),!1;const s=this.activeDraft===e;return await this.projectFileService.drafts.renameDraft(a,e,r,i,this.settings)?(s&&(this.activeDraft=r),new y.Notice(`Renamed draft ${e} → ${r}`),!0):(new y.Notice("Failed to rename draft."),!1)}async deleteDraft(e,r,n=!0){const i=r||this.activeProject||this.getCurrentProjectPath();if(!i)return new y.Notice("No project selected to delete draft."),!1;if(await this.projectFileService.drafts.deleteDraft(i,e,n)){new y.Notice(`Deleted draft ${e}`);const s=this.listDrafts(i);if(s.length>0){if(this.activeDraft===e||!this.activeDraft){let l;if(s.length===1)l=s[0];else{const o=[...s].sort((c,f)=>c.localeCompare(f));if(this.activeDraft===e){const c=o.findIndex(f=>f===e);if(c!==-1){const f=c<o.length-1?c:0;l=o[f]}else l=o[0]}else l=this.activeDraft}await this.setActiveDraft(l,i,!1)}}else this.activeDraft=null,this.notifyActiveDraftListeners(null);return!0}return new y.Notice("Failed to delete draft."),!1}async suggestNextDraftName(e){return await this.projectFileService.drafts.suggestNextDraftName(e)}getCurrentProjectPath(){const e=this.app.workspace.getActiveFile();if(!e)return null;const r=e.parent;return r?r.path:null}}const Ln=0,qi=5e3,Gi=250;class zh extends y.PluginSettingTab{constructor(e,r){super(e,r),this.plugin=r,T(`${A} Settings tab created`),typeof r.registerSettingsChangedCallback=="function"&&r.registerSettingsChangedCallback(()=>{T(`${A} Settings changed externally, refreshing UI`),this.containerEl&&this.containerEl.parentElement&&this.display()})}display(){const{containerEl:e}=this;e.empty(),e.createEl("h2",{text:`${ue} Settings`}),T(`${A} Displaying settings UI`);const r=this.plugin;e.createEl("h3",{text:"Templates"}),new y.Setting(e).setName("Include outline file on draft creation").setDesc("If enabled, each new draft will include an outline.md file using the outline template.").addToggle(l=>l.setValue(!!r.settings.includeDraftOutline).onChange(o=>{T(`${A} Include draft outline changed: ${o}`),r.settings.includeDraftOutline=o,r.saveSettings()})),new y.Setting(e).setName("Draft outline template").setDesc("Template for new draft outline files. Use {{draftName}}").addTextArea(l=>{l.setValue(r.settings.draftOutlineTemplate||""),l.inputEl.setAttribute("data-setting","draft-outline")}).addButton(l=>l.setButtonText("Pick file...").onClick(()=>{T(`${A} Opening file picker for draft outline template`),new Qa(this.app,o=>{T(`${A} Draft outline template selected: ${o}`),r.settings.draftOutlineTemplate=o,this.display()}).open()})),new y.Setting(e).setName("Planning template").setDesc("Template for planning documents. Use {{projectName}}").addTextArea(l=>{l.setValue(r.settings.planningTemplate||""),l.inputEl.setAttribute("data-setting","planning")}).addButton(l=>l.setButtonText("Pick file...").onClick(()=>{T(`${A} Opening file picker for planning template`),new Qa(this.app,o=>{T(`${A} Planning template selected: ${o}`),r.settings.planningTemplate=o,this.display()}).open()})),new y.Setting(e).setName("Chapter template").setDesc("Template for newly created chapter files. Use {{chapterTitle}}").addTextArea(l=>{l.setValue(r.settings.chapterTemplate||""),l.inputEl.setAttribute("data-setting","chapter")}).addButton(l=>l.setButtonText("Pick file...").onClick(()=>{T(`${A} Opening file picker for chapter template`),new Qa(this.app,o=>{T(`${A} Chapter template selected: ${o}`),r.settings.chapterTemplate=o,this.display()}).open()})),new y.Setting(e).setName("Manuscript name template").setDesc("Template for manuscript filenames. Use {{draftName}}, {{projectName}}, and moment.js date qualifiers like {{YYYY-MM-DD}}").addText(l=>{l.setValue(r.settings.manuscriptNameTemplate||"{{draftName}}"),l.inputEl.setAttribute("data-setting","manuscript")}),new y.Setting(e).addButton(l=>l.setButtonText("Save Templates").setCta().onClick(async()=>{var v,m,u;T(`${A} Save Templates button clicked`);const o=e.querySelector('textarea[data-setting="draft-outline"]'),c=e.querySelector('textarea[data-setting="planning"]'),f=e.querySelector('textarea[data-setting="chapter"]'),h=e.querySelector('input[data-setting="manuscript"]');T(`${A} Found inputs - draft: ${!!o}, planning: ${!!c}, chapter: ${!!f}, manuscript: ${!!h}`),T(`${A} Manuscript input value: "${h==null?void 0:h.value}"`),o&&(r.settings.draftOutlineTemplate=o.value),c&&(r.settings.planningTemplate=c.value),f&&(r.settings.chapterTemplate=f.value),h&&(r.settings.manuscriptNameTemplate=h.value),T(`${A} Saving templates: draft=${(v=r.settings.draftOutlineTemplate)==null?void 0:v.substring(0,50)}..., planning=${(m=r.settings.planningTemplate)==null?void 0:m.substring(0,50)}..., chapter=${(u=r.settings.chapterTemplate)==null?void 0:u.substring(0,50)}..., manuscript=${r.settings.manuscriptNameTemplate}`),await r.saveSettings(),new y.Notice("Templates saved successfully!")})),e.createEl("h3",{text:"Filenames"}),new y.Setting(e).setName("Draft filename slug style").setDesc("How per-draft main filenames are generated").addDropdown(l=>{l.addOption("compact","compact (draft1)"),l.addOption("kebab","kebab (draft-1)"),l.setValue(r.settings.slugStyle||"compact"),l.onChange(o=>{T(`${A} Slug style changed: ${o}`),r.settings.slugStyle=o,r.saveSettings();const c=e.querySelector(".wat-slug-preview");c&&(c.textContent=`Example: Draft 1 → ${Et("Draft 1",o)}.md`)})});let n="Draft 1";new y.Setting(e).setName("Sample draft name").setDesc("Type a sample draft name to preview the generated filename").addText(l=>l.setPlaceholder("Draft 1").setValue(n).onChange(o=>{n=o||"Draft 1";const c=e.querySelector(".wat-slug-preview");if(c){const f=Et(n,r.settings.slugStyle);c.textContent=`Example: ${n} → ${f}.md`}}));const i=e.createDiv({cls:"wat-slug-preview"}),a=Et(n,r.settings.slugStyle);i.setText(`Example: ${n} → ${a}.md`),e.createEl("h3",{text:"Folders & Files"}),new y.Setting(e).setName("Drafts folder name").setDesc("Name of the folder containing draft subfolders (default: drafts)").addText(l=>l.setValue(r.settings.draftsFolderName||"drafts").onChange(o=>{T(`${A} Drafts folder name changed: ${o}`),r.settings.draftsFolderName=o||"drafts",r.saveSettings()})),new y.Setting(e).setName("Manuscripts folder name").setDesc("Name of the folder containing generated manuscripts (default: manuscripts)").addText(l=>l.setValue(r.settings.manuscriptsFolderName||"manuscripts").onChange(o=>{T(`${A} Manuscripts folder name changed: ${o}`),r.settings.manuscriptsFolderName=o||"manuscripts",r.saveSettings()})),new y.Setting(e).setName("Backups folder name").setDesc("Name of the folder containing draft backups (default: .writeaid-backups)").addText(l=>l.setValue(r.settings.backupsFolderName||".writeaid-backups").onChange(o=>{T(`${A} Backups folder name changed: ${o}`),r.settings.backupsFolderName=o||".writeaid-backups",r.saveSettings()})),new y.Setting(e).setName("Meta file name").setDesc("Name of the project metadata file (default: meta.md)").addText(l=>l.setValue(r.settings.metaFileName||"meta.md").onChange(o=>{T(`${A} Meta file name changed: ${o}`),r.settings.metaFileName=o||"meta.md",r.saveSettings()})),new y.Setting(e).setName("Outline file name").setDesc("Name of the draft outline file (default: outline.md)").addText(l=>l.setValue(r.settings.outlineFileName||"outline.md").onChange(o=>{T(`${A} Outline file name changed: ${o}`),r.settings.outlineFileName=o||"outline.md",r.saveSettings()})),e.createEl("h3",{text:"UI & Startup"}),e.createEl("p",{text:"Most settings take effect immediately. Settings marked with ⚠️ require a plugin reload to take effect.",cls:"setting-item-description"}),new y.Setting(e).setName("Ribbon placement").setDesc(`Place the ${ue} icon on the left or right ribbon`).addDropdown(l=>{l.addOption("left","Left"),l.addOption("right","Right"),l.setValue(r.settings.ribbonPlacement||"left"),l.onChange(o=>{T(`${A} Ribbon placement changed: ${o}`),r.settings.ribbonPlacement=o,r.saveSettings(),typeof this.plugin.moveRibbon=="function"&&(o==="left"||o==="right")&&this.plugin.moveRibbon(o),this.display()})}),new y.Setting(e).setName("Always show ribbon").setDesc(`If enabled, the ${ue} ribbon icon will always be visible regardless of whether projects are detected`).addToggle(l=>l.setValue(!!r.settings.ribbonAlwaysShow).onChange(o=>{T(`${A} Always show ribbon changed: ${o}`),r.settings.ribbonAlwaysShow=o,r.saveSettings(),typeof this.plugin.refreshRibbonVisibility=="function"&&this.plugin.refreshRibbonVisibility()})),new y.Setting(e).setName("Auto-open project panel on startup").setDesc(`If enabled, the ${ue} project panel will open on plugin load when an active project is saved. ⚠️ Requires plugin reload to take effect.`).addToggle(l=>l.setValue(!!r.settings.autoOpenPanelOnStartup).onChange(o=>{T(`${A} Auto-open panel on startup changed: ${o}`),r.settings.autoOpenPanelOnStartup=o,r.saveSettings()})),new y.Setting(e).setName("Auto-select persisted project on startup").setDesc("If enabled, the persisted active project will be selected as the plugin's active project on load without opening the panel. ⚠️ Requires plugin reload to take effect.").addToggle(l=>l.setValue(!!r.settings.autoSelectProjectOnStartup).onChange(o=>{T(`${A} Auto-select project on startup changed: ${o}`),r.settings.autoSelectProjectOnStartup=o,r.saveSettings()})),new y.Setting(e).setName(`Enable ${ue} debug logs`).setDesc(`When enabled, ${ue} will set window.__${ue.toUpperCase()}__ to true to show verbose runtime logs useful during development.`).addToggle(l=>l.setValue(!!r.settings.debug).onChange(o=>{T(`${A} Debug logs setting changed: ${o}`),r.settings.debug=o,window.__WRITEAID_DEBUG__=!!o,r.saveSettings(),o?new y.Notice(`${ue}: debug logs enabled — verbose logs will appear in the DevTools console.`):new y.Notice(`${ue}: debug logs disabled.`)})),e.createEl("h3",{text:"Panel performance"}),new y.Setting(e).setName("Panel refresh debounce (ms)").setDesc("Debounce timeout (milliseconds) for side-panel refresh notifications. Lower values mean more frequent refreshes; 0 disables debouncing.").addText(l=>{const o=r.settings.panelRefreshDebounceMs,c=Number(o??Gi);l.setPlaceholder(String(Gi)),l.setValue(String(c));let f=null;const h=v=>{const m=Number(v);if(!Number.isFinite(m)||m<Ln){new y.Notice(`Please enter a valid number ≥ ${Ln}.`);return}const u=Math.min(Math.floor(m),qi);T(`${A} Panel refresh debounce changed: ${u}ms`),r.settings.panelRefreshDebounceMs=u;try{const g=r.saveSettings();g&&typeof g.catch=="function"&&g.catch(()=>{})}catch{}this.plugin.manager&&typeof this.plugin.manager=="object"&&"panelRefreshDebounceMs"in this.plugin.manager&&(this.plugin.manager.panelRefreshDebounceMs=u),l.inputEl.value=String(u),f&&(f.value=String(u))};try{const v=l.inputEl;v.setAttribute("type","number"),v.setAttribute("min",String(Ln)),v.setAttribute("max",String(qi)),v.setAttribute("step","50"),v.setAttribute("aria-label","Panel refresh debounce in milliseconds"),de(()=>{v.insertAdjacentHTML("afterend",'<span class="wa-unit">ms</span>')}),f=document.createElement("input"),f.type="range",f.min=String(Ln),f.max=String(qi),f.step="50",f.value=String(c),f.className="wa-debounce-range",de(()=>{const m=v.nextSibling;m&&m.parentElement?m.insertAdjacentElement("afterend",f):v.insertAdjacentElement("afterend",f)}),l.onChange(m=>{const u=Number(m);h(u)}),f.addEventListener("input",m=>{const u=Number(m.target.value);l.inputEl.value=String(u),h(u)})}catch{l.onChange(v=>{const m=Number(v);if(!Number.isFinite(m)||m<Ln){new y.Notice(`Please enter a valid number ≥ ${Ln}.`);return}const u=Math.min(Math.floor(m),qi);r.settings.panelRefreshDebounceMs=u,r.saveSettings(),this.plugin.manager&&typeof this.plugin.manager=="object"&&"panelRefreshDebounceMs"in this.plugin.manager&&(this.plugin.manager.panelRefreshDebounceMs=u)})}}).addButton(l=>l.setButtonText("Reset").setTooltip(`Reset to default (${Gi} ms)`).onClick(()=>{const o=Gi;r.settings.panelRefreshDebounceMs=o,r.saveSettings(),this.plugin.manager&&typeof this.plugin.manager=="object"&&"panelRefreshDebounceMs"in this.plugin.manager&&(this.plugin.manager.panelRefreshDebounceMs=o),this.display()}))}}class Qa extends y.Modal{constructor(e,r){super(e),this.currentFolder=null,this.expanded={},this.onPick=r,T(`${A} FilePickerModal created`)}onOpen(){T(`${A} FilePickerModal opened`);const e=this.app.vault.getRoot();this.currentFolder=e,this.expanded={},this.render()}render(){const{contentEl:e}=this;if(e.empty(),e.createEl("h2",{text:"Select template file"}),!this.currentFolder)return;const r=this.currentFolder.path?this.currentFolder.path.split("/"):[],n=e.createDiv({cls:"wat-breadcrumbs"}),i=n.createEl("a",{text:"(Vault root)",href:"#"});i.onclick=c=>{c.preventDefault(),this.currentFolder=this.app.vault.getRoot(),this.render()};let a="";for(const c of r){a=a?`${a}/${c}`:c,n.createDiv({text:" / "});const f=n.createEl("a",{text:c,href:"#"}),h=a;f.onclick=v=>{v.preventDefault();const m=this.app.vault.getAbstractFileByPath(h);m&&m instanceof y.TFolder&&(this.currentFolder=m,this.render())}}const l=e.createDiv({cls:"wat-controls"}).createEl("button",{text:"Up"});l.onclick=c=>{var v;if(c.preventDefault(),!this.currentFolder)return;const f=((v=this.currentFolder.parent)==null?void 0:v.path)||"",h=f?this.app.vault.getAbstractFileByPath(f):this.app.vault.getRoot();h&&h instanceof y.TFolder&&(this.currentFolder=h,this.render())};const o=e.createDiv({cls:"wat-list"});for(const c of this.currentFolder.children)if(c instanceof y.TFolder){const f=o.createDiv({cls:"wat-row folder-row"}),h=f.createEl("button",{text:this.expanded[c.path]?"▾":"▸"});h.onclick=m=>{m.preventDefault(),this.expanded[c.path]=!this.expanded[c.path],this.render()};const v=f.createEl("a",{text:c.name,href:"#"});if(v.onclick=m=>{m.preventDefault(),this.currentFolder=c,this.render()},this.expanded[c.path]){const m=o.createDiv({cls:"wat-sub"});for(const u of c.children)if(u instanceof y.TFolder){const b=m.createDiv({cls:"wat-row sub-folder"}).createEl("a",{text:u.name,href:"#"});b.onclick=_=>{_.preventDefault(),this.currentFolder=u,this.render()}}else if(u instanceof y.TFile&&u.path.toLowerCase().endsWith(".md")){const b=m.createDiv({cls:"wat-row sub-file"}).createEl("a",{text:u.name,href:"#"});b.onclick=_=>{_.preventDefault(),T(`${A} File selected from file picker: ${u.path}`),this.close(),this.onPick(u.path)}}}}else if(c instanceof y.TFile&&c.path.toLowerCase().endsWith(".md")){const h=o.createDiv({cls:"wat-row file-row"}).createEl("a",{text:c.name,href:"#"});h.onclick=v=>{v.preventDefault(),T(`${A} File selected from file picker: ${c.path}`),this.close(),this.onPick(c.path)}}}onClose(){this.contentEl.empty()}}const Hh=":root{--background: var(--background-primary, #fff);--border: var(--background-modifier-border, #ccc);--border-focused: var(--interactive-accent, #7c5cff);--border-hover: var(--interactive-accent, #7c5cff);--border-radius: 6px;--border-radius-focused: 6px;--box-sizing: border-box;--font-size: 1.5em;--height: 38px;--padding: 0 10px;--margin: 0;--width: 100%;--list-background: var(--background-secondary, #f6f6f6);--list-border: var(--background-modifier-border, #e0e0e0);--list-border-radius: 6px;--list-shadow: 0 2px 8px rgba(30, 30, 30, .06);--list-z-index: 1000;--list-max-height: 260px;--item-color: var(--text-normal, #222);--item-hover-bg: var(--background-modifier-hover, #f0f0ff);--item-hover-color: var(--text-normal, #222);--item-active-background: var(--background-modifier-active, #eaeaff);--item-is-active-bg: var(--background-modifier-active, #eaeaff);--item-is-active-color: var(--text-normal, #222);--item-padding: 8px 14px;--item-height: 36px;--item-line-height: 1.4;--item-transition: background .15s;--placeholder-color: var(--text-muted, #888);--placeholder-opacity: 1;--chevron-color: var(--text-muted, #888);--chevron-icon-colour: var(--text-muted, #888);--chevron-background: transparent;--chevron-border: none;--chevron-width: 22px;--chevron-height: 22px;--chevron-pointer-events: auto;--icons-color: var(--text-muted, #888);--disabled-background: var(--background-modifier-disabled, #f3f3f3);--disabled-border-color: var(--background-modifier-border, #eee);--disabled-color: var(--text-muted, #bbb);--disabled-placeholder-color: var(--text-muted, #bbb);--disabled-placeholder-opacity: .7;--error-background: #fff0f0;--error-border: #d43c3c}.theme-dark{--background: var(--background-primary, #23232b);--border: var(--background-modifier-border, #333);--border-focused: var(--interactive-accent, #7c5cff);--border-hover: var(--interactive-accent, #7c5cff);--font-size: 1em;--list-background: var(--background-secondary, #23233a);--list-border: var(--background-modifier-border, #333);--item-color: var(--text-normal, #e0e0e0);--item-hover-bg: var(--background-modifier-hover, #2a2a4a);--item-hover-color: var(--text-normal, #e0e0e0);--item-active-background: var(--background-modifier-active, #2a2a4a);--item-is-active-bg: var(--background-modifier-active, #2a2a4a);--item-is-active-color: var(--text-normal, #e0e0e0);--placeholder-color: var(--text-muted, #aaa);--chevron-color: var(--text-muted, #aaa);--chevron-icon-colour: var(--text-muted, #aaa);--icons-color: var(--text-muted, #aaa);--disabled-background: var(--background-modifier-disabled, #23232b);--disabled-border-color: var(--background-modifier-border, #333);--disabled-color: var(--text-muted, #444);--disabled-placeholder-color: var(--text-muted, #444);--error-background: #2a1a1a;--error-border: #d43c3c}.writeaid-ribbon{padding-left:6px}.writeaid-ribbon .wa-icon{display:inline-block;vertical-align:middle}.writeaid-ribbon .wa-icon svg{width:16px;height:16px;fill:currentColor;display:block}:root{--wa-slider-track-height: 6px;--wa-slider-thumb-size: 12px;--wa-slider-accent: var(--interactive-accent, #7c5cff);--wa-slider-background: var(--background-modifier-host, #eee);--wa-slider-gap: 12px}.wa-debounce-range{margin-left:var(--wa-slider-gap);vertical-align:middle;-webkit-appearance:none;-moz-appearance:none;appearance:none;height:var(--wa-slider-track-height);background:linear-gradient(90deg,var(--wa-slider-accent) 0%,var(--wa-slider-accent) 50%,var(--wa-slider-background) 50%,var(--wa-slider-background) 100%);border-radius:999px;outline:none}.wa-debounce-range::-webkit-slider-thumb{-webkit-appearance:none;-moz-appearance:none;appearance:none;width:var(--wa-slider-thumb-size);height:var(--wa-slider-thumb-size);border-radius:50%;background:var(--wa-slider-accent);box-shadow:0 0 0 4px #0000000d;cursor:pointer}.wa-debounce-range::-moz-range-thumb{width:var(--wa-slider-thumb-size);height:var(--wa-slider-thumb-size);border-radius:50%;background:var(--wa-slider-accent);cursor:pointer}.wa-unit{color:var(--text-muted, #666);margin-left:6px}.justify-between{justify-content:space-between}.wa-rename-info{margin-bottom:8px;color:var(--text-muted, #888);font-size:.95em}.wa-rename-label{display:block;font-weight:500;margin-bottom:4px;color:var(--text-normal, #222)}.wa-rename-input{width:100%;padding:7px 10px;font-size:1em;border:1px solid var(--background-modifier-border, #ccc);border-radius:5px;margin-bottom:10px;box-sizing:border-box;background:var(--background-primary, #fff);color:var(--text-normal, #222);transition:border .2s}.wa-rename-input:focus{border-color:var(--interactive-accent, #7c5cff);outline:none}.wa-rename-checkbox-label{display:flex;align-items:center;gap:6px;margin-bottom:10px;font-size:.97em;color:var(--text-muted, #666)}.wa-rename-btn-row{display:flex;gap:10px;margin-top:8px;justify-content:flex-end}.wa-rename-btn-row button{min-width:80px;padding:6px 14px;font-size:1em;border-radius:4px;border:none;cursor:pointer;transition:background .2s}.wa-rename-btn-row .mod-cta{background:var(--interactive-accent, #7c5cff);color:#fff;font-weight:600}.wa-rename-btn-row .mod-cta:hover{background:#5a3fd6}.wa-rename-btn-row .mod-cancel{background:var(--background-modifier-border, #eee);color:var(--text-muted, #666)}.wa-rename-btn-row .mod-cancel:hover{background:#e0e0e0}.wa-rename-error{min-height:18px;margin-bottom:4px;font-size:.97em;color:var(--color-red, #d43c3c);transition:opacity .2s}.wa-create-draft-input{width:100%;padding:8px 12px;font-size:1.05em;border:1.5px solid var(--background-modifier-border, #bbb);border-radius:6px;box-sizing:border-box;background:var(--background-primary, #fff);color:var(--text-normal, #222);transition:border .2s,box-shadow .2s;outline:none;box-shadow:0 1px 2px #3c3c3c0a}.wa-create-draft-input:focus{border-color:var(--interactive-accent, #7c5cff);box-shadow:0 2px 8px #7c5cff14;background:var(--background-secondary, #fafaff)}.wa-panel{background:var(--background-primary, #fff);color:var(--text-normal, #222);border-radius:8px}.wa-title{font-size:1.2em;font-weight:600;color:var(--text-title, var(--text-normal, #222))}.wa-muted{color:var(--text-faint, var(--text-muted, #888))}.wa-row{display:flex;flex-direction:row;align-items:center}.wa-button-group{display:flex;gap:8px}.wa-draft-list{background:var(--background-secondary, #f6f6f6);border-radius:6px;padding:8px 0;margin-top:8px}.wa-draft-item{display:flex;align-items:center;justify-content:space-between;padding:6px 14px;border-bottom:1px solid var(--background-modifier-border, #e0e0e0);background:transparent;color:var(--text-normal, #222);transition:background .15s}.wa-draft-item:last-child{border-bottom:none}.wa-draft-item.active{background:var(--background-modifier-active, #eaeaff)}.wa-draft-name{font-size:1em;font-weight:500;color:var(--text-normal, #222)}.wa-draft-actions{display:flex;gap:6px}.wa-panel .wa-select{--select-bg: var(--background-primary, #fff);--select-border: var(--background-modifier-border, #ccc);--select-border-focus: var(--interactive-accent, #7c5cff);--select-text: var(--text-normal, #222);--select-placeholder: var(--text-muted, #888);--select-dropdown-bg: var(--background-secondary, #f6f6f6);--select-dropdown-border: var(--background-modifier-border, #e0e0e0);--select-option-hover: var(--background-modifier-hover, #f0f0ff);--select-option-active: var(--background-modifier-active, #eaeaff);--select-chevron: var(--text-muted, #888)}.theme-dark .wa-panel .wa-select{--select-bg: var(--background-primary, #23232b);--select-border: var(--background-modifier-border, #333);--select-border-focus: var(--interactive-accent, #7c5cff);--select-text: var(--text-normal, #e0e0e0);--select-placeholder: var(--text-muted, #aaa);--select-dropdown-bg: var(--background-secondary, #23233a);--select-dropdown-border: var(--background-modifier-border, #333);--select-option-hover: var(--background-modifier-hover, #2a2a4a);--select-option-active: var(--background-modifier-active, #2a2a4a);--select-chevron: var(--text-muted, #aaa)}.wa-select{background:var(--select-bg);color:var(--select-text)}.wa-select:focus,.wa-select:focus-within{border-color:var(--select-border-focus)}.wa-select .select-placeholder{color:var(--select-placeholder)}.wa-select .select-dropdown{background:var(--select-dropdown-bg)}.wa-select .select-option{color:var(--select-text)}.wa-select .select-option:hover{background:var(--select-option-hover)}.wa-select .select-option[aria-selected=true],.wa-select .select-option.selected{background:var(--select-option-active)}.wa-select .select-chevron{color:var(--select-chevron)}.wa-select input[type=text]:focus{border-radius:0}.theme-dark .wa-panel{background:var(--background-primary, #23232b);color:var(--text-normal, #e0e0e0);border:1px solid var(--background-modifier-border, #333)}.theme-dark .wa-title{color:var(--text-title, var(--text-normal, #e0e0e0))}.theme-dark .wa-muted{color:var(--text-faint, var(--text-muted, #aaa))}.theme-dark .wa-draft-list{background:var(--background-secondary, #23233a)}.theme-dark .wa-draft-item{color:var(--text-normal, #e0e0e0);border-bottom:1px solid var(--background-modifier-border, #333)}.theme-dark .wa-draft-item.active{background:var(--background-modifier-active, #2a2a4a)}.theme-dark .wa-draft-name{color:var(--text-normal, #e0e0e0)}";function Lo(t,e=20){return t.length<=e?t:t.substring(0,e-3)+"..."}const lc={draftOutlineTemplate:"# Outline for {{draftName}}",planningTemplate:`# Planning: {{projectName}}

- [ ] ...`,chapterTemplate:`# {{chapterTitle}}

`,manuscriptNameTemplate:"{{draftName}}",slugStyle:"compact",ribbonPlacement:"left",ribbonAlwaysShow:!1,autoOpenPanelOnStartup:!0,autoSelectProjectOnStartup:!0,activeProject:void 0,panelRefreshDebounceMs:250,debug:!1,includeDraftOutline:!1,draftsFolderName:"drafts",manuscriptsFolderName:"manuscripts",backupsFolderName:".writeaid-backups",metaFileName:"meta.md",outlineFileName:"outline.md"};function Mo(t){return Object.assign({},lc,t??{})}class Uh extends y.Plugin{constructor(){super(...arguments),this.settings=lc,this.settingsChangedCallbacks=[]}async loadSettings(){const e=await this.loadData();this.settings=Mo(e),e&&e.activeProject!==void 0&&(this.settings.activeProject=e.activeProject),this.manager&&(this.manager.settings=this.settings),this.settingsChangedCallbacks.forEach(r=>{try{r()}catch(n){console.error("Error in settings changed callback:",n)}})}async saveSettings(){await He(async()=>{const r=Mo(this.settings);await this.saveData(r),this.settings=r})===void 0&&await this.saveData(this.settings),this.manager&&(this.manager.settings=this.settings,T(`${A} Updated manager settings reference, manuscript template: ${this.settings.manuscriptNameTemplate}`)),this.settingsChangedCallbacks.forEach(r=>{try{r()}catch(n){console.error("Error in settings changed callback:",n)}})}registerSettingsChangedCallback(e){this.settingsChangedCallbacks.push(e)}async onload(){await this.loadSettings(),this.manager=new Wh(this.app,this,typeof this.settings.panelRefreshDebounceMs=="number"?this.settings.panelRefreshDebounceMs:void 0);const e=new Es(this.app);this.app.workspace.onLayoutReady(async()=>{const i=await e.listProjects();let a=null;if(i.length===1)a=i[0];else if(i.length>1){const s=this.settings.activeProject,l=s==null?void 0:s.trim().replace(/^\/+/,"").replace(/\/+$/,"");T(`${A} lastActiveRaw='${s}', normalized='${l}', includes=${l&&i.includes(l)}`),l&&i.includes(l)?a=l:a=i[0]}else if(i.length===0){const s=this.settings.activeProject,l=s==null?void 0:s.trim().replace(/^\/+/,"").replace(/\/+$/,"");await e.isProjectFolder(s||"")&&(T(`${A} activating saved project '${l}' as it exists and has valid meta.md`),a=l??null)}if(T(`${A} toActivate='${a}'`),a){if(await this.manager.setActiveProject(a),this.settings.activeProject=a,await this.saveSettings(),this.settings.autoOpenPanelOnStartup){const s=this.app.workspace.getLeavesOfType(Mr);if(s.length>0)this.app.workspace.revealLeaf(s[0]);else{let l=null;this.settings.ribbonPlacement==="right"?l=this.app.workspace.getRightLeaf(!0):l=this.app.workspace.getLeftLeaf(!0);const o={type:Mr,active:!0};l.setViewState(o),this.app.workspace.revealLeaf(l)}}}else await this.manager.setActiveProject(null),this.settings.activeProject=void 0,await this.saveSettings()}),this.statusBarEl=this.addStatusBarItem(),this.statusBarEl.setText(`${ue}: No active project`),de(()=>{this.waStyleEl||(this.waStyleEl=document.createElement("style"),this.waStyleEl.setAttribute("data-writeaid-style",""),this.waStyleEl.textContent=Hh,this.waStyleEl.classList.add("writeaid-plugin-style"),document.head.appendChild(this.waStyleEl))}),await this.loadSettings(),de(()=>{window.__WRITEAID_DEBUG__=!!this.settings.debug}),T(`${A} Loading ${ue} Novel Multi-Draft Plugin`),this.manager.addActiveProjectListener(i=>{this.statusBarEl&&(i?(this.statusBarEl.setText(`${ue}: ${Lo(i)}`),T(`${A} active project updated -> ${i}`)):this.statusBarEl.setText(`${ue}: No active project`))}),this.manager.activeProject&&this.statusBarEl.setText(`${ue}: ${Lo(this.manager.activeProject)}`),this.registerView(Mr,i=>new Oh(i,this.app));const r=this.addRibbonIcon(Bo,`${ue} Projects`,()=>{});r.classList.add("writeaid-ribbon"),this.ribbonEl=r,r.setAttr("aria-label",`${ue} Projects`),r.onclick=()=>{const i=this.app.workspace.getLeavesOfType(Mr);if(i.length>0){const a=i[0];this.app.workspace.revealLeaf(a)}else{let a=this.app.workspace.getLeftLeaf(!1);a||(a=this.app.workspace.getLeftLeaf(!0));const s={type:Mr,active:!0};a.setViewState(s),this.app.workspace.revealLeaf(a)}};const n=async()=>{await He(async()=>{if(this.settings.ribbonAlwaysShow){r.style.display="";return}const a=e.listAllFolders();(await Vn(a,l=>e.isProjectFolder(l))).length>0?r.style.display="":r.style.display="none"})===void 0&&(r.style.display="")};this.refreshRibbonVisibility=n,n().catch(()=>{}),this.settings.ribbonPlacement==="right"&&this.moveRibbon("right"),this.registerEvent(this.app.vault.on("create",()=>{n().catch(()=>{})})),this.registerEvent(this.app.vault.on("delete",()=>{n().catch(()=>{})})),this.registerEvent(this.app.vault.on("modify",()=>{n().catch(()=>{})})),this.addCommand({id:"create-new-draft",name:"Create New Draft",callback:Rc(this.manager)}),this.addCommand({id:"create-new-project",name:"Create New Project",callback:Ic(this.manager)}),this.addCommand({id:"switch-draft",name:"Switch Active Draft",callback:Hc(this.manager)}),this.addCommand({id:"update-project-metadata",name:"Update Project Metadata",callback:Mh(this.manager)}),this.addCommand({id:"select-active-project",name:"Select Active Project",callback:zc(this.manager)}),this.addCommand({id:"generate-manuscript",name:"Generate Manuscript",callback:Bc(this.manager)}),this.addCommand({id:"toggle-project-panel",name:`Toggle ${ue} Project Panel`,callback:Lh(this.manager,this.app)}),this.addCommand({id:"convert-single-to-multi-file-project",name:"Convert Single-File Project to Multi-File",callback:()=>{var i,a;return Mc(this.app,this.manager.activeProject||((a=(i=this.manager).getCurrentProjectPath)==null?void 0:a.call(i))||void 0)}}),this.addCommand({id:"navigate-to-next-chapter",name:"Navigate to Next Chapter",callback:Vc(this.manager)}),this.addCommand({id:"navigate-to-previous-chapter",name:"Navigate to Previous Chapter",callback:Wc(this.manager)}),this.addSettingTab(new zh(this.app,this))}moveRibbon(e){de(()=>{if(!this.ribbonEl)return;const r=this.app.workspace.containerEl.querySelector(".workspace-ribbon.mod-right"),n=this.app.workspace.containerEl.querySelector(".workspace-ribbon.mod-left");e==="right"&&r?r.appendChild(this.ribbonEl):e==="left"&&n&&n.appendChild(this.ribbonEl)})}onunload(){this.statusBarEl&&this.statusBarEl.parentElement&&this.statusBarEl.parentElement.removeChild(this.statusBarEl),T(`${A} Unloading ${ue} Novel Multi-Draft Plugin`),this.waStyleEl&&this.waStyleEl.parentElement&&this.waStyleEl.parentElement.removeChild(this.waStyleEl)}}module.exports=Uh;
